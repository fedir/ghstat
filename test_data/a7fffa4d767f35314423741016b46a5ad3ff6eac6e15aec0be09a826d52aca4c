HTTP/1.1 200 OK
Transfer-Encoding: chunked
Access-Control-Allow-Origin: *
Access-Control-Expose-Headers: ETag, Link, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval
Cache-Control: no-cache
Content-Security-Policy: default-src 'none'
Content-Type: application/json; charset=utf-8
Date: Sat, 09 Jun 2018 08:08:28 GMT
Link: <https://api.github.com/search/issues?q=repo%3Aleafo%2Flapis+type%3Aissue+state%3Aclosed&page=2>; rel="next", <https://api.github.com/search/issues?q=repo%3Aleafo%2Flapis+type%3Aissue+state%3Aclosed&page=13>; rel="last"
Referrer-Policy: origin-when-cross-origin, strict-origin-when-cross-origin
Server: GitHub.com
Status: 200 OK
Strict-Transport-Security: max-age=31536000; includeSubdomains; preload
X-Accepted-Oauth-Scopes: 
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-Github-Media-Type: github.v3; format=json
X-Github-Request-Id: CB5C:57C4:23BB4CE:50D4AAB:5B1B8AFB
X-Oauth-Scopes: 
X-Ratelimit-Limit: 30
X-Ratelimit-Remaining: 6
X-Ratelimit-Reset: 1528531742
X-Runtime-Rack: 0.423062
X-Xss-Protection: 1; mode=block

8000
{"total_count":373,"incomplete_results":false,"items":[{"url":"https://api.github.com/repos/leafo/lapis/issues/623","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/623/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/623/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/623/events","html_url":"https://github.com/leafo/lapis/issues/623","id":325791412,"node_id":"MDU6SXNzdWUzMjU3OTE0MTI=","number":623,"title":"Worker segfaults every second request localhost only lapis only wtf","user":{"login":"DarkWiiPlayer","id":1252859,"node_id":"MDQ6VXNlcjEyNTI4NTk=","avatar_url":"https://avatars1.githubusercontent.com/u/1252859?v=4","gravatar_id":"","url":"https://api.github.com/users/DarkWiiPlayer","html_url":"https://github.com/DarkWiiPlayer","followers_url":"https://api.github.com/users/DarkWiiPlayer/followers","following_url":"https://api.github.com/users/DarkWiiPlayer/following{/other_user}","gists_url":"https://api.github.com/users/DarkWiiPlayer/gists{/gist_id}","starred_url":"https://api.github.com/users/DarkWiiPlayer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DarkWiiPlayer/subscriptions","organizations_url":"https://api.github.com/users/DarkWiiPlayer/orgs","repos_url":"https://api.github.com/users/DarkWiiPlayer/repos","events_url":"https://api.github.com/users/DarkWiiPlayer/events{/privacy}","received_events_url":"https://api.github.com/users/DarkWiiPlayer/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-05-23T16:52:21Z","updated_at":"2018-05-28T12:20:02Z","closed_at":"2018-05-28T12:20:02Z","author_association":"CONTRIBUTOR","body":"This is probably one of the weirdest problems I have ever experienced with software.\r\n\r\nI run lapis behind an openresty reverse proxy, so all outside requests ultimately reach lapis itself from localhost. Now, the weird thing is, every second request, I get `502 bad gateway` and this shows in the \r\n\r\n    2018/05/23 18:39:53 [notice] 3274#3274: signal 17 (SIGCHLD) received from 3275\r\n    2018/05/23 18:39:53 [alert] 3274#3274: worker process 3275 exited on signal 11 (core dumped)\r\n    2018/05/23 18:39:53 [notice] 3274#3274: start worker process 3296\r\n\r\nHere's what I have found out:\r\n\r\n0. Exactly every second request causes the worker process to segfault\r\n0. This happens with completely new apps (freshly generated with `lapis --new`)\r\n0. It only occurs in development configuration, probably because of the enabled code-cache\r\n0. The error only manifests itself when accessing from localhost, both through a reverse proxy or directly with `lynx`\r\n0. It happens with Lua and Moonscript\r\n0. Re-building openresty with only some basic config flags doesn't work.\r\n0. Adding worker processes doesn't fix the problem, but makes it a bit more random; every worker process drops dead by the second request it gets\r\n0. The problem does *not* occur with a simple `content_by_lua` statement (example: `ngx.say \"hello world\"`) works.\r\n0. Updating lapis doesn't fix it either\r\n0. `apt-get update; apt-get upgrade` doesn't fix it either\r\n0. Yes, I *have* tried turning it off and on again. Several times.\r\n\r\nI'll provide aditional information if needed. This may very well be my fault for messing with something I shouldn't, but I can't think of anything I did that would lead to lapis breaking for no reason. I've had lapis running in production for a long time now, so I don't know when exactly it broke. It *might* have been with the last time I did `apt-get upgrade`, but I can't confirm that.\r\n\r\n`openresty -V`:\r\n\r\n    nginx version: openresty/1.13.6.1\r\n    built by gcc 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9)\r\n    built with OpenSSL 1.0.2g  1 Mar 2016\r\n    TLS SNI support enabled\r\n    configure arguments: --prefix=/usr/local/openresty/nginx --with-cc-opt=-O2 --add-module=../ngx_devel_kit-0.3.0 --add-module=../echo-nginx-module-0.61 --add-module=../xss-nginx-module-0.05 --add-module=../ngx_coolkit-0.2rc3 --add-module=../set-misc-nginx-module-0.31 --add-module=../form-input-nginx-module-0.12 --add-module=../encrypted-session-nginx-module-0.07 --add-module=../srcache-nginx-module-0.31 --add-module=../ngx_lua-0.10.11 --add-module=../ngx_lua_upstream-0.07 --add-module=../headers-more-nginx-module-0.33 --add-module=../array-var-nginx-module-0.05 --add-module=../memc-nginx-module-0.18 --add-module=../redis2-nginx-module-0.14 --add-module=../redis-nginx-module-0.3.7 --add-module=../rds-json-nginx-module-0.15 --add-module=../rds-csv-nginx-module-0.08 --add-module=../ngx_stream_lua-0.0.3 --with-ld-opt=-Wl,-rpath,/usr/local/openresty/luajit/lib --with-pcre-jit --with-http_v2_module --with-http_ssl_module --with-stream --with-threads --with-stream_ssl_module --with-stream --with-stream_ssl_module\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/622","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/622/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/622/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/622/events","html_url":"https://github.com/leafo/lapis/issues/622","id":324631515,"node_id":"MDU6SXNzdWUzMjQ2MzE1MTU=","number":622,"title":"when i select data from pg10, some column does't display","user":{"login":"forkforlearn","id":29908621,"node_id":"MDQ6VXNlcjI5OTA4NjIx","avatar_url":"https://avatars0.githubusercontent.com/u/29908621?v=4","gravatar_id":"","url":"https://api.github.com/users/forkforlearn","html_url":"https://github.com/forkforlearn","followers_url":"https://api.github.com/users/forkforlearn/followers","following_url":"https://api.github.com/users/forkforlearn/following{/other_user}","gists_url":"https://api.github.com/users/forkforlearn/gists{/gist_id}","starred_url":"https://api.github.com/users/forkforlearn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/forkforlearn/subscriptions","organizations_url":"https://api.github.com/users/forkforlearn/orgs","repos_url":"https://api.github.com/users/forkforlearn/repos","events_url":"https://api.github.com/users/forkforlearn/events{/privacy}","received_events_url":"https://api.github.com/users/forkforlearn/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-05-19T13:55:33Z","updated_at":"2018-05-22T22:11:11Z","closed_at":"2018-05-22T22:11:11Z","author_association":"NONE","body":"My table has three column\r\n```\r\nCREATE TABLE public.test_nextid\r\n(\r\n  id  serial,\r\n  name character varying(255),\r\n  desc character varying(255)\r\n)\r\n```\r\nAnd i insert one recorder\r\n```\r\ninert into test_nextid (name) values(\"testname_1\")\r\n```\r\nAnd i select all data from the table\r\n```\r\n        local sql = \"select * from test_nextid\"\r\n        res,err = assert_error(db.query(sql))\r\n        --res,err = db.select(\"* from test_nextid\")\r\n```\r\nBut there is no desc in result....\r\nI want to see the \"desc \" column in  the result,what should i do? thank u","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/618","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/618/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/618/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/618/events","html_url":"https://github.com/leafo/lapis/issues/618","id":319745585,"node_id":"MDU6SXNzdWUzMTk3NDU1ODU=","number":618,"title":"unknown directive \"set\"","user":{"login":"realpack","id":19867624,"node_id":"MDQ6VXNlcjE5ODY3NjI0","avatar_url":"https://avatars0.githubusercontent.com/u/19867624?v=4","gravatar_id":"","url":"https://api.github.com/users/realpack","html_url":"https://github.com/realpack","followers_url":"https://api.github.com/users/realpack/followers","following_url":"https://api.github.com/users/realpack/following{/other_user}","gists_url":"https://api.github.com/users/realpack/gists{/gist_id}","starred_url":"https://api.github.com/users/realpack/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/realpack/subscriptions","organizations_url":"https://api.github.com/users/realpack/orgs","repos_url":"https://api.github.com/users/realpack/repos","events_url":"https://api.github.com/users/realpack/events{/privacy}","received_events_url":"https://api.github.com/users/realpack/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-05-02T23:29:42Z","updated_at":"2018-05-06T01:33:35Z","closed_at":"2018-05-06T01:33:35Z","author_association":"NONE","body":"What am I doing wrong?\r\n\r\nnginx.conf\r\n```Nginx\r\nworker_processes ${{NUM_WORKERS}};\r\nerror_log stderr notice;\r\ndaemon off;\r\npid logs/nginx.pid;\r\n\r\nevents {\r\n  worker_connections 1024;\r\n}\r\n\r\nhttp {\r\n  include mime.types;\r\n\r\n  server {\r\n    listen ${{PORT}};\r\n    lua_code_cache ${{CODE_CACHE}};\r\n\r\n    location / {\r\n      default_type text/html;\r\n      set $_url '';\r\n      content_by_lua '\r\n        require(\"lapis\").serve(\"app\")\r\n      ';\r\n    }\r\n\r\n    location /proxy {\r\n      internal;\r\n      rewrite_by_lua \"\r\n        local req = ngx.req\r\n\r\n        for k,v in pairs(req.get_headers()) do\r\n          if k ~= 'content-length' then\r\n            req.clear_header(k)\r\n          end\r\n        end\r\n\r\n        if ngx.ctx.headers then\r\n          for k,v in pairs(ngx.ctx.headers) do\r\n            req.set_header(k, v)\r\n          end\r\n        end\r\n      \";\r\n\r\n      resolver 8.8.8.8;\r\n      proxy_http_version 1.1;\r\n      proxy_pass $_url;\r\n    }\r\n\r\n    location /static/ {\r\n      alias static/;\r\n    }\r\n\r\n    location /favicon.ico {\r\n      alias static/favicon.ico;\r\n    }\r\n  }\r\n}\r\n```\r\nError\r\n```\r\nnginx: [alert] lua_code_cache is off; this will hurt performance in /home/server/work/lapis/nginx.conf.compiled:16\r\nnginx: [emerg] unknown directive \"set\" in /home/server/work/lapis/nginx.conf.compiled:23\r\n```","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/617","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/617/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/617/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/617/events","html_url":"https://github.com/leafo/lapis/issues/617","id":317515920,"node_id":"MDU6SXNzdWUzMTc1MTU5MjA=","number":617,"title":"。。","user":{"login":"Sssan520","id":5629090,"node_id":"MDQ6VXNlcjU2MjkwOTA=","avatar_url":"https://avatars3.githubusercontent.com/u/5629090?v=4","gravatar_id":"","url":"https://api.github.com/users/Sssan520","html_url":"https://github.com/Sssan520","followers_url":"https://api.github.com/users/Sssan520/followers","following_url":"https://api.github.com/users/Sssan520/following{/other_user}","gists_url":"https://api.github.com/users/Sssan520/gists{/gist_id}","starred_url":"https://api.github.com/users/Sssan520/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sssan520/subscriptions","organizations_url":"https://api.github.com/users/Sssan520/orgs","repos_url":"https://api.github.com/users/Sssan520/repos","events_url":"https://api.github.com/users/Sssan520/events{/privacy}","received_events_url":"https://api.github.com/users/Sssan520/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2018-04-25T07:51:25Z","updated_at":"2018-04-25T07:51:41Z","closed_at":"2018-04-25T07:51:41Z","author_association":"NONE","body":"","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/616","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/616/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/616/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/616/events","html_url":"https://github.com/leafo/lapis/issues/616","id":317397987,"node_id":"MDU6SXNzdWUzMTczOTc5ODc=","number":616,"title":"Module 'views.index' not found","user":{"login":"daelvn","id":7452388,"node_id":"MDQ6VXNlcjc0NTIzODg=","avatar_url":"https://avatars1.githubusercontent.com/u/7452388?v=4","gravatar_id":"","url":"https://api.github.com/users/daelvn","html_url":"https://github.com/daelvn","followers_url":"https://api.github.com/users/daelvn/followers","following_url":"https://api.github.com/users/daelvn/following{/other_user}","gists_url":"https://api.github.com/users/daelvn/gists{/gist_id}","starred_url":"https://api.github.com/users/daelvn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/daelvn/subscriptions","organizations_url":"https://api.github.com/users/daelvn/orgs","repos_url":"https://api.github.com/users/daelvn/repos","events_url":"https://api.github.com/users/daelvn/events{/privacy}","received_events_url":"https://api.github.com/users/daelvn/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-04-24T21:15:03Z","updated_at":"2018-04-27T19:39:20Z","closed_at":"2018-04-27T19:39:20Z","author_association":"NONE","body":"## Module `views.index` not found\r\nHello, I have been testing my website and I get an error while trying to render my file `views/index.html`.\r\nI have tried reading [this issue](#199) and [this StackOverflow QA](https://stackoverflow.com/questions/26840933), however, in the issue, it didn't end up being resolved, and in the QA, the accepted question modifies the path to include Lapis itself, and the solution belows puts views in the path.\r\nBelow is my directory structure in which I'm starting the server:\r\n```\r\nvoyager@neptune:~/diversity$ ls *\r\napp.lua  config.lua  LICENSE.md  mime.types  models.lua  nginx.conf  nginx.conf.compiled  README.md\r\n\r\nclient_body_temp:\r\n\r\ncss:\r\nmain.css  main.css.map\r\n\r\nfastcgi_temp:\r\n\r\nlogs:\r\naccess.log  error.log\r\n\r\nproxy_temp:\r\n\r\nscgi_temp:\r\n\r\nuwsgi_temp:\r\n\r\nvendor:\r\nbootstrap  popper.js\r\n\r\nviews:\r\nindex.html  layout_community.etlua  layout_gallery.etlua  layout_hello.etlua  layout_users.etlua\r\n```\r\nAnd below, my `app.lua` file that should be rendering `views/index.html` with the layout `views/layout_:page.etlua`. I have enabled `etlua` for the application and have set `views` as the `views_prefix` before coming to post here. I have also tried to add a pair of paths to `package.path`\r\n```lua\r\n-- Path\r\npackage.path = package.path .. \";./?.lua;./?.etlua\"\r\n\r\n-- Lapis\r\nlocal Lapis = require \"lapis\"\r\n\r\n-- Application\r\nlocal app = Lapis.Application ()\r\napp:enable \"etlua\"\r\napp.views_prefix = \"views\"\r\n\r\n-- Routing\r\napp:match (\"irender\", \"/irender/:page\", function (self)\r\n  local page = self.params.page\r\n  return {\r\n    render = \"index\",\r\n    layout = \"layout_\" .. page\r\n  }\r\nend)\r\n\r\n-- Return\r\nreturn app\r\n```\r\nThis is the error that Lapis gives me when trying to access `irender/hello`:\r\n```\r\n/usr/local/share/lua/5.1/lapis/request.lua:205: module 'views.index' not found:\r\n\tno field package.preload['views.index']could not load `etlua` file\r\n\tno file '/usr/local/openresty/site/lualib/views/index.ljbc'\r\n\tno file '/usr/local/openresty/site/lualib/views/index/init.ljbc'\r\n\tno file '/usr/local/openresty/lualib/views/index.ljbc'\r\n\tno file '/usr/local/openresty/lualib/views/index/init.ljbc'\r\n\tno file '/usr/local/openresty/site/lualib/views/index.lua'\r\n\tno file '/usr/local/openresty/site/lualib/views/index/init.lua'\r\n\tno file '/usr/local/openresty/lualib/views/index.lua'\r\n\tno file '/usr/local/openresty/lualib/views/index/init.lua'\r\n\tno file './views/index.lua'\r\n\tno file '/usr/local/openresty/luajit/share/luajit-2.1.0-beta3/views/index.lua'\r\n\tno file '/usr/local/share/lua/5.1/views/index.lua'\r\n\tno file '/usr/local/share/lua/5.1/views/index/init.lua'\r\n\tno file '/usr/local/openresty/luajit/share/lua/5.1/views/index.lua'\r\n\tno file '/usr/local/openresty/luajit/share/lua/5.1/views/index/init.lua'\r\n\tno file './views/index.lua'\r\n\tno file './views/index.etlua'\r\n\tno file '/usr/local/openresty/site/lualib/views/index.so'\r\n\tno file '/usr/local/openresty/lualib/views/index.so'\r\n\tno file './views/index.so'\r\n\tno file '/usr/local/lib/lua/5.1/views/index.so'\r\n\tno file '/usr/local/openresty/luajit/lib/lua/5.1/views/index.so'\r\n\tno file '/usr/local/lib/lua/5.1/loadall.so'\r\n\tno file '/usr/local/openresty/site/lualib/views.so'\r\n\tno file '/usr/local/openresty/lualib/views.so'\r\n\tno file './views.so'\r\n\tno file '/usr/local/lib/lua/5.1/views.so'\r\n\tno file '/usr/local/openresty/luajit/lib/lua/5.1/views.so'\r\n\tno file '/usr/local/lib/lua/5.1/loadall.so'\r\n```\r\n\r\nI am starting the server in the `development` environment, which has the following configuration:\r\n```lua\r\n-- Lapis\r\nlocal Config = require \"lapis.config\"\r\n\r\n-- Configuration\r\nConfig (\"development\", {\r\n  port         = 8080,\r\n  session_name = \"dev_diversity_session\"\r\n})\r\n```\r\nAnd this is the `nginx.conf` for it:\r\n```\r\nworker_processes ${{NUM_WORKERS}};\r\nerror_log stderr notice;\r\ndaemon off;\r\npid logs/nginx.pid;\r\n\r\nevents {\r\n  worker_connections 1024;\r\n}\r\n\r\nhttp {\r\n  include mime.types;\r\n\r\n  server {\r\n    listen ${{PORT}};\r\n    lua_code_cache ${{CODE_CACHE}};\r\n\r\n    location / {\r\n      default_type text/html;\r\n      content_by_lua '\r\n        require(\"lapis\").serve(\"app\")\r\n      ';\r\n    }\r\n\r\n    location /static/ {\r\n      alias static/;\r\n    }\r\n\r\n    location /favicon.ico {\r\n      alias static/favicon.ico;\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nAny help would be greatly appreciated, please let me know if there is some information missing to be able to figure out the issue, thanks in advance!","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/613","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/613/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/613/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/613/events","html_url":"https://github.com/leafo/lapis/issues/613","id":313218557,"node_id":"MDU6SXNzdWUzMTMyMTg1NTc=","number":613,"title":"error: can not detect sig_atomic_t size","user":{"login":"harshkalra","id":5251594,"node_id":"MDQ6VXNlcjUyNTE1OTQ=","avatar_url":"https://avatars2.githubusercontent.com/u/5251594?v=4","gravatar_id":"","url":"https://api.github.com/users/harshkalra","html_url":"https://github.com/harshkalra","followers_url":"https://api.github.com/users/harshkalra/followers","following_url":"https://api.github.com/users/harshkalra/following{/other_user}","gists_url":"https://api.github.com/users/harshkalra/gists{/gist_id}","starred_url":"https://api.github.com/users/harshkalra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harshkalra/subscriptions","organizations_url":"https://api.github.com/users/harshkalra/orgs","repos_url":"https://api.github.com/users/harshkalra/repos","events_url":"https://api.github.com/users/harshkalra/events{/privacy}","received_events_url":"https://api.github.com/users/harshkalra/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-04-11T08:18:18Z","updated_at":"2018-04-24T22:41:49Z","closed_at":"2018-04-24T22:41:49Z","author_association":"NONE","body":"Hi, \r\ni am trying to setup openresty on a digital ocean server running ubuntu 16.04 LTS.\r\nwhen i run `./configure -j2 --with-pcre-jit --with-ipv6 ` , i get the following error.\r\n\r\n`./configure: error: can not detect sig_atomic_t size`\r\n`ERROR: failed to run command: sh ./configure --prefix=/usr/local/openresty/nginx \\...`\r\n\r\nhow to fix this?\r\nThanks!\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/611","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/611/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/611/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/611/events","html_url":"https://github.com/leafo/lapis/issues/611","id":309701571,"node_id":"MDU6SXNzdWUzMDk3MDE1NzE=","number":611,"title":"\"fetch \" data after query mysql ","user":{"login":"VuDn5","id":36143595,"node_id":"MDQ6VXNlcjM2MTQzNTk1","avatar_url":"https://avatars1.githubusercontent.com/u/36143595?v=4","gravatar_id":"","url":"https://api.github.com/users/VuDn5","html_url":"https://github.com/VuDn5","followers_url":"https://api.github.com/users/VuDn5/followers","following_url":"https://api.github.com/users/VuDn5/following{/other_user}","gists_url":"https://api.github.com/users/VuDn5/gists{/gist_id}","starred_url":"https://api.github.com/users/VuDn5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/VuDn5/subscriptions","organizations_url":"https://api.github.com/users/VuDn5/orgs","repos_url":"https://api.github.com/users/VuDn5/repos","events_url":"https://api.github.com/users/VuDn5/events{/privacy}","received_events_url":"https://api.github.com/users/VuDn5/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-03-29T10:26:02Z","updated_at":"2018-04-02T03:27:56Z","closed_at":"2018-04-02T03:27:56Z","author_association":"NONE","body":"Dear @leafo ! \r\ni have example:  \r\n` \r\n function testFunction(arg)\r\n        local res\r\n        res = db.query(\"select * FROM subscriber  where username =169693\")\r\n        local ha1 = res.ha1b\r\nreturn to_json(ha1)\r\n`\r\n\r\nbut it return null,  json of variable ** \" res\" ** is:\r\n[{\"username\":\"169693\",\"ha1b\":\"2004e0563f67b646abf038626961b6db\"}]\r\n\r\nMy question is, how can i take a ha1b from res variable? Thank you!   \r\n\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/610","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/610/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/610/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/610/events","html_url":"https://github.com/leafo/lapis/issues/610","id":307871656,"node_id":"MDU6SXNzdWUzMDc4NzE2NTY=","number":610,"title":"Handling request method 'OPTIONS' - best practice (CORS)","user":{"login":"aiibe","id":4663660,"node_id":"MDQ6VXNlcjQ2NjM2NjA=","avatar_url":"https://avatars0.githubusercontent.com/u/4663660?v=4","gravatar_id":"","url":"https://api.github.com/users/aiibe","html_url":"https://github.com/aiibe","followers_url":"https://api.github.com/users/aiibe/followers","following_url":"https://api.github.com/users/aiibe/following{/other_user}","gists_url":"https://api.github.com/users/aiibe/gists{/gist_id}","starred_url":"https://api.github.com/users/aiibe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aiibe/subscriptions","organizations_url":"https://api.github.com/users/aiibe/orgs","repos_url":"https://api.github.com/users/aiibe/repos","events_url":"https://api.github.com/users/aiibe/events{/privacy}","received_events_url":"https://api.github.com/users/aiibe/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-03-23T01:41:53Z","updated_at":"2018-04-02T22:58:23Z","closed_at":"2018-04-02T22:58:23Z","author_association":"NONE","body":"This is how my API handles 'POST' requests : \r\n```\r\nclass extends lapis.Application\r\n\t[hello:'/api/hello']: respond_to {\r\n\t\tOPTIONS: =>\r\n\t\t \t@res.headers[\"Access-Control-Allow-Origin\"] = \"*\"\r\n\t\t \t@res.headers[\"Access-Control-Allow-Headers\"] = \"Access-Control-Allow-Origin,Content-Type\"\r\n\r\n\t\tPOST: json_params =>\r\n\t\t\t@res.headers[\"Access-Control-Allow-Origin\"] = \"*\"\r\n\t\t\tjson: { message: 'hello' }\r\n\t}\r\n```\r\nIt works fine, but I wonder if this is a good practice (?)","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/607","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/607/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/607/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/607/events","html_url":"https://github.com/leafo/lapis/issues/607","id":304451245,"node_id":"MDU6SXNzdWUzMDQ0NTEyNDU=","number":607,"title":"cqueue support","user":{"login":"CodelessFuture","id":26814295,"node_id":"MDQ6VXNlcjI2ODE0Mjk1","avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-03-12T16:44:13Z","updated_at":"2018-03-13T12:27:24Z","closed_at":"2018-03-13T12:27:24Z","author_association":"NONE","body":"Hi,\r\n\r\nI'm interested in queue http-lua support.\r\n\r\nThis let Lapis be compatible be compatible with Lua 5.3? Are you planning to update on Luarocks?","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/605","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/605/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/605/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/605/events","html_url":"https://github.com/leafo/lapis/issues/605","id":301960185,"node_id":"MDU6SXNzdWUzMDE5NjAxODU=","number":605,"title":"[bug] encode_query_string does not encode ampersands","user":{"login":"Guard13007","id":15093567,"node_id":"MDQ6VXNlcjE1MDkzNTY3","avatar_url":"https://avatars3.githubusercontent.com/u/15093567?v=4","gravatar_id":"","url":"https://api.github.com/users/Guard13007","html_url":"https://github.com/Guard13007","followers_url":"https://api.github.com/users/Guard13007/followers","following_url":"https://api.github.com/users/Guard13007/following{/other_user}","gists_url":"https://api.github.com/users/Guard13007/gists{/gist_id}","starred_url":"https://api.github.com/users/Guard13007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guard13007/subscriptions","organizations_url":"https://api.github.com/users/Guard13007/orgs","repos_url":"https://api.github.com/users/Guard13007/repos","events_url":"https://api.github.com/users/Guard13007/events{/privacy}","received_events_url":"https://api.github.com/users/Guard13007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-03-03T02:33:11Z","updated_at":"2018-03-11T06:40:39Z","closed_at":"2018-03-11T01:36:47Z","author_association":"CONTRIBUTOR","body":"Ampersands should be encoded into `&amp;` within HTML attributes, which is where I assume the output of encode_query_string is intended to be used / most often used.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/602","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/602/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/602/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/602/events","html_url":"https://github.com/leafo/lapis/issues/602","id":293446626,"node_id":"MDU6SXNzdWUyOTM0NDY2MjY=","number":602,"title":"Autoload is failing strangely?","user":{"login":"Guard13007","id":15093567,"node_id":"MDQ6VXNlcjE1MDkzNTY3","avatar_url":"https://avatars3.githubusercontent.com/u/15093567?v=4","gravatar_id":"","url":"https://api.github.com/users/Guard13007","html_url":"https://github.com/Guard13007","followers_url":"https://api.github.com/users/Guard13007/followers","following_url":"https://api.github.com/users/Guard13007/following{/other_user}","gists_url":"https://api.github.com/users/Guard13007/gists{/gist_id}","starred_url":"https://api.github.com/users/Guard13007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guard13007/subscriptions","organizations_url":"https://api.github.com/users/Guard13007/orgs","repos_url":"https://api.github.com/users/Guard13007/repos","events_url":"https://api.github.com/users/Guard13007/events{/privacy}","received_events_url":"https://api.github.com/users/Guard13007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-02-01T08:44:30Z","updated_at":"2018-02-22T20:01:59Z","closed_at":"2018-02-22T20:01:59Z","author_association":"CONTRIBUTOR","body":"I have one file that returns a table of Models, and I have modified the default `models.moon` to use a second argument to `autoload` with a require of said file, and *one* of the two Models defined there is successfully accessible, but the other one disappears entirely.\r\n\r\nI've tried to replicate the issue with a minimal application, but have not had success. I can require the file that returns a table of Models and access them correctly. I can require them individually, and it works correctly. I can verify everything is functioning correctly EXCEPT requiring `models` and accessing ***one*** of the two Models defined in this other file.\r\n\r\nOf course, the whole reason I'm doing things in this convoluted way is because I'm trying to split out some of a site's functionality into a sub-application that defines its own models locally to it, yet have them accessible from elsewhere under the same models path as everything else. Maybe I just shouldn't do it this way.\r\n\r\n(Would you be interested in seeing the minimal version that still works correctly? I figured there wasn't a point in sharing it since it doesn't show anything wrong, but maybe it alludes to a flaw in my thinking?)\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/601","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/601/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/601/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/601/events","html_url":"https://github.com/leafo/lapis/issues/601","id":292506171,"node_id":"MDU6SXNzdWUyOTI1MDYxNzE=","number":601,"title":"Is there a way to modify the URL before it gets matched to a route?","user":{"login":"Guard13007","id":15093567,"node_id":"MDQ6VXNlcjE1MDkzNTY3","avatar_url":"https://avatars3.githubusercontent.com/u/15093567?v=4","gravatar_id":"","url":"https://api.github.com/users/Guard13007","html_url":"https://github.com/Guard13007","followers_url":"https://api.github.com/users/Guard13007/followers","following_url":"https://api.github.com/users/Guard13007/following{/other_user}","gists_url":"https://api.github.com/users/Guard13007/gists{/gist_i
8000
d}","starred_url":"https://api.github.com/users/Guard13007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guard13007/subscriptions","organizations_url":"https://api.github.com/users/Guard13007/orgs","repos_url":"https://api.github.com/users/Guard13007/repos","events_url":"https://api.github.com/users/Guard13007/events{/privacy}","received_events_url":"https://api.github.com/users/Guard13007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-01-29T18:08:14Z","updated_at":"2018-01-29T18:27:11Z","closed_at":"2018-01-29T18:27:11Z","author_association":"CONTRIBUTOR","body":"I have a splat capturing anything that doesn't match another route, which means I can't use the [default_route](http://leafo.net/lapis/reference/actions.html#application-callbacks/default-action), but I want to use the logic to strip trailing `/`'s.\r\n\r\nI figure the easiest way to fix this would just be to strip these before matching against routes, since I will never be using a trailing slash anyhow. How would I go about accomplishing this?\r\n\r\nAlternately, is there a way I can check if a URL matches against a route elsewhere? I can make my splat check for an existing route after stripping the trailing slash, and redirect, or just go to a 404.\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/600","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/600/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/600/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/600/events","html_url":"https://github.com/leafo/lapis/issues/600","id":290281622,"node_id":"MDU6SXNzdWUyOTAyODE2MjI=","number":600,"title":"Try and serve page, and if it fails display the error page ?","user":{"login":"Yarillo4","id":23503179,"node_id":"MDQ6VXNlcjIzNTAzMTc5","avatar_url":"https://avatars0.githubusercontent.com/u/23503179?v=4","gravatar_id":"","url":"https://api.github.com/users/Yarillo4","html_url":"https://github.com/Yarillo4","followers_url":"https://api.github.com/users/Yarillo4/followers","following_url":"https://api.github.com/users/Yarillo4/following{/other_user}","gists_url":"https://api.github.com/users/Yarillo4/gists{/gist_id}","starred_url":"https://api.github.com/users/Yarillo4/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yarillo4/subscriptions","organizations_url":"https://api.github.com/users/Yarillo4/orgs","repos_url":"https://api.github.com/users/Yarillo4/repos","events_url":"https://api.github.com/users/Yarillo4/events{/privacy}","received_events_url":"https://api.github.com/users/Yarillo4/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-01-21T15:36:36Z","updated_at":"2018-01-22T22:03:29Z","closed_at":"2018-01-22T22:03:29Z","author_association":"NONE","body":"EDIT: 600th issue ! \\o/\r\n\r\nHello, I have a code snippet for you\r\n\r\nBasically what I do is I have a route for \"/projects/:name\" which serves \"views.projects.\" .. self.params.name\r\n\r\nIf I try to access a view that doesn't exist I'd like to catch that exception and render the \"error\" page.\r\n\r\nUnfortunately I can't use pcall for this as I'm not the one calling the \"render\" function. Lapis does.\r\n\r\nSooo... am I missing something ? How do I do that ?\r\n\r\nBasically i'm only getting the default traceback instead of my error page (or a regular page if I hit a view that exists).\r\n\r\n![img](https://i.imgur.com/xzifgoo.png)\r\n\r\n```LUA\r\nlocal lapis = require \"lapis\"\r\nlocal lfs = require \"lfs\"\r\nlocal app_helpers = require \"lapis.application\"\r\nlocal capture_errors, yield_error = app_helpers.capture_errors, app_helpers.yield_error\r\n\r\nlocal app = lapis.Application()\r\n\r\napp:enable(\"etlua\")\r\napp.layout = require \"views.layout\"\r\n\r\n\r\nlocal function notfound(self)\r\n\tself.pageTitle = \"404\"\r\n\tself.status    =  404\r\n\treturn { \r\n\t\trender = \"error\", --my error page\r\n\t\tstatus = 404\r\n\t} \r\nend\r\n\r\napp:match(\"/*\", notfound)\r\n\r\n---------------------------------------------------------------------------\r\n-- Relevant code                                                         --\r\n-- Exception handling doesn't work properly or I misunderstood something --\r\n-- (probably the latter)                                                 --\r\n---------------------------------------------------------------------------\r\napp:match(\"/projects/:name\", capture_errors(\r\n{\r\n\ton_error = notfound,\r\n\tfunction(self)\r\n\t\tself.pageTitle = self.params.name\r\n\t\treturn { render = \"projects.\" .. self.params.name}\r\n\tend\r\n}\r\n))\r\n\r\nreturn app\r\n```\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/599","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/599/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/599/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/599/events","html_url":"https://github.com/leafo/lapis/issues/599","id":287936271,"node_id":"MDU6SXNzdWUyODc5MzYyNzE=","number":599,"title":"Lua: Invalid require when using models","user":{"login":"karai17","id":590332,"node_id":"MDQ6VXNlcjU5MDMzMg==","avatar_url":"https://avatars3.githubusercontent.com/u/590332?v=4","gravatar_id":"","url":"https://api.github.com/users/karai17","html_url":"https://github.com/karai17","followers_url":"https://api.github.com/users/karai17/followers","following_url":"https://api.github.com/users/karai17/following{/other_user}","gists_url":"https://api.github.com/users/karai17/gists{/gist_id}","starred_url":"https://api.github.com/users/karai17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karai17/subscriptions","organizations_url":"https://api.github.com/users/karai17/orgs","repos_url":"https://api.github.com/users/karai17/repos","events_url":"https://api.github.com/users/karai17/events{/privacy}","received_events_url":"https://api.github.com/users/karai17/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-01-11T21:50:54Z","updated_at":"2018-01-17T20:34:36Z","closed_at":"2018-01-17T20:34:36Z","author_association":"NONE","body":"https://github.com/leafo/lapis/blob/master/lapis/db/base_model.lua#L218\r\n\r\n```\r\nError\r\n/usr/share/lua/5.1/lapis/db/base_model.lua:218: module 'models' not found:\r\n\tno field package.preload['models']\r\n\tno file '/root/.luarocks/share/lua/5.1/models.lua'\r\n\tno file '/root/.luarocks/share/lua/5.1/models/init.lua'\r\n\tno file '/usr/share/lua/5.1/models.lua'\r\n\tno file '/usr/share/lua/5.1/models/init.lua'\r\n\tno file './models.lua'\r\n\tno file '/usr/share/luajit-2.0.4/models.lua'\r\n\tno file '/usr/local/share/lua/5.1/models.lua'\r\n\tno file '/usr/local/share/lua/5.1/models/init.lua'\r\n\tno file '/usr/local/openresty/lualib/models.lua'\r\n\tno file './src/models.lua'\r\n\tno file './src/models/init.lua'\r\n\tno file '/root/.luarocks/lib/lua/5.1/models.so'\r\n\tno file '/usr/lib/lua/5.1/models.so'\r\n\tno file './models.so'\r\n\tno file '/usr/local/lib/lua/5.1/models.so'\r\n\tno file '/usr/lib64/lua/5.1/models.so'\r\n\tno file '/usr/local/lib/lua/5.1/loadall.so'\r\nTraceback\r\nstack traceback:\r\n\t[C]: in function 'require'\r\n\t/usr/share/lua/5.1/lapis/db/base_model.lua:218: in function 'get_relation_model'\r\n\t/usr/share/lua/5.1/lapis/db/model/relations.lua:9: in function 'assert_model'\r\n\t/usr/share/lua/5.1/lapis/db/model/relations.lua:384: in function 'get_players'\r\n\t./src/controllers/players.lua:28: in function 'handler'\r\n\t/usr/share/lua/5.1/lapis/application.lua:130: in function 'resolve'\r\n\t/usr/share/lua/5.1/lapis/application.lua:161: in function </usr/share/lua/5.1/lapis/application.lua:159>\r\n\t[C]: in function 'xpcall'\r\n\t/usr/share/lua/5.1/lapis/application.lua:159: in function 'dispatch'\r\n\t/usr/share/lua/5.1/lapis/nginx.lua:215: in function 'serve'\r\n\tcontent_by_lua(nginx.conf.compiled:28):1: in function <content_by_lua(nginx.conf.compiled:28):1>\r\n```\r\n\r\n```lua\r\n-- Users model\r\nlocal db    = require(\"lapis.db\")\r\nlocal Model = require(\"lapis.db.model\").Model\r\nlocal Users = Model:extend(\"users\", {\r\n\trelations = {\r\n\t\t{ \"players\", has_many = \"Players\" }\r\n\t}\r\n})\r\n\r\n--- Get data from an existing User\r\n-- @tparam string username Username of User\r\n-- @treturn table User object\r\nfunction Users:select_user(username)\r\n\treturn self:find {\r\n\t\tusername = username\r\n\t}\r\nend\r\n\r\n-- Some controller\r\nlocal user = Users:select_user(request.username)\r\nif not user then\r\n\treturn {\r\n\t\tstatus = http_code.BAD_REQUEST,\r\n\t\tjson   = {}\r\n\t}\r\nend\r\n\r\nlocal players = user:get_players() -- this line causes the crash\r\nif not players then\r\n\treturn {\r\n\t\tstatus = http_code.BAD_REQUEST,\r\n\t\tjson   = {}\r\n\t}\r\nend\r\n```","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/598","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/598/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/598/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/598/events","html_url":"https://github.com/leafo/lapis/issues/598","id":286352365,"node_id":"MDU6SXNzdWUyODYzNTIzNjU=","number":598,"title":"Parameter parser can crash","user":{"login":"bungle","id":983257,"node_id":"MDQ6VXNlcjk4MzI1Nw==","avatar_url":"https://avatars0.githubusercontent.com/u/983257?v=4","gravatar_id":"","url":"https://api.github.com/users/bungle","html_url":"https://github.com/bungle","followers_url":"https://api.github.com/users/bungle/followers","following_url":"https://api.github.com/users/bungle/following{/other_user}","gists_url":"https://api.github.com/users/bungle/gists{/gist_id}","starred_url":"https://api.github.com/users/bungle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bungle/subscriptions","organizations_url":"https://api.github.com/users/bungle/orgs","repos_url":"https://api.github.com/users/bungle/repos","events_url":"https://api.github.com/users/bungle/events{/privacy}","received_events_url":"https://api.github.com/users/bungle/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-01-05T17:24:46Z","updated_at":"2018-02-01T21:42:34Z","closed_at":"2018-02-01T21:42:34Z","author_association":"NONE","body":"One problem is here:\r\nhttps://github.com/bungle/lapis/blob/master/lapis/request.lua#L303\r\n\r\nIt is not guaranteed that the `curr`is a table. Also here is small example:\r\nhttps://itch.io/?p[0]=4","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/595","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/595/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/595/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/595/events","html_url":"https://github.com/leafo/lapis/issues/595","id":284521736,"node_id":"MDU6SXNzdWUyODQ1MjE3MzY=","number":595,"title":"No library CRYPTO","user":{"login":"Pancakeddd","id":23126782,"node_id":"MDQ6VXNlcjIzMTI2Nzgy","avatar_url":"https://avatars2.githubusercontent.com/u/23126782?v=4","gravatar_id":"","url":"https://api.github.com/users/Pancakeddd","html_url":"https://github.com/Pancakeddd","followers_url":"https://api.github.com/users/Pancakeddd/followers","following_url":"https://api.github.com/users/Pancakeddd/following{/other_user}","gists_url":"https://api.github.com/users/Pancakeddd/gists{/gist_id}","starred_url":"https://api.github.com/users/Pancakeddd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Pancakeddd/subscriptions","organizations_url":"https://api.github.com/users/Pancakeddd/orgs","repos_url":"https://api.github.com/users/Pancakeddd/repos","events_url":"https://api.github.com/users/Pancakeddd/events{/privacy}","received_events_url":"https://api.github.com/users/Pancakeddd/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-26T09:07:08Z","updated_at":"2018-01-05T20:29:16Z","closed_at":"2018-01-05T20:29:16Z","author_association":"NONE","body":"`nathanmoosh@nathanmoosh-GL702VSK:~$ luarocks install lapis\r\nInstalling https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/lapis-1.6.0-1.src.rock...\r\nUsing https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/lapis-1.6.0-1.src.rock... switching to 'build' mode\r\n\r\nMissing dependencies for lapis:\r\nluaossl \r\nloadkit \r\nmimetypes \r\nansicolors \r\ndate \r\npgmoon \r\netlua \r\n\r\nUsing https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/luaossl-20171028-0.src.rock... switching to 'build' mode\r\n\r\nError: Failed installing dependency: https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/luaossl-20171028-0.src.rock - Could not find library file for CRYPTO\r\n  No file libcrypto.a in /usr/lib\r\n  No file libcrypto.so in /usr/lib\r\n  No file matching libcrypto.so.* in /usr/lib\r\nYou may have to install CRYPTO in your system and/or pass CRYPTO_DIR or CRYPTO_LIBDIR to the luarocks command.\r\nExample: luarocks install luaossl CRYPTO_DIR=/usr/local\r\n`\r\n\r\nPlease help!","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/594","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/594/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/594/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/594/events","html_url":"https://github.com/leafo/lapis/issues/594","id":283808874,"node_id":"MDU6SXNzdWUyODM4MDg4NzQ=","number":594,"title":"writing a test for file uploads","user":{"login":"Kukuzapa","id":34736639,"node_id":"MDQ6VXNlcjM0NzM2NjM5","avatar_url":"https://avatars0.githubusercontent.com/u/34736639?v=4","gravatar_id":"","url":"https://api.github.com/users/Kukuzapa","html_url":"https://github.com/Kukuzapa","followers_url":"https://api.github.com/users/Kukuzapa/followers","following_url":"https://api.github.com/users/Kukuzapa/following{/other_user}","gists_url":"https://api.github.com/users/Kukuzapa/gists{/gist_id}","starred_url":"https://api.github.com/users/Kukuzapa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kukuzapa/subscriptions","organizations_url":"https://api.github.com/users/Kukuzapa/orgs","repos_url":"https://api.github.com/users/Kukuzapa/repos","events_url":"https://api.github.com/users/Kukuzapa/events{/privacy}","received_events_url":"https://api.github.com/users/Kukuzapa/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-21T08:38:05Z","updated_at":"2018-02-22T20:02:54Z","closed_at":"2018-02-22T20:02:54Z","author_association":"NONE","body":"How do I test my upload script for uploading files? I can not pass the upload table using request (url, options) since options.post does not support nested tables.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/593","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/593/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/593/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/593/events","html_url":"https://github.com/leafo/lapis/issues/593","id":283133829,"node_id":"MDU6SXNzdWUyODMxMzM4Mjk=","number":593,"title":"Is it possible to obtain status code in a view?","user":{"login":"tpimh","id":1071872,"node_id":"MDQ6VXNlcjEwNzE4NzI=","avatar_url":"https://avatars3.githubusercontent.com/u/1071872?v=4","gravatar_id":"","url":"https://api.github.com/users/tpimh","html_url":"https://github.com/tpimh","followers_url":"https://api.github.com/users/tpimh/followers","following_url":"https://api.github.com/users/tpimh/following{/other_user}","gists_url":"https://api.github.com/users/tpimh/gists{/gist_id}","starred_url":"https://api.github.com/users/tpimh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tpimh/subscriptions","organizations_url":"https://api.github.com/users/tpimh/orgs","repos_url":"https://api.github.com/users/tpimh/repos","events_url":"https://api.github.com/users/tpimh/events{/privacy}","received_events_url":"https://api.github.com/users/tpimh/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-19T07:54:00Z","updated_at":"2018-02-22T20:06:37Z","closed_at":"2018-02-22T20:06:37Z","author_association":"NONE","body":"I was trying to print it as `<%= ngx.status %>` and `<%= ngx.var.status %>`, but it didn't work. The only way I get it to work is saving status code before setting it to a variable and then printing it's value. Is there a better way?","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/591","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/591/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/591/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/591/events","html_url":"https://github.com/leafo/lapis/issues/591","id":281998698,"node_id":"MDU6SXNzdWUyODE5OTg2OTg=","number":591,"title":"How to change the types.varchar length?","user":{"login":"uudiin","id":4622009,"node_id":"MDQ6VXNlcjQ2MjIwMDk=","avatar_url":"https://avatars0.githubusercontent.com/u/4622009?v=4","gravatar_id":"","url":"https://api.github.com/users/uudiin","html_url":"https://github.com/uudiin","followers_url":"https://api.github.com/users/uudiin/followers","following_url":"https://api.github.com/users/uudiin/following{/other_user}","gists_url":"https://api.github.com/users/uudiin/gists{/gist_id}","starred_url":"https://api.github.com/users/uudiin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uudiin/subscriptions","organizations_url":"https://api.github.com/users/uudiin/orgs","repos_url":"https://api.github.com/users/uudiin/repos","events_url":"https://api.github.com/users/uudiin/events{/privacy}","received_events_url":"https://api.github.com/users/uudiin/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-14T06:51:01Z","updated_at":"2017-12-15T03:39:57Z","closed_at":"2017-12-15T03:39:57Z","author_association":"NONE","body":"I use the varchar with length 4096, alse as a primary key\r\n\r\n`types.varchar(4096, { primary_key = true })`\r\n\r\nA runtime error occured. How to fix it?\r\nThanks.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/590","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/590/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/590/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/590/events","html_url":"https://github.com/leafo/lapis/issues/590","id":281965944,"node_id":"MDU6SXNzdWUyODE5NjU5NDQ=","number":590,"title":"How can I insert multi value to postgresql at a time?","user":{"login":"uudiin","id":4622009,"node_id":"MDQ6VXNlcjQ2MjIwMDk=","avatar_url":"https://avatars0.githubusercontent.com/u/4622009?v=4","gravatar_id":"","url":"https://api.github.com/users/uudiin","html_url":"https://github.com/uudiin","followers_url":"https://api.github.com/users/uudiin/followers","following_url":"https://api.github.com/users/uudiin/following{/other_user}","gists_url":"https://api.github.com/users/uudiin/gists{/gist_id}","starred_url":"https://api.github.com/users/uudiin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uudiin/subscriptions","organizations_url":"https://api.github.com/users/uudiin/orgs","repos_url":"https://api.github.com/users/uudiin/repos","events_url":"https://api.github.com/users/uudiin/events{/privacy}","received_events_url":"https://api.github.com/users/uudiin/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-14T02:57:32Z","updated_at":"2017-12-15T03:37:40Z","closed_at":"2017-12-15T03:37:40Z","author_association":"NONE","body":"Cound I insert multi value to db at a time? \r\n\r\n`INSERT INTO \"my_table\" (\"age\", \"name\") VALUES (10, 'Hello World'), (22, 'Hello')`\r\n\r\nIs lapis supported?\r\nThanks a lot","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/589","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/589/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/589/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/589/events","html_url":"https://github.com/leafo/lapis/issues/589","id":280672401,"node_id":"MDU6SXNzdWUyODA2NzI0MDE=","number":589,"title":"Session signing  HMAC SHA1","user":{"login":"karai17","id":590332,"node_id":"MDQ6VXNlcjU5MDMzMg==","avatar_url":"https://avatars3.githubusercontent.com/u/590332?v=4","gravatar_id":"","url":"https://api.github.com/users/karai17","html_url":"https://github.com/karai17","followers_url":"https://api.github.com/users/karai17/followers","following_url":"https://api.github.com/users/karai17/following{/other_user}","gists_url":"https://api.github.com/users/karai17/gists{/gist_id}","starred_url":"https://api.github.com/users/karai17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karai17/subscriptions","organizations_url":"https://api.github.com/users/karai17/orgs","repos_url":"https://api.github.com/users/karai17/repos","events_url":"https://api.github.com/users/karai17/events{/privacy}","received_events_url":"https://api.github.com/users/karai17/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2017-12-09T03:30:47Z","updated_at":"2018-04-07T22:04:28Z","closed_at":"2018-02-26T05:34:37Z","author_association":"NONE","body":"With Google's recentish proof of concept in breaking SHA1, it might be wise to change the encryption algorithm used for sessions.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/588","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/588/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/588/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/588/events","html_url":"https://github.com/leafo/lapis/issues/588","id":280083620,"node_id":"MDU6SXNzdWUyODAwODM2MjA=","number":588,"title":"how to capture database error","user":{"login":"zhouniandi","id":4343167,"node_id":"MDQ6VXNlcjQzNDMxNjc=","avatar_url":"https://avatars0.githubusercontent.com/u/4343167?v=4","gravatar_id":"","url":"https://api.github.com/users/zhouniandi","html_url":"https://github.com/zhouniandi","followers_url":"https://api.github.com/users/zhouniandi/followers","following_url":"https://api.github.com/users/zhouniandi/following{/other_user}","gists_url":"https://api.github.com/users/zhouniandi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhouniandi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhouniandi/subscriptions","organizations_url":"https://api.github.com/users/zhouniandi/orgs","repos_url":"https://api.github.com/users/zhouniandi/repos","events_url":"https://api.github.com/users/zhouniandi/events{/privacy}","received_events_url":"https://api.github.com/users/zhouniandi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-07T10:49:41Z","updated_at":"2017-12-15T08:03:47Z","closed_at":"2017-12-15T08:03:47Z","author_association":"NONE","body":"Hi.\r\nI need to capture database error message  render to json , but the postgres.lua _query funcation always render to the error.lua view.\r\n\r\npostgres.lua\r\n```\r\n94      if not res and err then\r\n95          error(tostring(str) .. \"\\n\" .. tostring(err))\r\n96      end\r\n```","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/586","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/586/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/586/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/586/events","html_url":"https://github.com/leafo/lapis/issues/586","id":279052417,"node_id":"MDU6SXNzdWUyNzkwNTI0MTc=","number":586,"title":"failed to find model `model` for relation","user":{"login":"CodelessFuture","id":26814295,"node_id":"MDQ6VXNlcjI2ODE0Mjk1","avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2017-12-04T16:11:21Z","updated_at":"2018-04-06T20:09:49Z","closed_at":"2017-12-05T07:27:02Z","author_association":"NONE","body":"failed to find model `Golfclubs` for relation\r\n\r\nThis is my models.lua:\r\n```lua\r\nlocal autoload = require(\"lapis.util\").autoload\r\nreturn autoload(\"models\")\r\n```\r\n\r\nThis are the relations:\r\n```lua\r\nlocal Model = require(\"lapis.db.model\").Model\r\nlocal Golfclubs = Model:extend(\"golfclubs\", {\r\n  relations = {\r\n    {\"coupons\", has_many = \"Coupons\"}\r\n  }\r\n})\r\nlocal Coupons = Model:extend(\"coupons\", {\r\n  relations = {\r\n    {\"golfclub\", belongs_to = \"Golfclubs\"}\r\n  }\r\n})\r\n```\r\n\r\nThis are the migrations:\r\n```lua\r\n    schema.create_table(\"golfclubs\", {\r\n      { \"id\", types.serial },\r\n      { \"name\", types.text },\r\n      { \"logo\", types.text({ null = true }) },\r\n      { \"description\", types.text },\r\n      { \"image\", types.text({ null = true }) },\r\n      { \"address\", types.text },\r\n      { \"latitude\", types.text({ null = true }) },\r\n      { \"longitude\", types.text({ null = true }) },\r\n      { \"phone\", types.text({ null = true }) },\r\n      { \"email\", types.text({ null = true }) },\r\n\r\n      \"PRIMARY KEY (id)\"\r\n    })\r\n\r\n    schema.create_table(\"coupons\", {\r\n      { \"id\", types.serial },\r\n      { \"name\", types.text },\r\n      { \"description\", types.text },\r\n      { \"condition\", types.text },\r\n      { \"quantity\", types.integer({ default = 1}) },\r\n      { \"golfclub_id\", types.foreign_key },\r\n\r\n      \"PRIMARY KEY (id)\"\r\n    })\r\n```\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/585","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/585/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/585/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/585/events","html_url":"https://github.com/leafo/lapis/issues/585","id":278670354,"node_id":"MDU6SXNzdWUyNzg2NzAzNTQ=","number":585,"title":"File uploads validation","user":{"login":"CodelessFuture","id":26814295,"node_id":"MDQ6VXNlcjI2ODE0Mjk1","avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-12-02T09:33:27Z","updated_at":"2018-03-02T12:50:28Z","closed_at":"2018-03-02T12:50:28Z","author_association":"NONE","body":"Hi.\r\n\r\nI need to validate if the field is a file upload but only if present (it is not a required field)\r\n\r\nI'm using  \r\n```lua\r\nvalidate.assert_valid(self.params, {\r\n   ...\r\n   { \"logo\", is_file = true },\r\n   ....\r\n})\r\n```\r\n\r\nBut so it is required always giving a \"Missing file\" error\r\n\r\nAlso what's the difference with _file_exists = true_ ?\r\n\r\nAlso I need an optional validation for other field, so the file can be present or not, but if present can have only min 8 max 10 char......and so on.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/584","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/584/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/584/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/584/events","html_url":"https://github.com/leafo/lapis/issues/584","id":278537856,"node_id":"MDU6SXNzdWUyNzg1Mzc4NTY=","number":584,"title":"Input Validation","user":{"login":"CodelessFuture","id":26814295,"node_id":"MDQ6VXNlcjI2ODE0Mjk1","avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-01T17:25:00Z","updated_at":"2017-12-01T18:32:20Z","closed_at":"2017-12-01T18:32:20Z","author_association":"NONE","body":"I read at http://leafo.net/lapis/reference/input_validation.html#validation-functions\r\n\r\nSorry I don't understand in which variable goes the errors a
30b9
nd so how to show them","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/583","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/583/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/583/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/583/events","html_url":"https://github.com/leafo/lapis/issues/583","id":278410673,"node_id":"MDU6SXNzdWUyNzg0MTA2NzM=","number":583,"title":"Many to Many Relations and pivot table.","user":{"login":"CodelessFuture","id":26814295,"node_id":"MDQ6VXNlcjI2ODE0Mjk1","avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-01T09:46:47Z","updated_at":"2017-12-01T17:22:45Z","closed_at":"2017-12-01T17:22:45Z","author_association":"NONE","body":"Reading the docs I don't find anything about many to many relationship so I think is not implemented yet.\r\n\r\nI think I have to create the tables with migrations and models for working on the records then build the query manually, right?","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/582","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/582/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/582/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/582/events","html_url":"https://github.com/leafo/lapis/issues/582","id":278409055,"node_id":"MDU6SXNzdWUyNzg0MDkwNTU=","number":582,"title":"Api and Web route","user":{"login":"CodelessFuture","id":26814295,"node_id":"MDQ6VXNlcjI2ODE0Mjk1","avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2017-12-01T09:40:31Z","updated_at":"2017-12-02T09:28:12Z","closed_at":"2017-12-02T09:28:12Z","author_association":"NONE","body":"I have 2 distinct route in my web app. The first is a web backend for admin and CRUD operation, the second is the API talking with a Mobile app.\r\n\r\nThe first need session, cookies and views, the second jwt token and son response.\r\n\r\nActually I made this in Nginx.conf and it works (but I'm open to suggestion and better practices):\r\n\r\n```\r\n....\r\nserver {\r\n    listen ${{PORT}};\r\n    lua_code_cache ${{CODE_CACHE}};\r\n\r\n    location / {\r\n      default_type text/html;\r\n      content_by_lua '\r\n        require(\"lapis\").serve(\"app\")\r\n      ';\r\n    }\r\n\t\r\n\tlocation /api {\r\n      default_type text/html;\r\n      content_by_lua '\r\n        require(\"lapis\").serve(\"api\")\r\n      ';\r\n    }\r\n....\r\n```\r\n\r\nSo I have an app.lua and an api.lua and works well, but I have to put /api in all route: there's a method to have automatically /api appended to the route in api.lua?\r\n\r\n```lua\r\n-- now:\r\napi:post(\"/api/seed\" , function()\r\n........\r\n\r\n-- then:\r\napi:post(\"/seed\" , function()\r\n\r\nbut always pointing to: /api/lua\r\n```","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/581","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/581/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/581/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/581/events","html_url":"https://github.com/leafo/lapis/issues/581","id":278277927,"node_id":"MDU6SXNzdWUyNzgyNzc5Mjc=","number":581,"title":"Lapis test: Don't know if this is correct and how to test in this case","user":{"login":"CodelessFuture","id":26814295,"node_id":"MDQ6VXNlcjI2ODE0Mjk1","avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-11-30T21:35:47Z","updated_at":"2017-12-01T17:20:21Z","closed_at":"2017-11-30T21:56:00Z","author_association":"NONE","body":"Lapis test:\r\n--- \r\nThe function has three return values: the status code as a number, the body of the response and any response headers in a table.\r\n---\r\nBut if I have a redirect (eg. after a valid login) the body is empy......so I cannot match on a text on the redirected page","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/580","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/580/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/580/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/580/events","html_url":"https://github.com/leafo/lapis/issues/580","id":277825912,"node_id":"MDU6SXNzdWUyNzc4MjU5MTI=","number":580,"title":"Detach lapis models from lapis?","user":{"login":"italomaia","id":14670,"node_id":"MDQ6VXNlcjE0Njcw","avatar_url":"https://avatars1.githubusercontent.com/u/14670?v=4","gravatar_id":"","url":"https://api.github.com/users/italomaia","html_url":"https://github.com/italomaia","followers_url":"https://api.github.com/users/italomaia/followers","following_url":"https://api.github.com/users/italomaia/following{/other_user}","gists_url":"https://api.github.com/users/italomaia/gists{/gist_id}","starred_url":"https://api.github.com/users/italomaia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/italomaia/subscriptions","organizations_url":"https://api.github.com/users/italomaia/orgs","repos_url":"https://api.github.com/users/italomaia/repos","events_url":"https://api.github.com/users/italomaia/events{/privacy}","received_events_url":"https://api.github.com/users/italomaia/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2017-11-29T16:45:11Z","updated_at":"2018-02-25T14:10:59Z","closed_at":"2017-12-08T22:45:17Z","author_association":"NONE","body":"Would it be reasonable to have Lapis ORM as a package independent from lapis? As there are few ORMs for Lua, maybe that would be helpful. ","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/578","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/578/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/578/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/578/events","html_url":"https://github.com/leafo/lapis/issues/578","id":266651147,"node_id":"MDU6SXNzdWUyNjY2NTExNDc=","number":578,"title":"MySQL migration requires ngx","user":{"login":"tpimh","id":1071872,"node_id":"MDQ6VXNlcjEwNzE4NzI=","avatar_url":"https://avatars3.githubusercontent.com/u/1071872?v=4","gravatar_id":"","url":"https://api.github.com/users/tpimh","html_url":"https://github.com/tpimh","followers_url":"https://api.github.com/users/tpimh/followers","following_url":"https://api.github.com/users/tpimh/following{/other_user}","gists_url":"https://api.github.com/users/tpimh/gists{/gist_id}","starred_url":"https://api.github.com/users/tpimh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tpimh/subscriptions","organizations_url":"https://api.github.com/users/tpimh/orgs","repos_url":"https://api.github.com/users/tpimh/repos","events_url":"https://api.github.com/users/tpimh/events{/privacy}","received_events_url":"https://api.github.com/users/tpimh/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-10-18T21:39:57Z","updated_at":"2017-10-20T21:43:47Z","closed_at":"2017-10-20T21:43:47Z","author_association":"NONE","body":"Running `lapis migrate --trace`:\r\n\r\n    /usr/local/openresty/luajit/bin/luajit: /usr/local/openresty/luajit/share/lua/5.1/resty/mysql.lua:5: attempt to index global 'ngx' (a nil value)\r\n    stack traceback:\r\n\t    /usr/local/openresty/luajit/share/lua/5.1/resty/mysql.lua:5: in main chunk\r\n\t    [C]: in function 'require'\r\n\t    .../local/openresty/luajit/share/lua/5.1/lapis/db/mysql.lua:101: in function 'backend'\r\n\t    .../local/openresty/luajit/share/lua/5.1/lapis/db/mysql.lua:164: in function 'connect'\r\n\t    .../local/openresty/luajit/share/lua/5.1/lapis/db/mysql.lua:183: in function 'escape_literal'\r\n\t    ...openresty/luajit/share/lua/5.1/lapis/db/mysql/schema.lua:48: in function 'entity_exists'\r\n\t    ...l/openresty/luajit/share/lua/5.1/lapis/db/migrations.lua:73: in function 'run_migrations'\r\n\t    ...cal/openresty/luajit/share/lua/5.1/lapis/cmd/actions.lua:282: in function 'execute'\r\n\t    /usr/local/openresty/luajit/bin/lapis:4: in main chunk\r\n\t    [C]: at 0x5610cbc85360\r\n\r\nMy `config.lua`:\r\n\r\n    config = require \"lapis.config\"\r\n\r\n    config(\"development\", {\r\n      port = 8080,\r\n      mysql = {\r\n        backend = \"resty_mysql\",\r\n        path = \"/var/run/mysqld/mysqld.sock\",\r\n        database = \"test\",\r\n        user = \"test\",\r\n        password = \"test\"\r\n      },\r\n      redis = {\r\n        path = \"/var/run/redis/redis.sock\"\r\n      }\r\n    })\r\n\r\nMy `migrations.lua`:\r\n\r\n    local schema = require(\"lapis.db.schema\")\r\n    local types = schema.types\r\n\r\n    return {\r\n      [1] = function()\r\n        schema.create_table(\"things\", {\r\n          { \"id\", types.id },\r\n          { \"name\", types.varchar }\r\n        })\r\n        schema.create_table(\"users\", {\r\n          { \"id\", types.id },\r\n          { \"username\", types.varchar },\r\n          { \"password\", types.varchar }\r\n        })\r\n      end\r\n    }\r\n\r\nAm I doing something wrong?","score":1.0}]}
0

