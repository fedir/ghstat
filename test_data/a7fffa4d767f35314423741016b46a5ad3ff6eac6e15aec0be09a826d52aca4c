HTTP/1.1 200 OK
Transfer-Encoding: chunked
Access-Control-Allow-Origin: *
Access-Control-Expose-Headers: ETag, Link, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval
Cache-Control: no-cache
Content-Security-Policy: default-src 'none'
Content-Type: application/json; charset=utf-8
Date: Sun, 08 Apr 2018 22:38:01 GMT
Link: <https://api.github.com/search/issues?q=repo%3Aleafo%2Flapis+type%3Aissue+state%3Aclosed&page=2>; rel="next", <https://api.github.com/search/issues?q=repo%3Aleafo%2Flapis+type%3Aissue+state%3Aclosed&page=13>; rel="last"
Referrer-Policy: origin-when-cross-origin, strict-origin-when-cross-origin
Server: GitHub.com
Status: 200 OK
Strict-Transport-Security: max-age=31536000; includeSubdomains; preload
X-Accepted-Oauth-Scopes: 
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-Github-Media-Type: github.v3; format=json
X-Github-Request-Id: CD98:54B9:144BFD1:28CDE64:5ACA99C9
X-Oauth-Scopes: 
X-Ratelimit-Limit: 30
X-Ratelimit-Remaining: 14
X-Ratelimit-Reset: 1523227124
X-Runtime-Rack: 0.380620
X-Xss-Protection: 1; mode=block

8000
{"total_count":365,"incomplete_results":false,"items":[{"url":"https://api.github.com/repos/leafo/lapis/issues/611","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/611/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/611/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/611/events","html_url":"https://github.com/leafo/lapis/issues/611","id":309701571,"number":611,"title":"\"fetch \" data after query mysql ","user":{"login":"VuDn5","id":36143595,"avatar_url":"https://avatars1.githubusercontent.com/u/36143595?v=4","gravatar_id":"","url":"https://api.github.com/users/VuDn5","html_url":"https://github.com/VuDn5","followers_url":"https://api.github.com/users/VuDn5/followers","following_url":"https://api.github.com/users/VuDn5/following{/other_user}","gists_url":"https://api.github.com/users/VuDn5/gists{/gist_id}","starred_url":"https://api.github.com/users/VuDn5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/VuDn5/subscriptions","organizations_url":"https://api.github.com/users/VuDn5/orgs","repos_url":"https://api.github.com/users/VuDn5/repos","events_url":"https://api.github.com/users/VuDn5/events{/privacy}","received_events_url":"https://api.github.com/users/VuDn5/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-03-29T10:26:02Z","updated_at":"2018-04-02T03:27:56Z","closed_at":"2018-04-02T03:27:56Z","author_association":"NONE","body":"Dear @leafo ! \r\ni have example:  \r\n` \r\n function testFunction(arg)\r\n        local res\r\n        res = db.query(\"select * FROM subscriber  where username =169693\")\r\n        local ha1 = res.ha1b\r\nreturn to_json(ha1)\r\n`\r\n\r\nbut it return null,  json of variable ** \" res\" ** is:\r\n[{\"username\":\"169693\",\"ha1b\":\"2004e0563f67b646abf038626961b6db\"}]\r\n\r\nMy question is, how can i take a ha1b from res variable? Thank you!   \r\n\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/610","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/610/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/610/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/610/events","html_url":"https://github.com/leafo/lapis/issues/610","id":307871656,"number":610,"title":"Handling request method 'OPTIONS' - best practice (CORS)","user":{"login":"aiibe","id":4663660,"avatar_url":"https://avatars0.githubusercontent.com/u/4663660?v=4","gravatar_id":"","url":"https://api.github.com/users/aiibe","html_url":"https://github.com/aiibe","followers_url":"https://api.github.com/users/aiibe/followers","following_url":"https://api.github.com/users/aiibe/following{/other_user}","gists_url":"https://api.github.com/users/aiibe/gists{/gist_id}","starred_url":"https://api.github.com/users/aiibe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aiibe/subscriptions","organizations_url":"https://api.github.com/users/aiibe/orgs","repos_url":"https://api.github.com/users/aiibe/repos","events_url":"https://api.github.com/users/aiibe/events{/privacy}","received_events_url":"https://api.github.com/users/aiibe/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-03-23T01:41:53Z","updated_at":"2018-04-02T22:58:23Z","closed_at":"2018-04-02T22:58:23Z","author_association":"NONE","body":"This is how my API handles 'POST' requests : \r\n```\r\nclass extends lapis.Application\r\n\t[hello:'/api/hello']: respond_to {\r\n\t\tOPTIONS: =>\r\n\t\t \t@res.headers[\"Access-Control-Allow-Origin\"] = \"*\"\r\n\t\t \t@res.headers[\"Access-Control-Allow-Headers\"] = \"Access-Control-Allow-Origin,Content-Type\"\r\n\r\n\t\tPOST: json_params =>\r\n\t\t\t@res.headers[\"Access-Control-Allow-Origin\"] = \"*\"\r\n\t\t\tjson: { message: 'hello' }\r\n\t}\r\n```\r\nIt works fine, but I wonder if this is a good practice (?)","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/607","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/607/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/607/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/607/events","html_url":"https://github.com/leafo/lapis/issues/607","id":304451245,"number":607,"title":"cqueue support","user":{"login":"CodelessFuture","id":26814295,"avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-03-12T16:44:13Z","updated_at":"2018-03-13T12:27:24Z","closed_at":"2018-03-13T12:27:24Z","author_association":"NONE","body":"Hi,\r\n\r\nI'm interested in queue http-lua support.\r\n\r\nThis let Lapis be compatible be compatible with Lua 5.3? Are you planning to update on Luarocks?","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/605","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/605/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/605/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/605/events","html_url":"https://github.com/leafo/lapis/issues/605","id":301960185,"number":605,"title":"[bug] encode_query_string does not encode ampersands","user":{"login":"Guard13007","id":15093567,"avatar_url":"https://avatars3.githubusercontent.com/u/15093567?v=4","gravatar_id":"","url":"https://api.github.com/users/Guard13007","html_url":"https://github.com/Guard13007","followers_url":"https://api.github.com/users/Guard13007/followers","following_url":"https://api.github.com/users/Guard13007/following{/other_user}","gists_url":"https://api.github.com/users/Guard13007/gists{/gist_id}","starred_url":"https://api.github.com/users/Guard13007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guard13007/subscriptions","organizations_url":"https://api.github.com/users/Guard13007/orgs","repos_url":"https://api.github.com/users/Guard13007/repos","events_url":"https://api.github.com/users/Guard13007/events{/privacy}","received_events_url":"https://api.github.com/users/Guard13007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-03-03T02:33:11Z","updated_at":"2018-03-11T06:40:39Z","closed_at":"2018-03-11T01:36:47Z","author_association":"CONTRIBUTOR","body":"Ampersands should be encoded into `&amp;` within HTML attributes, which is where I assume the output of encode_query_string is intended to be used / most often used.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/602","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/602/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/602/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/602/events","html_url":"https://github.com/leafo/lapis/issues/602","id":293446626,"number":602,"title":"Autoload is failing strangely?","user":{"login":"Guard13007","id":15093567,"avatar_url":"https://avatars3.githubusercontent.com/u/15093567?v=4","gravatar_id":"","url":"https://api.github.com/users/Guard13007","html_url":"https://github.com/Guard13007","followers_url":"https://api.github.com/users/Guard13007/followers","following_url":"https://api.github.com/users/Guard13007/following{/other_user}","gists_url":"https://api.github.com/users/Guard13007/gists{/gist_id}","starred_url":"https://api.github.com/users/Guard13007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guard13007/subscriptions","organizations_url":"https://api.github.com/users/Guard13007/orgs","repos_url":"https://api.github.com/users/Guard13007/repos","events_url":"https://api.github.com/users/Guard13007/events{/privacy}","received_events_url":"https://api.github.com/users/Guard13007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-02-01T08:44:30Z","updated_at":"2018-02-22T20:01:59Z","closed_at":"2018-02-22T20:01:59Z","author_association":"CONTRIBUTOR","body":"I have one file that returns a table of Models, and I have modified the default `models.moon` to use a second argument to `autoload` with a require of said file, and *one* of the two Models defined there is successfully accessible, but the other one disappears entirely.\r\n\r\nI've tried to replicate the issue with a minimal application, but have not had success. I can require the file that returns a table of Models and access them correctly. I can require them individually, and it works correctly. I can verify everything is functioning correctly EXCEPT requiring `models` and accessing ***one*** of the two Models defined in this other file.\r\n\r\nOf course, the whole reason I'm doing things in this convoluted way is because I'm trying to split out some of a site's functionality into a sub-application that defines its own models locally to it, yet have them accessible from elsewhere under the same models path as everything else. Maybe I just shouldn't do it this way.\r\n\r\n(Would you be interested in seeing the minimal version that still works correctly? I figured there wasn't a point in sharing it since it doesn't show anything wrong, but maybe it alludes to a flaw in my thinking?)\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/601","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/601/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/601/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/601/events","html_url":"https://github.com/leafo/lapis/issues/601","id":292506171,"number":601,"title":"Is there a way to modify the URL before it gets matched to a route?","user":{"login":"Guard13007","id":15093567,"avatar_url":"https://avatars3.githubusercontent.com/u/15093567?v=4","gravatar_id":"","url":"https://api.github.com/users/Guard13007","html_url":"https://github.com/Guard13007","followers_url":"https://api.github.com/users/Guard13007/followers","following_url":"https://api.github.com/users/Guard13007/following{/other_user}","gists_url":"https://api.github.com/users/Guard13007/gists{/gist_id}","starred_url":"https://api.github.com/users/Guard13007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guard13007/subscriptions","organizations_url":"https://api.github.com/users/Guard13007/orgs","repos_url":"https://api.github.com/users/Guard13007/repos","events_url":"https://api.github.com/users/Guard13007/events{/privacy}","received_events_url":"https://api.github.com/users/Guard13007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-01-29T18:08:14Z","updated_at":"2018-01-29T18:27:11Z","closed_at":"2018-01-29T18:27:11Z","author_association":"CONTRIBUTOR","body":"I have a splat capturing anything that doesn't match another route, which means I can't use the [default_route](http://leafo.net/lapis/reference/actions.html#application-callbacks/default-action), but I want to use the logic to strip trailing `/`'s.\r\n\r\nI figure the easiest way to fix this would just be to strip these before matching against routes, since I will never be using a trailing slash anyhow. How would I go about accomplishing this?\r\n\r\nAlternately, is there a way I can check if a URL matches against a route elsewhere? I can make my splat check for an existing route after stripping the trailing slash, and redirect, or just go to a 404.\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/600","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/600/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/600/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/600/events","html_url":"https://github.com/leafo/lapis/issues/600","id":290281622,"number":600,"title":"Try and serve page, and if it fails display the error page ?","user":{"login":"Yarillo4","id":23503179,"avatar_url":"https://avatars0.githubusercontent.com/u/23503179?v=4","gravatar_id":"","url":"https://api.github.com/users/Yarillo4","html_url":"https://github.com/Yarillo4","followers_url":"https://api.github.com/users/Yarillo4/followers","following_url":"https://api.github.com/users/Yarillo4/following{/other_user}","gists_url":"https://api.github.com/users/Yarillo4/gists{/gist_id}","starred_url":"https://api.github.com/users/Yarillo4/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yarillo4/subscriptions","organizations_url":"https://api.github.com/users/Yarillo4/orgs","repos_url":"https://api.github.com/users/Yarillo4/repos","events_url":"https://api.github.com/users/Yarillo4/events{/privacy}","received_events_url":"https://api.github.com/users/Yarillo4/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-01-21T15:36:36Z","updated_at":"2018-01-22T22:03:29Z","closed_at":"2018-01-22T22:03:29Z","author_association":"NONE","body":"EDIT: 600th issue ! \\o/\r\n\r\nHello, I have a code snippet for you\r\n\r\nBasically what I do is I have a route for \"/projects/:name\" which serves \"views.projects.\" .. self.params.name\r\n\r\nIf I try to access a view that doesn't exist I'd like to catch that exception and render the \"error\" page.\r\n\r\nUnfortunately I can't use pcall for this as I'm not the one calling the \"render\" function. Lapis does.\r\n\r\nSooo... am I missing something ? How do I do that ?\r\n\r\nBasically i'm only getting the default traceback instead of my error page (or a regular page if I hit a view that exists).\r\n\r\n![img](https://i.imgur.com/xzifgoo.png)\r\n\r\n```LUA\r\nlocal lapis = require \"lapis\"\r\nlocal lfs = require \"lfs\"\r\nlocal app_helpers = require \"lapis.application\"\r\nlocal capture_errors, yield_error = app_helpers.capture_errors, app_helpers.yield_error\r\n\r\nlocal app = lapis.Application()\r\n\r\napp:enable(\"etlua\")\r\napp.layout = require \"views.layout\"\r\n\r\n\r\nlocal function notfound(self)\r\n\tself.pageTitle = \"404\"\r\n\tself.status    =  404\r\n\treturn { \r\n\t\trender = \"error\", --my error page\r\n\t\tstatus = 404\r\n\t} \r\nend\r\n\r\napp:match(\"/*\", notfound)\r\n\r\n---------------------------------------------------------------------------\r\n-- Relevant code                                                         --\r\n-- Exception handling doesn't work properly or I misunderstood something --\r\n-- (probably the latter)                                                 --\r\n---------------------------------------------------------------------------\r\napp:match(\"/projects/:name\", capture_errors(\r\n{\r\n\ton_error = notfound,\r\n\tfunction(self)\r\n\t\tself.pageTitle = self.params.name\r\n\t\treturn { render = \"projects.\" .. self.params.name}\r\n\tend\r\n}\r\n))\r\n\r\nreturn app\r\n```\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/599","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/599/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/599/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/599/events","html_url":"https://github.com/leafo/lapis/issues/599","id":287936271,"number":599,"title":"Lua: Invalid require when using models","user":{"login":"karai17","id":590332,"avatar_url":"https://avatars3.githubusercontent.com/u/590332?v=4","gravatar_id":"","url":"https://api.github.com/users/karai17","html_url":"https://github.com/karai17","followers_url":"https://api.github.com/users/karai17/followers","following_url":"https://api.github.com/users/karai17/following{/other_user}","gists_url":"https://api.github.com/users/karai17/gists{/gist_id}","starred_url":"https://api.github.com/users/karai17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karai17/subscriptions","organizations_url":"https://api.github.com/users/karai17/orgs","repos_url":"https://api.github.com/users/karai17/repos","events_url":"https://api.github.com/users/karai17/events{/privacy}","received_events_url":"https://api.github.com/users/karai17/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-01-11T21:50:54Z","updated_at":"2018-01-17T20:34:36Z","closed_at":"2018-01-17T20:34:36Z","author_association":"NONE","body":"https://github.com/leafo/lapis/blob/master/lapis/db/base_model.lua#L218\r\n\r\n```\r\nError\r\n/usr/share/lua/5.1/lapis/db/base_model.lua:218: module 'models' not found:\r\n\tno field package.preload['models']\r\n\tno file '/root/.luarocks/share/lua/5.1/models.lua'\r\n\tno file '/root/.luarocks/share/lua/5.1/models/init.lua'\r\n\tno file '/usr/share/lua/5.1/models.lua'\r\n\tno file '/usr/share/lua/5.1/models/init.lua'\r\n\tno file './models.lua'\r\n\tno file '/usr/share/luajit-2.0.4/models.lua'\r\n\tno file '/usr/local/share/lua/5.1/models.lua'\r\n\tno file '/usr/local/share/lua/5.1/models/init.lua'\r\n\tno file '/usr/local/openresty/lualib/models.lua'\r\n\tno file './src/models.lua'\r\n\tno file './src/models/init.lua'\r\n\tno file '/root/.luarocks/lib/lua/5.1/models.so'\r\n\tno file '/usr/lib/lua/5.1/models.so'\r\n\tno file './models.so'\r\n\tno file '/usr/local/lib/lua/5.1/models.so'\r\n\tno file '/usr/lib64/lua/5.1/models.so'\r\n\tno file '/usr/local/lib/lua/5.1/loadall.so'\r\nTraceback\r\nstack traceback:\r\n\t[C]: in function 'require'\r\n\t/usr/share/lua/5.1/lapis/db/base_model.lua:218: in function 'get_relation_model'\r\n\t/usr/share/lua/5.1/lapis/db/model/relations.lua:9: in function 'assert_model'\r\n\t/usr/share/lua/5.1/lapis/db/model/relations.lua:384: in function 'get_players'\r\n\t./src/controllers/players.lua:28: in function 'handler'\r\n\t/usr/share/lua/5.1/lapis/application.lua:130: in function 'resolve'\r\n\t/usr/share/lua/5.1/lapis/application.lua:161: in function </usr/share/lua/5.1/lapis/application.lua:159>\r\n\t[C]: in function 'xpcall'\r\n\t/usr/share/lua/5.1/lapis/application.lua:159: in function 'dispatch'\r\n\t/usr/share/lua/5.1/lapis/nginx.lua:215: in function 'serve'\r\n\tcontent_by_lua(nginx.conf.compiled:28):1: in function <content_by_lua(nginx.conf.compiled:28):1>\r\n```\r\n\r\n```lua\r\n-- Users model\r\nlocal db    = require(\"lapis.db\")\r\nlocal Model = require(\"lapis.db.model\").Model\r\nlocal Users = Model:extend(\"users\", {\r\n\trelations = {\r\n\t\t{ \"players\", has_many = \"Players\" }\r\n\t}\r\n})\r\n\r\n--- Get data from an existing User\r\n-- @tparam string username Username of User\r\n-- @treturn table User object\r\nfunction Users:select_user(username)\r\n\treturn self:find {\r\n\t\tusername = username\r\n\t}\r\nend\r\n\r\n-- Some controller\r\nlocal user = Users:select_user(request.username)\r\nif not user then\r\n\treturn {\r\n\t\tstatus = http_code.BAD_REQUEST,\r\n\t\tjson   = {}\r\n\t}\r\nend\r\n\r\nlocal players = user:get_players() -- this line causes the crash\r\nif not players then\r\n\treturn {\r\n\t\tstatus = http_code.BAD_REQUEST,\r\n\t\tjson   = {}\r\n\t}\r\nend\r\n```","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/598","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/598/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/598/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/598/events","html_url":"https://github.com/leafo/lapis/issues/598","id":286352365,"number":598,"title":"Parameter parser can crash","user":{"login":"bungle","id":983257,"avatar_url":"https://avatars0.githubusercontent.com/u/983257?v=4","gravatar_id":"","url":"https://api.github.com/users/bungle","html_url":"https://github.com/bungle","followers_url":"https://api.github.com/users/bungle/followers","following_url":"https://api.github.com/users/bungle/following{/other_user}","gists_url":"https://api.github.com/users/bungle/gists{/gist_id}","starred_url":"https://api.github.com/users/bungle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bungle/subscriptions","organizations_url":"https://api.github.com/users/bungle/orgs","repos_url":"https://api.github.com/users/bungle/repos","events_url":"https://api.github.com/users/bungle/events{/privacy}","received_events_url":"https://api.github.com/users/bungle/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-01-05T17:24:46Z","updated_at":"2018-02-01T21:42:34Z","closed_at":"2018-02-01T21:42:34Z","author_association":"NONE","body":"One problem is here:\r\nhttps://github.com/bungle/lapis/blob/master/lapis/request.lua#L303\r\n\r\nIt is not guaranteed that the `curr`is a table. Also here is small example:\r\nhttps://itch.io/?p[0]=4","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/595","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/595/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/595/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/595/events","html_url":"https://github.com/leafo/lapis/issues/595","id":284521736,"number":595,"title":"No library CRYPTO","user":{"login":"Pancakeddd","id":23126782,"avatar_url":"https://avatars2.githubusercontent.com/u/23126782?v=4","gravatar_id":"","url":"https://api.github.com/users/Pancakeddd","html_url":"https://github.com/Pancakeddd","followers_url":"https://api.github.com/users/Pancakeddd/followers","following_url":"https://api.github.com/users/Pancakeddd/following{/other_user}","gists_url":"https://api.github.com/users/Pancakeddd/gists{/gist_id}","starred_url":"https://api.github.com/users/Pancakeddd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Pancakeddd/subscriptions","organizations_url":"https://api.github.com/users/Pancakeddd/orgs","repos_url":"https://api.github.com/users/Pancakeddd/repos","events_url":"https://api.github.com/users/Pancakeddd/events{/privacy}","received_events_url":"https://api.github.com/users/Pancakeddd/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-26T09:07:08Z","updated_at":"2018-01-05T20:29:16Z","closed_at":"2018-01-05T20:29:16Z","author_association":"NONE","body":"`nathanmoosh@nathanmoosh-GL702VSK:~$ luarocks install lapis\r\nInstalling https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/lapis-1.6.0-1.src.rock...\r\nUsing https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/lapis-1.6.0-1.src.rock... switching to 'build' mode\r\n\r\nMissing dependencies for lapis:\r\nluaossl \r\nloadkit \r\nmimetypes \r\nansicolors \r\ndate \r\npgmoon \r\netlua \r\n\r\nUsing https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/luaossl-20171028-0.src.rock... switching to 'build' mode\r\n\r\nError: Failed installing dependency: https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/luaossl-20171028-0.src.rock - Could not find library file for CRYPTO\r\n  No file libcrypto.a in /usr/lib\r\n  No file libcrypto.so in /usr/lib\r\n  No file matching libcrypto.so.* in /usr/lib\r\nYou may have to install CRYPTO in your system and/or pass CRYPTO_DIR or CRYPTO_LIBDIR to the luarocks command.\r\nExample: luarocks install luaossl CRYPTO_DIR=/usr/local\r\n`\r\n\r\nPlease help!","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/594","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/594/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/594/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/594/events","html_url":"https://github.com/leafo/lapis/issues/594","id":283808874,"number":594,"title":"writing a test for file uploads","user":{"login":"Kukuzapa","id":34736639,"avatar_url":"https://avatars0.githubusercontent.com/u/34736639?v=4","gravatar_id":"","url":"https://api.github.com/users/Kukuzapa","html_url":"https://github.com/Kukuzapa","followers_url":"https://api.github.com/users/Kukuzapa/followers","following_url":"https://api.github.com/users/Kukuzapa/following{/other_user}","gists_url":"https://api.github.com/users/Kukuzapa/gists{/gist_id}","starred_url":"https://api.github.com/users/Kukuzapa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kukuzapa/subscriptions","organizations_url":"https://api.github.com/users/Kukuzapa/orgs","repos_url":"https://api.github.com/users/Kukuzapa/repos","events_url":"https://api.github.com/users/Kukuzapa/events{/privacy}","received_events_url":"https://api.github.com/users/Kukuzapa/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-21T08:38:05Z","updated_at":"2018-02-22T20:02:54Z","closed_at":"2018-02-22T20:02:54Z","author_association":"NONE","body":"How do I test my upload script for uploading files? I can not pass the upload table using request (url, options) since options.post does not support nested tables.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/593","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/593/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/593/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/593/events","html_url":"https://github.com/leafo/lapis/issues/593","id":283133829,"number":593,"title":"Is it possible to obtain status code in a view?","user":{"login":"tpimh","id":1071872,"avatar_url":"https://avatars3.githubusercontent.com/u/1071872?v=4","gravatar_id":"","url":"https://api.github.com/users/tpimh","html_url":"https://github.com/tpimh","followers_url":"https://api.github.com/users/tpimh/followers","following_url":"https://api.github.com/users/tpimh/following{/other_user}","gists_url":"https://api.github.com/users/tpimh/gists{/gist_id}","starred_url":"https://api.github.com/users/tpimh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tpimh/subscriptions","organizations_url":"https://api.github.com/users/tpimh/orgs","repos_url":"https://api.github.com/users/tpimh/repos","events_url":"https://api.github.com/users/tpimh/events{/privacy}","received_events_url":"https://api.github.com/users/tpimh/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-19T07:54:00Z","updated_at":"2018-02-22T20:06:37Z","closed_at":"2018-02-22T20:06:37Z","author_association":"NONE","body":"I was trying to print it as `<%= ngx.status %>` and `<%= ngx.var.status %>`, but it didn't work. The only way I get it to work is saving status code before setting it to a variable and then printing it's value. Is there a better way?","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/591","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/591/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/591/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/591/events","html_url":"https://github.com/leafo/lapis/issues/591","id":281998698,"number":591,"title":"How to change the types.varchar length?","user":{"login":"uudiin","id":4622009,"avatar_url":"https://avatars0.githubusercontent.com/u/4622009?v=4","gravatar_id":"","url":"https://api.github.com/users/uudiin","html_url":"https://github.com/uudiin","followers_url":"https://api.github.com/users/uudiin/followers","following_url":"https://api.github.com/users/uudiin/following{/other_user}","gists_url":"https://api.github.com/users/uudiin/gists{/gist_id}","starred_url":"https://api.github.com/users/uudiin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uudiin/subscriptions","organizations_url":"https://api.github.com/users/uudiin/orgs","repos_url":"https://api.github.com/users/uudiin/repos","events_url":"https://api.github.com/users/uudiin/events{/privacy}","received_events_url":"https://api.github.com/users/uudiin/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-14T06:51:01Z","updated_at":"2017-12-15T03:39:57Z","closed_at":"2017-12-15T03:39:57Z","author_association":"NONE","body":"I use the varchar with length 4096, alse as a primary key\r\n\r\n`types.varchar(4096, { primary_key = true })`\r\n\r\nA runtime error occured. How to fix it?\r\nThanks.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/590","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/590/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/590/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/590/events","html_url":"https://github.com/leafo/lapis/issues/590","id":281965944,"number":590,"title":"How can I insert multi value to postgresql at a time?","user":{"login":"uudiin","id":4622009,"avatar_url":"https://avatars0.githubusercontent.com/u/4622009?v=4","gravatar_id":"","url":"https://api.github.com/users/uudiin","html_url":"https://github.com/uudiin","followers_url":"https://api.github.com/users/uudiin/followers","following_url":"https://api.github.com/users/uudiin/following{/other_user}","gists_url":"https://api.github.com/users/uudiin/gists{/gist_id}","starred_url":"https://api.github.com/users/uudiin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uudiin/subscriptions","organizations_url":"https://api.github.com/users/uudiin/orgs","repos_url":"https://api.github.com/users/uudiin/repos","events_url":"https://api.github.com/users/uudiin/events{/privacy}","received_events_url":"https://api.github.com/users/uudiin/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-14T02:57:32Z","updated_at":"2017-12-15T03:37:40Z","closed_at":"2017-12-15T03:37:40Z","author_association":"NONE","body":"Cound I insert multi value to db at a time? \r\n\r\n`INSERT INTO \"my_table\" (\"age\", \"name\") VALUES (10, 'Hello World'), (22, 'Hello')`\r\n\r\nIs lapis supported?\r\nThanks a lot","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/589","repository_url":"https://api.gi
8000
thub.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/589/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/589/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/589/events","html_url":"https://github.com/leafo/lapis/issues/589","id":280672401,"number":589,"title":"Session signing  HMAC SHA1","user":{"login":"karai17","id":590332,"avatar_url":"https://avatars3.githubusercontent.com/u/590332?v=4","gravatar_id":"","url":"https://api.github.com/users/karai17","html_url":"https://github.com/karai17","followers_url":"https://api.github.com/users/karai17/followers","following_url":"https://api.github.com/users/karai17/following{/other_user}","gists_url":"https://api.github.com/users/karai17/gists{/gist_id}","starred_url":"https://api.github.com/users/karai17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karai17/subscriptions","organizations_url":"https://api.github.com/users/karai17/orgs","repos_url":"https://api.github.com/users/karai17/repos","events_url":"https://api.github.com/users/karai17/events{/privacy}","received_events_url":"https://api.github.com/users/karai17/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2017-12-09T03:30:47Z","updated_at":"2018-04-07T22:04:28Z","closed_at":"2018-02-26T05:34:37Z","author_association":"NONE","body":"With Google's recentish proof of concept in breaking SHA1, it might be wise to change the encryption algorithm used for sessions.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/588","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/588/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/588/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/588/events","html_url":"https://github.com/leafo/lapis/issues/588","id":280083620,"number":588,"title":"how to capture database error","user":{"login":"zhouniandi","id":4343167,"avatar_url":"https://avatars0.githubusercontent.com/u/4343167?v=4","gravatar_id":"","url":"https://api.github.com/users/zhouniandi","html_url":"https://github.com/zhouniandi","followers_url":"https://api.github.com/users/zhouniandi/followers","following_url":"https://api.github.com/users/zhouniandi/following{/other_user}","gists_url":"https://api.github.com/users/zhouniandi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhouniandi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhouniandi/subscriptions","organizations_url":"https://api.github.com/users/zhouniandi/orgs","repos_url":"https://api.github.com/users/zhouniandi/repos","events_url":"https://api.github.com/users/zhouniandi/events{/privacy}","received_events_url":"https://api.github.com/users/zhouniandi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-07T10:49:41Z","updated_at":"2017-12-15T08:03:47Z","closed_at":"2017-12-15T08:03:47Z","author_association":"NONE","body":"Hi.\r\nI need to capture database error message  render to json , but the postgres.lua _query funcation always render to the error.lua view.\r\n\r\npostgres.lua\r\n```\r\n94      if not res and err then\r\n95          error(tostring(str) .. \"\\n\" .. tostring(err))\r\n96      end\r\n```","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/586","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/586/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/586/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/586/events","html_url":"https://github.com/leafo/lapis/issues/586","id":279052417,"number":586,"title":"failed to find model `model` for relation","user":{"login":"CodelessFuture","id":26814295,"avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2017-12-04T16:11:21Z","updated_at":"2018-04-06T20:09:49Z","closed_at":"2017-12-05T07:27:02Z","author_association":"NONE","body":"failed to find model `Golfclubs` for relation\r\n\r\nThis is my models.lua:\r\n```lua\r\nlocal autoload = require(\"lapis.util\").autoload\r\nreturn autoload(\"models\")\r\n```\r\n\r\nThis are the relations:\r\n```lua\r\nlocal Model = require(\"lapis.db.model\").Model\r\nlocal Golfclubs = Model:extend(\"golfclubs\", {\r\n  relations = {\r\n    {\"coupons\", has_many = \"Coupons\"}\r\n  }\r\n})\r\nlocal Coupons = Model:extend(\"coupons\", {\r\n  relations = {\r\n    {\"golfclub\", belongs_to = \"Golfclubs\"}\r\n  }\r\n})\r\n```\r\n\r\nThis are the migrations:\r\n```lua\r\n    schema.create_table(\"golfclubs\", {\r\n      { \"id\", types.serial },\r\n      { \"name\", types.text },\r\n      { \"logo\", types.text({ null = true }) },\r\n      { \"description\", types.text },\r\n      { \"image\", types.text({ null = true }) },\r\n      { \"address\", types.text },\r\n      { \"latitude\", types.text({ null = true }) },\r\n      { \"longitude\", types.text({ null = true }) },\r\n      { \"phone\", types.text({ null = true }) },\r\n      { \"email\", types.text({ null = true }) },\r\n\r\n      \"PRIMARY KEY (id)\"\r\n    })\r\n\r\n    schema.create_table(\"coupons\", {\r\n      { \"id\", types.serial },\r\n      { \"name\", types.text },\r\n      { \"description\", types.text },\r\n      { \"condition\", types.text },\r\n      { \"quantity\", types.integer({ default = 1}) },\r\n      { \"golfclub_id\", types.foreign_key },\r\n\r\n      \"PRIMARY KEY (id)\"\r\n    })\r\n```\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/585","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/585/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/585/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/585/events","html_url":"https://github.com/leafo/lapis/issues/585","id":278670354,"number":585,"title":"File uploads validation","user":{"login":"CodelessFuture","id":26814295,"avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-12-02T09:33:27Z","updated_at":"2018-03-02T12:50:28Z","closed_at":"2018-03-02T12:50:28Z","author_association":"NONE","body":"Hi.\r\n\r\nI need to validate if the field is a file upload but only if present (it is not a required field)\r\n\r\nI'm using  \r\n```lua\r\nvalidate.assert_valid(self.params, {\r\n   ...\r\n   { \"logo\", is_file = true },\r\n   ....\r\n})\r\n```\r\n\r\nBut so it is required always giving a \"Missing file\" error\r\n\r\nAlso what's the difference with _file_exists = true_ ?\r\n\r\nAlso I need an optional validation for other field, so the file can be present or not, but if present can have only min 8 max 10 char......and so on.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/584","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/584/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/584/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/584/events","html_url":"https://github.com/leafo/lapis/issues/584","id":278537856,"number":584,"title":"Input Validation","user":{"login":"CodelessFuture","id":26814295,"avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-01T17:25:00Z","updated_at":"2017-12-01T18:32:20Z","closed_at":"2017-12-01T18:32:20Z","author_association":"NONE","body":"I read at http://leafo.net/lapis/reference/input_validation.html#validation-functions\r\n\r\nSorry I don't understand in which variable goes the errors and so how to show them","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/583","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/583/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/583/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/583/events","html_url":"https://github.com/leafo/lapis/issues/583","id":278410673,"number":583,"title":"Many to Many Relations and pivot table.","user":{"login":"CodelessFuture","id":26814295,"avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-01T09:46:47Z","updated_at":"2017-12-01T17:22:45Z","closed_at":"2017-12-01T17:22:45Z","author_association":"NONE","body":"Reading the docs I don't find anything about many to many relationship so I think is not implemented yet.\r\n\r\nI think I have to create the tables with migrations and models for working on the records then build the query manually, right?","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/582","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/582/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/582/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/582/events","html_url":"https://github.com/leafo/lapis/issues/582","id":278409055,"number":582,"title":"Api and Web route","user":{"login":"CodelessFuture","id":26814295,"avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2017-12-01T09:40:31Z","updated_at":"2017-12-02T09:28:12Z","closed_at":"2017-12-02T09:28:12Z","author_association":"NONE","body":"I have 2 distinct route in my web app. The first is a web backend for admin and CRUD operation, the second is the API talking with a Mobile app.\r\n\r\nThe first need session, cookies and views, the second jwt token and son response.\r\n\r\nActually I made this in Nginx.conf and it works (but I'm open to suggestion and better practices):\r\n\r\n```\r\n....\r\nserver {\r\n    listen ${{PORT}};\r\n    lua_code_cache ${{CODE_CACHE}};\r\n\r\n    location / {\r\n      default_type text/html;\r\n      content_by_lua '\r\n        require(\"lapis\").serve(\"app\")\r\n      ';\r\n    }\r\n\t\r\n\tlocation /api {\r\n      default_type text/html;\r\n      content_by_lua '\r\n        require(\"lapis\").serve(\"api\")\r\n      ';\r\n    }\r\n....\r\n```\r\n\r\nSo I have an app.lua and an api.lua and works well, but I have to put /api in all route: there's a method to have automatically /api appended to the route in api.lua?\r\n\r\n```lua\r\n-- now:\r\napi:post(\"/api/seed\" , function()\r\n........\r\n\r\n-- then:\r\napi:post(\"/seed\" , function()\r\n\r\nbut always pointing to: /api/lua\r\n```","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/581","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/581/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/581/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/581/events","html_url":"https://github.com/leafo/lapis/issues/581","id":278277927,"number":581,"title":"Lapis test: Don't know if this is correct and how to test in this case","user":{"login":"CodelessFuture","id":26814295,"avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/CodelessFuture","html_url":"https://github.com/CodelessFuture","followers_url":"https://api.github.com/users/CodelessFuture/followers","following_url":"https://api.github.com/users/CodelessFuture/following{/other_user}","gists_url":"https://api.github.com/users/CodelessFuture/gists{/gist_id}","starred_url":"https://api.github.com/users/CodelessFuture/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodelessFuture/subscriptions","organizations_url":"https://api.github.com/users/CodelessFuture/orgs","repos_url":"https://api.github.com/users/CodelessFuture/repos","events_url":"https://api.github.com/users/CodelessFuture/events{/privacy}","received_events_url":"https://api.github.com/users/CodelessFuture/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-11-30T21:35:47Z","updated_at":"2017-12-01T17:20:21Z","closed_at":"2017-11-30T21:56:00Z","author_association":"NONE","body":"Lapis test:\r\n--- \r\nThe function has three return values: the status code as a number, the body of the response and any response headers in a table.\r\n---\r\nBut if I have a redirect (eg. after a valid login) the body is empy......so I cannot match on a text on the redirected page","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/580","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/580/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/580/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/580/events","html_url":"https://github.com/leafo/lapis/issues/580","id":277825912,"number":580,"title":"Detach lapis models from lapis?","user":{"login":"italomaia","id":14670,"avatar_url":"https://avatars1.githubusercontent.com/u/14670?v=4","gravatar_id":"","url":"https://api.github.com/users/italomaia","html_url":"https://github.com/italomaia","followers_url":"https://api.github.com/users/italomaia/followers","following_url":"https://api.github.com/users/italomaia/following{/other_user}","gists_url":"https://api.github.com/users/italomaia/gists{/gist_id}","starred_url":"https://api.github.com/users/italomaia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/italomaia/subscriptions","organizations_url":"https://api.github.com/users/italomaia/orgs","repos_url":"https://api.github.com/users/italomaia/repos","events_url":"https://api.github.com/users/italomaia/events{/privacy}","received_events_url":"https://api.github.com/users/italomaia/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2017-11-29T16:45:11Z","updated_at":"2018-02-25T14:10:59Z","closed_at":"2017-12-08T22:45:17Z","author_association":"NONE","body":"Would it be reasonable to have Lapis ORM as a package independent from lapis? As there are few ORMs for Lua, maybe that would be helpful. ","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/578","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/578/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/578/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/578/events","html_url":"https://github.com/leafo/lapis/issues/578","id":266651147,"number":578,"title":"MySQL migration requires ngx","user":{"login":"tpimh","id":1071872,"avatar_url":"https://avatars3.githubusercontent.com/u/1071872?v=4","gravatar_id":"","url":"https://api.github.com/users/tpimh","html_url":"https://github.com/tpimh","followers_url":"https://api.github.com/users/tpimh/followers","following_url":"https://api.github.com/users/tpimh/following{/other_user}","gists_url":"https://api.github.com/users/tpimh/gists{/gist_id}","starred_url":"https://api.github.com/users/tpimh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tpimh/subscriptions","organizations_url":"https://api.github.com/users/tpimh/orgs","repos_url":"https://api.github.com/users/tpimh/repos","events_url":"https://api.github.com/users/tpimh/events{/privacy}","received_events_url":"https://api.github.com/users/tpimh/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-10-18T21:39:57Z","updated_at":"2017-10-20T21:43:47Z","closed_at":"2017-10-20T21:43:47Z","author_association":"NONE","body":"Running `lapis migrate --trace`:\r\n\r\n    /usr/local/openresty/luajit/bin/luajit: /usr/local/openresty/luajit/share/lua/5.1/resty/mysql.lua:5: attempt to index global 'ngx' (a nil value)\r\n    stack traceback:\r\n\t    /usr/local/openresty/luajit/share/lua/5.1/resty/mysql.lua:5: in main chunk\r\n\t    [C]: in function 'require'\r\n\t    .../local/openresty/luajit/share/lua/5.1/lapis/db/mysql.lua:101: in function 'backend'\r\n\t    .../local/openresty/luajit/share/lua/5.1/lapis/db/mysql.lua:164: in function 'connect'\r\n\t    .../local/openresty/luajit/share/lua/5.1/lapis/db/mysql.lua:183: in function 'escape_literal'\r\n\t    ...openresty/luajit/share/lua/5.1/lapis/db/mysql/schema.lua:48: in function 'entity_exists'\r\n\t    ...l/openresty/luajit/share/lua/5.1/lapis/db/migrations.lua:73: in function 'run_migrations'\r\n\t    ...cal/openresty/luajit/share/lua/5.1/lapis/cmd/actions.lua:282: in function 'execute'\r\n\t    /usr/local/openresty/luajit/bin/lapis:4: in main chunk\r\n\t    [C]: at 0x5610cbc85360\r\n\r\nMy `config.lua`:\r\n\r\n    config = require \"lapis.config\"\r\n\r\n    config(\"development\", {\r\n      port = 8080,\r\n      mysql = {\r\n        backend = \"resty_mysql\",\r\n        path = \"/var/run/mysqld/mysqld.sock\",\r\n        database = \"test\",\r\n        user = \"test\",\r\n        password = \"test\"\r\n      },\r\n      redis = {\r\n        path = \"/var/run/redis/redis.sock\"\r\n      }\r\n    })\r\n\r\nMy `migrations.lua`:\r\n\r\n    local schema = require(\"lapis.db.schema\")\r\n    local types = schema.types\r\n\r\n    return {\r\n      [1] = function()\r\n        schema.create_table(\"things\", {\r\n          { \"id\", types.id },\r\n          { \"name\", types.varchar }\r\n        })\r\n        schema.create_table(\"users\", {\r\n          { \"id\", types.id },\r\n          { \"username\", types.varchar },\r\n          { \"password\", types.varchar }\r\n        })\r\n      end\r\n    }\r\n\r\nAm I doing something wrong?","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/576","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/576/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/576/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/576/events","html_url":"https://github.com/leafo/lapis/issues/576","id":266393993,"number":576,"title":"I install lapis failed  when use `luarocks install lapis`.","user":{"login":"wuyachao","id":12593664,"avatar_url":"https://avatars1.githubusercontent.com/u/12593664?v=4","gravatar_id":"","url":"https://api.github.com/users/wuyachao","html_url":"https://github.com/wuyachao","followers_url":"https://api.github.com/users/wuyachao/followers","following_url":"https://api.github.com/users/wuyachao/following{/other_user}","gists_url":"https://api.github.com/users/wuyachao/gists{/gist_id}","starred_url":"https://api.github.com/users/wuyachao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuyachao/subscriptions","organizations_url":"https://api.github.com/users/wuyachao/orgs","repos_url":"https://api.github.com/users/wuyachao/repos","events_url":"https://api.github.com/users/wuyachao/events{/privacy}","received_events_url":"https://api.github.com/users/wuyachao/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-10-18T07:56:25Z","updated_at":"2017-10-18T16:42:43Z","closed_at":"2017-10-18T16:42:43Z","author_association":"NONE","body":"\r\n```\r\n# luarocks install lapis\r\nInstalling https://luarocks.org/lapis-1.6.0-1.src.rock\r\nMissing dependencies for lapis 1.6.0-1:\r\n   lua-cjson (not installed)\r\n   luaossl (not installed)\r\n\r\n\r\nlapis 1.6.0-1 depends on lua-cjson (not installed)\r\nInstalling https://luarocks.org/lua-cjson-2.1.0-1.src.rock\r\nenv MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/opt/openresty/luajit/include/luajit-2.1 -c lua_cjson.c -o lua_cjson.o\r\nlua_cjson.c:1298:13: error: static declaration of 'luaL_setfuncs' follows non-static declaration\r\nstatic void luaL_setfuncs (lua_State *l, const luaL_Reg *reg, int nup)\r\n            ^\r\n/usr/local/opt/openresty/luajit/include/luajit-2.1/lauxlib.h:88:18: note: previous declaration is here\r\nLUALIB_API void (luaL_setfuncs) (lua_State *L, const luaL_Reg *l, int nup);\r\n                 ^\r\n1 error generated.\r\n\r\nError: Failed installing dependency: https://luarocks.org/lua-cjson-2.1.0-1.src.rock - Build error: Failed compiling object lua_cjson.o\r\n```\r\n+ nginx version: openresty/1.11.2.4\r\n\r\n+ I have installed openresty an kong.  I can install it some month ago.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/574","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/574/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/574/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/574/events","html_url":"https://github.com/leafo/lapis/issues/574","id":260148022,"number":574,"title":"How to handle errors across all routes?","user":{"login":"kraftman","id":482309,"avatar_url":"https://avatars0.githubusercontent.com/u/482309?v=4","gravatar_id":"","url":"https://api.github.com/users/kraftman","html_url":"https://github.com/kraftman","followers_url":"https://api.github.com/users/kraftman/followers","following_url":"https://api.github.com/users/kraftman/following{/other_user}","gists_url":"https://api.github.com/users/kraftman/gists{/gist_id}","starred_url":"https://api.github.com/users/kraftman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kraftman/subscriptions","organizations_url":"https://api.github.com/users/kraftman/orgs","repos_url":"https://api.github.com/users/kraftman/repos","events_url":"https://api.github.com/users/kraftman/events{/privacy}","received_events_url":"https://api.github.com/users/kraftman/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-09-25T03:52:10Z","updated_at":"2018-02-22T20:05:11Z","closed_at":"2018-02-22T20:04:47Z","author_association":"NONE","body":"I'm currently converting my app to use the built in exception handling, but since capture_errors returns {render = true} by default, I either need to make sure I have a view for every route (which I don't always have, and each one would need its own code to handle errors), or I need to add a custom error handler to every capture_requests call.\r\n\r\nIs there a clever way of just using a single error handler for any and all errors that happen? I tried catching errors in my layout, but that only works if the template exists.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/572","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/572/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/572/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/572/events","html_url":"https://github.com/leafo/lapis/issues/572","id":260048883,"number":572,"title":"Documentation for database types not up to date?","user":{"login":"Guard13007","id":15093567,"avatar_url":"https://avatars3.githubusercontent.com/u/15093567?v=4","gravatar_id":"","url":"https://api.github.com/users/Guard13007","html_url":"https://github.com/Guard13007","followers_url":"https://api.github.com/users/Guard13007/followers","following_url":"https://api.github.com/users/Guard13007/following{/other_user}","gists_url":"https://api.github.com/users/Guard13007/gists{/gist_id}","starred_url":"https://api.github.com/users/Guard13007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Guard13007/subscriptions","organizations_url":"https://api.github.com/users/Guard13007/orgs","repos_url":"https://api.github.com/users/Guard13007/repos","events_url":"https://api.github.com/users/Guard13007/events{/privacy}","received_events_url":"https://api.github.com/users/Guard13007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-09-24T00:58:50Z","updated_at":"2018-03-02T17:50:13Z","closed_at":"2018-03-02T17:50:05Z","author_association":"CONTRIBUTOR","body":"[Migrating for a New Polymorphic Relation](http://leafo.net/lapis/reference/models.html#relations/polymorphic-belongs-to/migrating-for-a-new-polymorphic-relation) has an example using `types.enum` as a column type in migrations, but [Column Types](http://leafo.net/lapis/reference/database.html#database-schemas/column-types) does not show an `enum` type.\r\n","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/570","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/570/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/570/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/570/events","html_url":"https://github.com/leafo/lapis/issues/570","id":258349148,"number":570,"title":"Best way to do ratelimit","user":{"login":"kraftman","id":482309,"avatar_url":"https://avatars0.githubusercontent.com/u/482309?v=4","gravatar_id":"","url":"https://api.github.com/users/kraftman","html_url":"https://github.com/kraftman","followers_url":"https://api.github.com/users/kraftman/followers","following_url":"https://api.github.com/users/kraftman/following{/other_user}","gists_url":"https://api.github.com/users/kraftman/gists{/gist_id}","starred_url":"https://api.github.com/users/kraftman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kraftman/subscriptions","organizations_url":"https://api.github.com/users/kraftman/orgs","repos_url":"https://api.github.com/users/kraftman/repos","events_url":"https://api.github.com/users/kraftman/events{/privacy}","received_events_url":"https://api.github.com/users/kraftman/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-09-18T00:55:10Z","updated_at":"2017-09-18T23:39:53Z","closed_at":"2017-09-18T23:36:16Z","author_association":"NONE","body":"Hey, I'm looking at adding some basic per user/endpoint rate limiting to my application, using the session  cookie to identify each client. What's the best way to do this? Can I load up the app and run some checks in access_by_lua?","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/569","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/569/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/569/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/569/events","html_url":"https://github.com/leafo/lapis/issues/569","id":256571354,"number":569,"title":"Can I use multi database in one website?","user":{"login":"uudiin","id":4622009,"avatar_url":"https://avatars0.githubusercontent.com/u/4622009?v=4","gravatar_id":"","url":"https://api.github.com/users/uudiin","html_url":"https://github.com/uudiin","followers_url":"https://api.github.com/users/uudiin/followers","following_url":"https://api.github.com/users/uudiin/following{/other_user}","gists_url":"https://api.github.com/users/uudiin/gists{/gist_id}","starred_url":"https://api.github.com/users/uudiin/starred{/owner}{/repo}","subscriptions_u
bb8
rl":"https://api.github.com/users/uudiin/subscriptions","organizations_url":"https://api.github.com/users/uudiin/orgs","repos_url":"https://api.github.com/users/uudiin/repos","events_url":"https://api.github.com/users/uudiin/events{/privacy}","received_events_url":"https://api.github.com/users/uudiin/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-09-11T03:20:36Z","updated_at":"2017-09-12T03:16:21Z","closed_at":"2017-09-12T03:16:21Z","author_association":"NONE","body":"My website's data is stored in multi database, How to config it in config.lua?\r\nThanks.","score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/567","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/567/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/567/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/567/events","html_url":"https://github.com/leafo/lapis/issues/567","id":250802996,"number":567,"title":"column \"id\" does not exist on Model:create","user":{"login":"VaiN474","id":4453426,"avatar_url":"https://avatars3.githubusercontent.com/u/4453426?v=4","gravatar_id":"","url":"https://api.github.com/users/VaiN474","html_url":"https://github.com/VaiN474","followers_url":"https://api.github.com/users/VaiN474/followers","following_url":"https://api.github.com/users/VaiN474/following{/other_user}","gists_url":"https://api.github.com/users/VaiN474/gists{/gist_id}","starred_url":"https://api.github.com/users/VaiN474/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/VaiN474/subscriptions","organizations_url":"https://api.github.com/users/VaiN474/orgs","repos_url":"https://api.github.com/users/VaiN474/repos","events_url":"https://api.github.com/users/VaiN474/events{/privacy}","received_events_url":"https://api.github.com/users/VaiN474/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-08-17T01:12:25Z","updated_at":"2017-08-17T01:24:32Z","closed_at":"2017-08-17T01:24:32Z","author_association":"NONE","body":"I have a postgres database table that does not have an \"id\" column. When trying to use Model:create, I get the following error:\r\n\r\n```\r\n...postgres.lua:82: INSERT INTO ... RETURNING \"id\"\r\nERROR: column \"id\" does not exist (155)\r\n```\r\n\r\nI have a different column that is unique, and the primary key, that I would like to return instead. The documentation suggests that Model:create returns the primary keys on creation, but it only seems to look for \"id\". Docs also suggest that you can use a second table to specify the columns to return, but there's no example usage, and I wasn't able to figure it out.\r\n\r\nAny advice would be appreciated.\r\n","score":1.0}]}
0

