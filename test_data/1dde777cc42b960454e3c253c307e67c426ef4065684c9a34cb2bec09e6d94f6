HTTP/1.1 200 OK
Transfer-Encoding: chunked
Access-Control-Allow-Origin: *
Access-Control-Expose-Headers: ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset
Cache-Control: no-cache
Content-Security-Policy: default-src 'none'
Content-Type: application/json; charset=utf-8
Date: Sat, 14 Nov 2020 18:08:50 GMT
Link: <https://api.github.com/search/issues?q=https%3A%2F%2Fgithub.com%2Fleafo%2Flapis+type%3Aissue+state%3Aclosed&page=2>; rel="next", <https://api.github.com/search/issues?q=https%3A%2F%2Fgithub.com%2Fleafo%2Flapis+type%3Aissue+state%3Aclosed&page=4>; rel="last"
Referrer-Policy: origin-when-cross-origin, strict-origin-when-cross-origin
Server: GitHub.com
Status: 200 OK
Strict-Transport-Security: max-age=31536000; includeSubdomains; preload
Vary: Accept, Authorization, Cookie, X-GitHub-OTP
Vary: Accept-Encoding, Accept, X-Requested-With
Vary: Accept-Encoding
X-Accepted-Oauth-Scopes: 
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-Github-Media-Type: github.v3; format=json
X-Github-Request-Id: D186:BAD3:3CFD183:463FDD2:5FB01D31
X-Oauth-Scopes: repo
X-Ratelimit-Limit: 30
X-Ratelimit-Remaining: 1
X-Ratelimit-Reset: 1605377359
X-Ratelimit-Used: 29
X-Xss-Protection: 1; mode=block

18b06
{"total_count":117,"incomplete_results":false,"items":[{"url":"https://api.github.com/repos/leafo/lapis/issues/670","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/670/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/670/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/670/events","html_url":"https://github.com/leafo/lapis/issues/670","id":449005921,"node_id":"MDU6SXNzdWU0NDkwMDU5MjE=","number":670,"title":"\"lapis new\" fails with error: attempt to index local '_with_0' (a nil value)","user":{"login":"marcdraco","id":8806862,"node_id":"MDQ6VXNlcjg4MDY4NjI=","avatar_url":"https://avatars3.githubusercontent.com/u/8806862?v=4","gravatar_id":"","url":"https://api.github.com/users/marcdraco","html_url":"https://github.com/marcdraco","followers_url":"https://api.github.com/users/marcdraco/followers","following_url":"https://api.github.com/users/marcdraco/following{/other_user}","gists_url":"https://api.github.com/users/marcdraco/gists{/gist_id}","starred_url":"https://api.github.com/users/marcdraco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcdraco/subscriptions","organizations_url":"https://api.github.com/users/marcdraco/orgs","repos_url":"https://api.github.com/users/marcdraco/repos","events_url":"https://api.github.com/users/marcdraco/events{/privacy}","received_events_url":"https://api.github.com/users/marcdraco/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-05-27T22:46:35Z","updated_at":"2020-08-20T17:14:16Z","closed_at":"2020-07-24T20:33:07Z","author_association":"NONE","active_lock_reason":null,"body":"Feel a bit of a dolt TBH. I got everything working, even the Crypto functions and so on on my freshly minted Alpline Linux (so a lot isn't install and it's Musl-based so there's that confusion). Moonscript installed too so I was about ready for liftoff whe:\r\n\r\n`\r\n$lapis new\r\n\r\nError: attempt to index local '_with_0' (a nil value)\r\n * Run with --trace to see traceback\r\n * Report issues to https://github.com/leafo/lapis/issues\r\nmuseum:~/webrathea$ lapis new --trace\r\n/usr/bin/lua5.1: /usr/local/share/lua/5.1/lapis/cmd/path.lua:33: attempt to index local '_with_0' (a nil value)\r\nstack traceback:\r\n\t/usr/local/share/lua/5.1/lapis/cmd/path.lua:33: in function 'fn'\r\n\t/usr/local/share/lua/5.1/lapis/cmd/path.lua:116: in function 'write_file'\r\n\t/usr/local/share/lua/5.1/lapis/cmd/actions.lua:32: in function 'write_file_safe'\r\n\t/usr/local/share/lua/5.1/lapis/cmd/nginx/actions.lua:19: in function 'new'\r\n\t/usr/local/share/lua/5.1/lapis/cmd/actions.lua:136: in function </usr/local/share/lua/5.1/lapis/cmd/actions.lua:129>\r\n\t(tail call): ?\r\n\t(tail call): ?\r\n\t(tail call): ?\r\n\t...local/lib/luarocks/rocks-5.1/lapis/1.7.0-1/bin/lapis:4: in main chunk\r\n\t[C]: ?\r\n`","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/665","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/665/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/665/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/665/events","html_url":"https://github.com/leafo/lapis/issues/665","id":420615607,"node_id":"MDU6SXNzdWU0MjA2MTU2MDc=","number":665,"title":"Unable to have cqueues production without cqueues explicity defined for development also","user":{"login":"ryanford-dev","id":20901017,"node_id":"MDQ6VXNlcjIwOTAxMDE3","avatar_url":"https://avatars2.githubusercontent.com/u/20901017?v=4","gravatar_id":"","url":"https://api.github.com/users/ryanford-dev","html_url":"https://github.com/ryanford-dev","followers_url":"https://api.github.com/users/ryanford-dev/followers","following_url":"https://api.github.com/users/ryanford-dev/following{/other_user}","gists_url":"https://api.github.com/users/ryanford-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/ryanford-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ryanford-dev/subscriptions","organizations_url":"https://api.github.com/users/ryanford-dev/orgs","repos_url":"https://api.github.com/users/ryanford-dev/repos","events_url":"https://api.github.com/users/ryanford-dev/events{/privacy}","received_events_url":"https://api.github.com/users/ryanford-dev/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-03-13T17:04:25Z","updated_at":"2020-07-24T21:51:51Z","closed_at":"2020-07-24T21:51:51Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"```lua\r\n-- config.lua\r\nlocal config = require('lapis.config')\r\n\r\nconfig('production', {\r\n   port = 80,\r\n   server = 'cqueues',\r\n})\r\n```\r\nRunning `lapis server production` will return\r\n```\r\n$ lapis server production\r\nError: file doesn't exist `nginx.conf'\r\n * Run with --trace to see traceback\r\n * Report issues to https://github.com/leafo/lapis/issues\r\n```\r\n\r\nAdding a matching config for development solves the issue.\r\n```lua\r\n-- config.lua\r\nlocal config = require('lapis.config')\r\n\r\nconfig('development', {\r\n   server = 'cqueues',\r\n   port = 8080,\r\n})\r\n\r\nconfig('production', {\r\n   port = 80,\r\n   server = 'cqueues',\r\n})\r\n```","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/Mudlet/mudlet-package-repo/issues/43","repository_url":"https://api.github.com/repos/Mudlet/mudlet-package-repo","labels_url":"https://api.github.com/repos/Mudlet/mudlet-package-repo/issues/43/labels{/name}","comments_url":"https://api.github.com/repos/Mudlet/mudlet-package-repo/issues/43/comments","events_url":"https://api.github.com/repos/Mudlet/mudlet-package-repo/issues/43/events","html_url":"https://github.com/Mudlet/mudlet-package-repo/issues/43","id":622593237,"node_id":"MDU6SXNzdWU2MjI1OTMyMzc=","number":43,"title":"Migrate to in-database storage","user":{"login":"vadi2","id":110988,"node_id":"MDQ6VXNlcjExMDk4OA==","avatar_url":"https://avatars1.githubusercontent.com/u/110988?v=4","gravatar_id":"","url":"https://api.github.com/users/vadi2","html_url":"https://github.com/vadi2","followers_url":"https://api.github.com/users/vadi2/followers","following_url":"https://api.github.com/users/vadi2/following{/other_user}","gists_url":"https://api.github.com/users/vadi2/gists{/gist_id}","starred_url":"https://api.github.com/users/vadi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vadi2/subscriptions","organizations_url":"https://api.github.com/users/vadi2/orgs","repos_url":"https://api.github.com/users/vadi2/repos","events_url":"https://api.github.com/users/vadi2/events{/privacy}","received_events_url":"https://api.github.com/users/vadi2/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-05-21T15:41:38Z","updated_at":"2020-05-21T17:11:32Z","closed_at":"2020-05-21T17:06:57Z","author_association":"MEMBER","active_lock_reason":null,"body":"We've started out with on-disk storage (because that's what we knew) but for ease of management in kubernetes, it's best if nothing is stored on disk. Migrate storage of packages to the database instead.","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lua-mailgun/issues/6","repository_url":"https://api.github.com/repos/leafo/lua-mailgun","labels_url":"https://api.github.com/repos/leafo/lua-mailgun/issues/6/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lua-mailgun/issues/6/comments","events_url":"https://api.github.com/repos/leafo/lua-mailgun/issues/6/events","html_url":"https://github.com/leafo/lua-mailgun/issues/6","id":623655699,"node_id":"MDU6SXNzdWU2MjM2NTU2OTk=","number":6,"title":"\"failed to adjust the subrequest\" when sending an email","user":{"login":"vadi2","id":110988,"node_id":"MDQ6VXNlcjExMDk4OA==","avatar_url":"https://avatars1.githubusercontent.com/u/110988?v=4","gravatar_id":"","url":"https://api.github.com/users/vadi2","html_url":"https://github.com/vadi2","followers_url":"https://api.github.com/users/vadi2/followers","following_url":"https://api.github.com/users/vadi2/following{/other_user}","gists_url":"https://api.github.com/users/vadi2/gists{/gist_id}","starred_url":"https://api.github.com/users/vadi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vadi2/subscriptions","organizations_url":"https://api.github.com/users/vadi2/orgs","repos_url":"https://api.github.com/users/vadi2/repos","events_url":"https://api.github.com/users/vadi2/events{/privacy}","received_events_url":"https://api.github.com/users/vadi2/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2020-05-23T12:58:31Z","updated_at":"2020-05-23T17:10:22Z","closed_at":"2020-05-23T17:10:21Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Given this code:\r\n\r\n```\r\n    local Mailgun = require(\"mailgun\").Mailgun\r\n    print(inspect(init))\r\n    print(inspect(message))\r\n\r\n    local m = Mailgun(init)\r\n    m:send_email(message)\r\n```\r\nGives this log:\r\n```\r\npackage-repo_1  | 2020/05/23 12:56:27 [notice] 16#16: *4 [lua] mail.lua:39: send(): {\r\npackage-repo_1  |   api_key = \"<legitimate key here>\",\r\npackage-repo_1  |   domain = \"mudlet.org\"\r\npackage-repo_1  | }, client: 172.21.0.1, server: , request: \"POST /register HTTP/1.1\", host: \"localhost:8080\", referrer: \"http://localhost:8080/register\"\r\npackage-repo_1  | 2020/05/23 12:56:27 [notice] 16#16: *4 [lua] mail.lua:40: send(): {\r\npackage-repo_1  |   body = \"Hello Vadi3. In order to verify your email address for your account with Mudlet Package Repository (experimental), please visit http://localhost:8080/verifyemail?ver_code=b6f12d02-bbf7-4cc9-ba4f-888cd79c0dbe&email=vperetokin+vadi3@gmail.com\\n\\nIf that url does not work, visit http://localhost:8080/verifyemail and enter your email address and the verification code b6f12d02-bbf7-4cc9-ba4f-888cd79c0dbe .\",\r\npackage-repo_1  |   from = \"do-not-reply@mudlet.org\",\r\npackage-repo_1  |   html = true,\r\npackage-repo_1  |   http = \"http.compat.socket\",\r\npackage-repo_1  |   subject = \"Please verify your email address with Mudlet Package Repository (experimental)\",\r\npackage-repo_1  |   to = \"Vadi3 <vperetokin+vadi3@gmail.com>\"\r\npackage-repo_1  | }, client: 172.21.0.1, server: , request: \"POST /register HTTP/1.1\", host: \"localhost:8080\", referrer: \"http://localhost:8080/register\"\r\npackage-repo_1  | 2020/05/23 12:56:27 [error] 16#16: *4 variable \"_url\" cannot be assigned a value (maybe you forgot to define it first?) , client: 172.21.0.1, server: , request: \"POST /register HTTP/1.1\", host: \"localhost:8080\", referrer: \"http://localhost:8080/register\"\r\npackage-repo_1  | 2020/05/23 12:56:27 [error] 16#16: *4 lua coroutine: runtime error: /usr/local/share/lua/5.1/lapis/nginx/http.lua:94: failed to adjust the subrequest: -1\r\npackage-repo_1  | stack traceback:\r\npackage-repo_1  | coroutine 0:\r\npackage-repo_1  | \t[C]: in function 'capture'\r\npackage-repo_1  | \t/usr/local/share/lua/5.1/lapis/nginx/http.lua:94: in function 'request'\r\npackage-repo_1  | \t/usr/local/share/lua/5.1/mailgun/init.lua:96: in function 'send_email'\r\npackage-repo_1  | \t./controllers/mail.lua:43: in function 'send'\r\npackage-repo_1  | \t./controllers/mail.lua:53: in function 'send_verification'\r\n```\r\n\r\nThe `variable \"_url\" cannot be assigned a value (maybe you forgot to define it first?)` bit looks suspicious, but a scan of the code showed `url` being defined fine.\r\n\r\nUsing lua-http as the http provider didn't help either.","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/rstudio/redx/issues/19","repository_url":"https://api.github.com/repos/rstudio/redx","labels_url":"https://api.github.com/repos/rstudio/redx/issues/19/labels{/name}","comments_url":"https://api.github.com/repos/rstudio/redx/issues/19/comments","events_url":"https://api.github.com/repos/rstudio/redx/issues/19/events","html_url":"https://github.com/rstudio/redx/issues/19","id":113175273,"node_id":"MDU6SXNzdWUxMTMxNzUyNzM=","number":19,"title":"multipart/form-data file upload broken - nginx/redx hangs and never forwards request body","user":{"login":"whummer","id":2807888,"node_id":"MDQ6VXNlcjI4MDc4ODg=","avatar_url":"https://avatars0.githubusercontent.com/u/2807888?v=4","gravatar_id":"","url":"https://api.github.com/users/whummer","html_url":"https://github.com/whummer","followers_url":"https://api.github.com/users/whummer/followers","following_url":"https://api.github.com/users/whummer/following{/other_user}","gists_url":"https://api.github.com/users/whummer/gists{/gist_id}","starred_url":"https://api.github.com/users/whummer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/whummer/subscriptions","organizations_url":"https://api.github.com/users/whummer/orgs","repos_url":"https://api.github.com/users/whummer/repos","events_url":"https://api.github.com/users/whummer/events{/privacy}","received_events_url":"https://api.github.com/users/whummer/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-10-24T18:09:17Z","updated_at":"2020-04-08T16:37:26Z","closed_at":"2020-04-08T16:37:26Z","author_association":"NONE","active_lock_reason":null,"body":"It seems that file upload requests of the following form cannot be handled by redx:\n\n```\nPOST /upload HTTP/1.1\nContent-Type: multipart/form-data; boundary=---a52b3f2495c75e44\nContent-Length: 156\n...\n\n-----a52b3f2495c75e44\nContent-Disposition: form-data; name=\"uploadfile\";filename=\"uploadfile\"\nContent-type: plain/text\n\ntest123\n-----a52b3f2495c75e44--\n```\n\nThe headers are properly forwarded to the target backend host, but then redx hangs and the request body is not forwarded (timeout after 30 secs). The reason seems to be an error in `lapis/nginx.lua` which attempts to parse the multipart message but hangs in the \"while true\" loop:\nhttps://github.com/leafo/lapis/blob/26f4d8f5316969777fc270e262bd6b4a013e0713/lapis/nginx.lua#L18\n\nA dirty \"quick fix\" is to disable the `resty.upload` module from being instantiated properly, in `nginx.conf`:\n\n```\nlocation / {\n        access_by_lua '\n            -- fix to disable file upload handling (i.e., force pass-through)\n            require(\"resty.upload\").new = function(self, chunk_size)\n                return nil, nil\n            end\n            require(\"lapis\").serve(\"main\")\n        ';\n        ...\n}\n```\n\nThis way the `resty.upload` module is not used in `lapis.nginx` and the request body is forwarded without being parsed (see line 22):\nhttps://github.com/leafo/lapis/blob/26f4d8f5316969777fc270e262bd6b4a013e0713/lapis/nginx.lua#L22\n\nFor redx as a reverse proxy, it should not be necessary to parse message contents at all. It would be great if redx could fix this issue (in a more elegant way than the suggested quick fix), or at least provide a configuration option to disable `multipart/form-data`message parsing.\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/web_sanitize/issues/1","repository_url":"https://api.github.com/repos/leafo/web_sanitize","labels_url":"https://api.github.com/repos/leafo/web_sanitize/issues/1/labels{/name}","comments_url":"https://api.github.com/repos/leafo/web_sanitize/issues/1/comments","events_url":"https://api.github.com/repos/leafo/web_sanitize/issues/1/events","html_url":"https://github.com/leafo/web_sanitize/issues/1","id":125381006,"node_id":"MDU6SXNzdWUxMjUzODEwMDY=","number":1,"title":"'&' is not sanitized","user":{"login":"karai17","id":590332,"node_id":"MDQ6VXNlcjU5MDMzMg==","avatar_url":"https://avatars3.githubusercontent.com/u/590332?v=4","gravatar_id":"","url":"https://api.github.com/users/karai17","html_url":"https://github.com/karai17","followers_url":"https://api.github.com/users/karai17/followers","following_url":"https://api.github.com/users/karai17/following{/other_user}","gists_url":"https://api.github.com/users/karai17/gists{/gist_id}","starred_url":"https://api.github.com/users/karai17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karai17/subscriptions","organizations_url":"https://api.github.com/users/karai17/orgs","repos_url":"https://api.github.com/users/karai17/repos","events_url":"https://api.github.com/users/karai17/events{/privacy}","received_events_url":"https://api.github.com/users/karai17/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2016-01-07T12:00:01Z","updated_at":"2020-04-25T18:29:11Z","closed_at":"2016-01-08T02:58:50Z","author_association":"NONE","active_lock_reason":null,"body":"The official way to sanitize `&` is to convert it to `&amp;`. This is not being performed. There are some use cases for this, for instance if I type the text `&lt;` into a textbox and sanitize it, it santizes to `&lt;` and prints out `<` which is not what I want. I want it to sanitize to `&amp;lt;` which will print out `&lt;`.\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/667","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/667/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/667/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/667/events","html_url":"https://github.com/leafo/lapis/issues/667","id":431459828,"node_id":"MDU6SXNzdWU0MzE0NTk4Mjg=","number":667,"title":"`OPENSSL_1_1_1' not found ","user":{"login":"vadi2","id":110988,"node_id":"MDQ6VXNlcjExMDk4OA==","avatar_url":"https://avatars1.githubusercontent.com/u/110988?v=4","gravatar_id":"","url":"https://api.github.com/users/vadi2","html_url":"https://github.com/vadi2","followers_url":"https://api.github.com/users/vadi2/followers","following_url":"https://api.github.com/users/vadi2/following{/other_user}","gists_url":"https://api.github.com/users/vadi2/gists{/gist_id}","starred_url":"https://api.github.com/users/vadi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vadi2/subscriptions","organizations_url":"https://api.github.com/users/vadi2/orgs","repos_url":"https://api.github.com/users/vadi2/repos","events_url":"https://api.github.com/users/vadi2/events{/privacy}","received_events_url":"https://api.github.com/users/vadi2/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-04-10T11:51:35Z","updated_at":"2020-05-28T04:27:38Z","closed_at":"2020-04-18T12:27:19Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Using Ubuntu 18.04 and Lua 5.1.5, lapis 1.7.0 and openresty 1.13.6.2-1, going to `localhost:8080` on the default example doesn't work:\r\n\r\n```lua\r\n$ lapis server\r\nnginx: [alert] lua_code_cache is off; this will hurt performance in /home/vadi/Programs/smart-rubber-playground/nginx.conf.compiled:16\r\n2019/04/10 11:38:29 [notice] 2709#2709: using the \"epoll\" event method\r\n2019/04/10 11:38:29 [notice] 2709#2709: openresty/1.13.6.2\r\n2019/04/10 11:38:29 [notice] 2709#2709: OS: Linux 4.15.0-34-generic\r\n2019/04/10 11:38:29 [notice] 2709#2709: getrlimit(RLIMIT_NOFILE): 1024:4096\r\n2019/04/10 11:38:29 [notice] 2709#2709: start worker processes\r\n2019/04/10 11:38:29 [notice] 2709#2709: start worker process 2710\r\n2019/04/10 11:38:36 [error] 2710#2710: *1 lua entry thread aborted: runtime error: error loading module '_openssl.hmac' from file '/usr/local/lib/lua/5.1/_openssl.so':\r\n\t/usr/local/openresty/openssl/lib/libssl.so.1.1: version `OPENSSL_1_1_1' not found (required by /usr/local/lib/lua/5.1/_openssl.so)\r\nstack traceback:\r\ncoroutine 0:\r\n\t[C]: in function 'require'\r\n\tcontent_by_lua(nginx.conf.compiled:22):2: in function <content_by_lua(nginx.conf.compiled:22):1>, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", host: \"localhost:8080\"\r\n```\r\n\r\nI've tried the hello world example from openresty and that seems to be working fine.","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis-community/issues/4","repository_url":"https://api.github.com/repos/leafo/lapis-community","labels_url":"https://api.github.com/repos/leafo/lapis-community/issues/4/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis-community/issues/4/comments","events_url":"https://api.github.com/repos/leafo/lapis-community/issues/4/events","html_url":"https://github.com/leafo/lapis-community/issues/4","id":553071418,"node_id":"MDU6SXNzdWU1NTMwNzE0MTg=","number":4,"title":"attempt to call method 'allowed_to_post_topic' (a nil value)","user":{"login":"olueiro","id":18295195,"node_id":"MDQ6VXNlcjE4Mjk1MTk1","avatar_url":"https://avatars0.githubusercontent.com/u/18295195?v=4","gravatar_id":"","url":"https://api.github.com/users/olueiro","html_url":"https://github.com/olueiro","followers_url":"https://api.github.com/users/olueiro/followers","following_url":"https://api.github.com/users/olueiro/following{/other_user}","gists_url":"https://api.github.com/users/olueiro/gists{/gist_id}","starred_url":"https://api.github.com/users/olueiro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olueiro/subscriptions","organizations_url":"https://api.github.com/users/olueiro/orgs","repos_url":"https://api.github.com/users/olueiro/repos","events_url":"https://api.github.com/users/olueiro/events{/privacy}","received_events_url":"https://api.github.com/users/olueiro/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-01-21T19:09:34Z","updated_at":"2020-01-21T19:22:16Z","closed_at":"2020-01-21T19:11:51Z","author_association":"NONE","active_lock_reason":null,"body":"Hi leafo,\r\n\r\nI found an error on Reply older post:\r\n\r\nURL: `<my-site>/topic/2/new-post`\r\n\r\n```\r\nError\r\n/usr/local/share/lua/5.1/lapis/application.lua:401: ./app.lua:137: attempt to call method 'allowed_to_post_topic' (a nil value)\r\nstack traceback:\r\n\t./app.lua: in function 'filter'\r\n\t/usr/local/share/lua/5.1/lapis/application.lua:17: in function 'run_before_filter'\r\n\t/usr/local/share/lua/5.1/lapis/application.lua:361: in function </usr/local/share/lua/5.1/lapis/application.lua:355>\r\nTraceback\r\nstack traceback:\r\n\t[C]: in function 'error'\r\n\t/usr/local/share/lua/5.1/lapis/application.lua:401: in function 'handler'\r\n\t/usr/local/share/lua/5.1/lapis/application.lua:130: in function 'resolve'\r\n\t/usr/local/share/lua/5.1/lapis/application.lua:167: in function </usr/local/share/lua/5.1/lapis/application.lua:165>\r\n\t[C]: in function 'xpcall'\r\n\t/usr/local/share/lua/5.1/lapis/application.lua:173: in function 'dispatch'\r\n\t/usr/local/share/lua/5.1/lapis/nginx.lua:230: in function 'serve'\r\n\tcontent_by_lua(nginx.conf.compiled:30):2: in main chunk\r\n```\r\n\r\n`allowed_to_post_topic`is not a `@topic` method.\r\n\r\nhttps://github.com/leafo/lapis-community/blob/5e0a1a5202bbb9588438bf063dc6d7ea44534a20/app.moon#L98\r\n\r\nCan you help me. please :)","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/684","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/684/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/684/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/684/events","html_url":"https://github.com/leafo/lapis/issues/684","id":564351365,"node_id":"MDU6SXNzdWU1NjQzNTEzNjU=","number":684,"title":"Error on \"Working with etlua\" exercise: /usr/local/share/lua/5.1/lapis/request.lua:226: module 'views.list' not found:","user":{"login":"knarxism","id":60991150,"node_id":"MDQ6VXNlcjYwOTkxMTUw","avatar_url":"https://avatars0.githubusercontent.com/u/60991150?v=4","gravatar_id":"","url":"https://api.github.com/users/knarxism","html_url":"https://github.com/knarxism","followers_url":"https://api.github.com/users/knarxism/followers","following_url":"https://api.github.com/users/knarxism/following{/other_user}","gists_url":"https://api.github.com/users/knarxism/gists{/gist_id}","starred_url":"https://api.github.com/users/knarxism/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/knarxism/subscriptions","organizations_url":"https://api.github.com/users/knarxism/orgs","repos_url":"https://api.github.com/users/knarxism/repos","events_url":"https://api.github.com/users/knarxism/events{/privacy}","received_events_url":"https://api.github.com/users/knarxism/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-02-12T23:50:16Z","updated_at":"2020-02-14T19:53:13Z","closed_at":"2020-02-14T19:53:13Z","author_association":"NONE","active_lock_reason":null,"body":"This was one of the most gruelling installs, took me several hours to get to this point. Pretty stoked to get working, but now I am stuck. I went through some of the beginner exercises in https://leafo.net/lapis/reference/lua_getting_started.html with no issues until I got to the \"Working with etlua\". I used the verbatim code in the exercise and can't move further. \r\n\r\nCan anyone point me in the right direction? I'd love to get this work. Some details if they help:\r\n\r\n- ubuntu laptop\r\n- had to compile openresty manual (ubuntu packages just didn't work)\r\n- uses lua5.1 \r\n- installed liblua5.1-0-dev\r\n- installed libpcre3-dev \r\n- installed libssl-dev perl\r\n- tried package.path = package.path .. \";./?.lua;./?.etlua\" in app.lua (as per this issue: https://github.com/leafo/lapis/issues/616) - this did not work, but may have gotten it wrong.\r\n- The only thing I did slightly differently was add host in my etc/hosts for lapis.local instead of going to localhost. This is in my config file at the bottom. \r\n\r\nerrors from webpage and then lapis server below. \r\n\r\n<pre>\r\n/usr/local/share/lua/5.1/lapis/request.lua:226: module 'views.list' not found: \r\n\tno field package.preload['views.list']could not load `etlua` file\r\n\tno file '/usr/local/openresty/site/lualib/views/list.ljbc'\r\n\tno file '/usr/local/openresty/site/lualib/views/list/init.ljbc'\r\n\tno file '/usr/local/openresty/lualib/views/list.ljbc'\r\n\tno file '/usr/local/openresty/lualib/views/list/init.ljbc'\r\n\tno file '/usr/local/openresty/site/lualib/views/list.lua'\r\n\tno file '/usr/local/openresty/site/lualib/views/list/init.lua'\r\n\tno file '/usr/local/openresty/lualib/views/list.lua'\r\n\tno file '/usr/local/openresty/lualib/views/list/init.lua'\r\n\tno file './views/list.lua'\r\n\tno file '/usr/local/openresty/luajit/share/luajit-2.1.0-beta3/views/list.lua'\r\n\tno file '/usr/local/share/lua/5.1/views/list.lua'\r\n\tno file '/usr/local/share/lua/5.1/views/list/init.lua'\r\n\tno file '/usr/local/openresty/luajit/share/lua/5.1/views/list.lua'\r\n\tno file '/usr/local/openresty/luajit/share/lua/5.1/views/list/init.lua'\r\n\tno file '/usr/local/openresty/site/lualib/views/list.so'\r\n\tno file '/usr/local/openresty/lualib/views/list.so'\r\n\tno file './views/list.so'\r\n\tno file '/usr/local/lib/lua/5.1/views/list.so'\r\n\tno file '/usr/local/openresty/luajit/lib/lua/5.1/views/list.so'\r\n\tno file '/usr/local/lib/lua/5.1/loadall.so'\r\n\tno file '/usr/local/openresty/site/lualib/views.so'\r\n\tno file '/usr/local/openresty/lualib/views.so'\r\n\tno file './views.so'\r\n\tno file '/usr/local/lib/lua/5.1/views.so'\r\n\tno file '/usr/local/openresty/luajit/lib/lua/5.1/views.so'\r\n\tno file '/usr/local/lib/lua/5.1/loadall.so'\r\n</pre>\r\n\r\nLapis Server Error\r\n\r\n<pre>\r\nuser:/var/www/lapis.local$ sudo lapis server       \r\nnginx: [alert] lua_code_cache is off; this will hurt performance in /var/www/lapis.local/nginx.conf.compiled:16\r\n2020/02/12 15:21:47 [notice] 27446#0: using the \"epoll\" event method\r\n2020/02/12 15:21:47 [notice] 27446#0: openresty/1.15.8.2\r\n2020/02/12 15:21:47 [notice] 27446#0: built by gcc 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1) \r\n2020/02/12 15:21:47 [notice] 27446#0: OS: Linux 5.3.0-28-generic\r\n2020/02/12 15:21:47 [notice] 27446#0: getrlimit(RLIMIT_NOFILE): 1024:4096\r\n2020/02/12 15:21:47 [notice] 27446#0: start worker processes\r\n2020/02/12 15:21:47 [notice] 27446#0: start worker process 27447\r\n2020/02/12 15:21:51 [warn] 27447#0: *1 [lua] _G write guard:12: writing a global lua variable ('lpeg') which may lead to race conditions between concurrent requests, so prefer the use of 'local' variables\r\nstack traceback:\r\n\t[C]: at 0x7fad461f6680\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/lapis/router.lua:3: in main chunk\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/lapis/application.lua:4: in main chunk\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/lapis/init.lua:1: in main chunk\r\n\t[C]: in function 'require'\r\n\tcontent_by_lua(nginx.conf.compiled:22):2: in main chunk, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", host: \"lapis.local:9090\"\r\n2020/02/12 15:21:51 [warn] 27447#0: *1 [lua] _G write guard:12: writing a global lua variable ('socket') which may lead to race conditions between concurrent requests, so prefer the use of 'local' variables\r\nstack traceback:\r\n\t[C]: at 0x7fad45fe52e0\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/socket.lua:12: in main chunk\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/socket/url.lua:13: in main chunk\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/lapis/util.lua:1: in main chunk\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/lapis/router.lua:9: in main chunk\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/lapis/application.lua:4: in main chunk\r\n\t[C]: in function 'require'\r\n\t/usr/local/share/lua/5.1/lapis/init.lua:1: in main chunk\r\n\t[C]: in function 'require'\r\n\tcontent_by_lua(nginx.conf.compiled:22):2: in main chunk, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", host: \"lapis.local:9090\"\r\n2020/02/12 15:21:51 [notice] 27447#0: *1 [lua] application.lua:177: dispatch(): [500] GET / - {}, client: 127.0.0.1, server: , request: \"GET / HTTP/1.1\", host: \"lapis.local:9090\"\r\n\r\n</pre>\r\n\r\nconfig.lua\r\n<pre>\r\nlocal config = require(\"lapis.config\")\r\n\r\nconfig(\"development\", {\r\n  port = 9090,\r\n  host = \"lapis.local\",\r\n  greeting = \"Lapis Dev Server\"\r\n})\r\n</pre>\r\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/Kong/kong/issues/4672","repository_url":"https://api.github.com/repos/Kong/kong","labels_url":"https://api.github.com/repos/Kong/kong/issues/4672/labels{/name}","comments_url":"https://api.github.com/repos/Kong/kong/issues/4672/comments","events_url":"https://api.github.com/repos/Kong/kong/issues/4672/events","html_url":"https://github.com/Kong/kong/issues/4672","id":450640562,"node_id":"MDU6SXNzdWU0NTA2NDA1NjI=","number":4672,"title":"Plugin parameter configurations do not support more than 3 layers of nesting","user":{"login":"ccjinghang","id":43395027,"node_id":"MDQ6VXNlcjQzMzk1MDI3","avatar_url":"https://avatars1.githubusercontent.com/u/43395027?v=4","gravatar_id":"","url":"https://api.github.com/users/ccjinghang","html_url":"https://github.com/ccjinghang","followers_url":"https://api.github.com/users/ccjinghang/followers","following_url":"https://api.github.com/users/ccjinghang/following{/other_user}","gists_url":"https://api.github.com/users/ccjinghang/gists{/gist_id}","starred_url":"https://api.github.com/users/ccjinghang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccjinghang/subscriptions","organizations_url":"https://api.github.com/users/ccjinghang/orgs","repos_url":"https://api.github.com/users/ccjinghang/repos","events_url":"https://api.github.com/users/ccjinghang/events{/privacy}","received_events_url":"https://api.github.com/users/ccjinghang/received_events","type":"User","site_admin":false},"labels":[{"id":724163967,"node_id":"MDU6TGFiZWw3MjQxNjM5Njc=","url":"https://api.github.com/repos/Kong/kong/labels/pending%20author%20feedback","name":"pending author feedback","color":"64e081","default":false,"description":"Waiting for the issue author to get back to a maintainer with findings, more details, etc..."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-05-31T06:43:19Z","updated_at":"2019-09-03T08:41:31Z","closed_at":"2019-08-29T23:44:02Z","author_association":"NONE","active_lock_reason":null,"body":"Hello!\r\nMy schema file is as follows:\r\n\r\n```\r\nlocal typedefs = require \"kong.db.schema.typedefs\"\r\n\r\nlocal child_elements_contion = {\r\n  type = \"record\",\r\n  fields = {\r\n    { mark_key = { type = \"string\" }, },\r\n\t{ mark_key_index = { type = \"number\", default = 1 }, },\r\n\t{ mark_key_value = { type = \"string\" }, },\r\n\t{ mark_type = { type = \"string\" ,  one_of = { \"path\", \"query\", \"header\", \"body\" },}, },\r\n\t{ mark_method = { type = \"string\",one_of = { \"start_with\", \"end_with\", \"contain\", \"regex\" }, }, },\r\n  },\r\n }\r\n\t\t\t  \r\nlocal child_child_elements_relation = {\r\n  type = \"record\",\r\n  --required = true,\r\n  fields = {\r\n    { condition = { type = \"array\", default = {}, elements = child_elements_contion, }, },\r\n    { relationship = { type = \"string\" , default = \"AND\" ,one_of = { \"AND\", \"NOR\", \"NOT\" },}, },\r\n  },\r\n}\t\t\r\n\r\n\r\nlocal child_elements_relation = {\r\n  type = \"record\",\r\n  --required = true,\r\n  fields = {\r\n    { condition = { type = \"array\", default = {}, elements = child_elements_contion, }, },\r\n    { ralation = { type = \"array\", default = {}, elements = child_child_elements_relation, }, },\r\n    { relationship = { type = \"string\" , default = \"AND\" ,one_of = { \"AND\", \"NOR\", \"NOT\" },}, },\r\n  },\r\n}\t\t\t\t  \r\n\t\t\t  \r\nlocal elements_record = {\r\n  type = \"record\",\r\n  fields = { \r\n    { condition = { type = \"array\", default = {}, elements = child_elements_contion, }, },\r\n    { ralation = { type = \"array\", default = {}, elements = child_elements_relation, }, },\r\n    { relationship = { type = \"string\" , default = \"AND\" ,one_of = { \"AND\", \"NOR\", \"NOT\" },}, },\r\n\t{ ip = { type = \"string\" }, },\r\n\t{ port = { type = \"number\"}, },\r\n\t{ upstream = { type = \"string\" }, },\r\n  },\r\n}\r\n\t\t\t\r\nlocal mark_array = {\r\n  type = \"array\",\r\n  default = {},\r\n  elements = elements_record,\r\n}\r\n\r\nreturn {\r\n  name = \"mark-route\",\r\n  fields = {\r\n    { config = {\r\n        type = \"record\",\r\n        fields = {\r\n          { mark_number = { type = \"number\", default = 0 }, },\r\n          { mark = mark_array,  },\r\n\t\t  { timestamp = { type = \"number\" ,default = 0}, },\r\n        },\r\n    }, },\r\n  },\r\n}\r\n```\r\n\r\n**An error occurred when I set the parameters as follows:**\r\n```\r\nconfig.mark[1].ralation[1].condition[1].mark_key = 3\r\n```\r\n\r\n**Error is as follows:**\r\n```\r\n2019/05/31 14:19:56 [error] 6350#0: *12665 [lua] init.lua:161: handle_error(): /usr/local/share/lua/5.1/lapis/request.lua:291: attempt to index local 'curr' (a string value)\r\n```\r\n\r\nCan you help me solve this problem?\r\n\r\n\r\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/threefoldtech/jumpscaleX_archived/issues/711","repository_url":"https://api.github.com/repos/threefoldtech/jumpscaleX_archived","labels_url":"https://api.github.com/repos/threefoldtech/jumpscaleX_archived/issues/711/labels{/name}","comments_url":"https://api.github.com/repos/threefoldtech/jumpscaleX_archived/issues/711/comments","events_url":"https://api.github.com/repos/threefoldtech/jumpscaleX_archived/issues/711/events","html_url":"https://github.com/threefoldtech/jumpscaleX_archived/issues/711","id":467811995,"node_id":"MDU6SXNzdWU0Njc4MTE5OTU=","number":711,"title":"finish threebot server factory","user":{"login":"despiegk","id":6021844,"node_id":"MDQ6VXNlcjYwMjE4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/6021844?v=4","gravatar_id":"","url":"https://api.github.com/users/despiegk","html_url":"https://github.com/despiegk","followers_url":"https://api.github.com/users/despiegk/followers","following_url":"https://api.github.com/users/despiegk/following{/other_user}","gists_url":"https://api.github.com/users/despiegk/gists{/gist_id}","starred_url":"https://api.github.com/users/despiegk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/despiegk/subscriptions","organizations_url":"https://api.github.com/users/despiegk/orgs","repos_url":"https://api.github.com/users/despiegk/repos","events_url":"https://api.github.com/users/despiegk/events{/privacy}","received_events_url":"https://api.github.com/users/despiegk/received_events","type":"User","site_admin":false},"labels":[{"id":1166794494,"node_id":"MDU6TGFiZWwxMTY2Nzk0NDk0","url":"https://api.github.com/repos/threefoldtech/jumpscaleX_archived/labels/state_inprogress","name":"state_inprogress","color":"bfe5bf","default":false,"description":null}],"state":"closed","locked":true,"assignee":{"login":"xmonader","id":64129,"node_id":"MDQ6VXNlcjY0MTI5","avatar_url":"https://avatars0.githubusercontent.com/u/64129?v=4","gravatar_id":"","url":"https://api.github.com/users/xmonader","html_url":"https://github.com/xmonader","followers_url":"https://api.github.com/users/xmonader/followers","following_url":"https://api.github.com/users/xmonader/following{/other_user}","gists_url":"https://api.github.com/users/xmonader/gists{/gist_id}","starred_url":"https://api.github.com/users/xmonader/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xmonader/subscriptions","organizations_url":"https://api.github.com/users/xmonader/orgs","repos_url":"https://api.github.com/users/xmonader/repos","events_url":"https://api.github.com/users/xmonader/events{/privacy}","received_events_url":"https://api.github.com/users/xmonader/received_events","type":"User","site_admin":false},"assignees":[{"login":"xmonader","id":64129,"node_id":"MDQ6VXNlcjY0MTI5","avatar_url":"https://avatars0.githubusercontent.com/u/64129?v=4","gravatar_id":"","url":"https://api.github.com/users/xmonader","html_url":"https://github.com/xmonader","followers_url":"https://api.github.com/users/xmonader/followers","following_url":"https://api.github.com/users/xmonader/following{/other_user}","gists_url":"https://api.github.com/users/xmonader/gists{/gist_id}","starred_url":"https://api.github.com/users/xmonader/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xmonader/subscriptions","organizations_url":"https://api.github.com/users/xmonader/orgs","repos_url":"https://api.github.com/users/xmonader/repos","events_url":"https://api.github.com/users/xmonader/events{/privacy}","received_events_url":"https://api.github.com/users/xmonader/received_events","type":"User","site_admin":false},{"login":"Hamdy","id":526328,"node_id":"MDQ6VXNlcjUyNjMyOA==","avatar_url":"https://avatars1.githubusercontent.com/u/526328?v=4","gravatar_id":"","url":"https://api.github.com/users/Hamdy","html_url":"https://github.com/Hamdy","followers_url":"https://api.github.com/users/Hamdy/followers","following_url":"https://api.github.com/users/Hamdy/following{/other_user}","gists_url":"https://api.github.com/users/Hamdy/gists{/gist_id}","starred_url":"https://api.github.com/users/Hamdy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hamdy/subscriptions","organizations_url":"https://api.github.com/users/Hamdy/orgs","repos_url":"https://api.github.com/users/Hamdy/repos","events_url":"https://api.github.com/users/Hamdy/events{/privacy}","received_events_url":"https://api.github.com/users/Hamdy/received_events","type":"User","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/threefoldtech/jumpscaleX_archived/milestones/5","html_url":"https://github.com/threefoldtech/jumpscaleX_archived/milestone/5","labels_url":"https://api.github.com/repos/threefoldtech/jumpscaleX_archived/milestones/5/labels","id":4328274,"node_id":"MDk6TWlsZXN0b25lNDMyODI3NA==","number":5,"title":"now","description":"","creator":{"login":"despiegk","id":6021844,"node_id":"MDQ6VXNlcjYwMjE4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/6021844?v=4","gravatar_id":"","url":"https://api.github.com/users/despiegk","html_url":"https://github.com/despiegk","followers_url":"https://api.github.com/users/despiegk/followers","following_url":"https://api.github.com/users/despiegk/following{/other_user}","gists_url":"https://api.github.com/users/despiegk/gists{/gist_id}","starred_url":"https://api.github.com/users/despiegk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/despiegk/subscriptions","organizations_url":"https://api.github.com/users/despiegk/orgs","repos_url":"https://api.github.com/users/despiegk/repos","events_url":"https://api.github.com/users/despiegk/events{/privacy}","received_events_url":"https://api.github.com/users/despiegk/received_events","type":"User","site_admin":false},"open_issues":9,"closed_issues":128,"state":"open","created_at":"2019-05-19T08:20:57Z","updated_at":"2019-09-10T16:15:35Z","due_on":null,"closed_at":null},"comments":4,"created_at":"2019-07-14T08:52:14Z","updated_at":"2019-08-14T07:38:05Z","closed_at":"2019-08-14T07:38:05Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"\r\nneed to wait for #709  (openresty)\r\n\r\ntodo\r\n\r\n- [x] test chatbot\r\n- [ ] authentication through openresty (need add on there probably) for chatbot\r\n- [ ] packaging (kristof)\r\n- [ ] integration of gundb client (need auth with master passwd)\r\n- [ ] integration graphql client (need auth with master passwd)\r\n- tbd\r\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/neovim/neovim/issues/6580","repository_url":"https://api.github.com/repos/neovim/neovim","labels_url":"https://api.github.com/repos/neovim/neovim/issues/6580/labels{/name}","comments_url":"https://api.github.com/repos/neovim/neovim/issues/6580/comments","events_url":"https://api.github.com/repos/neovim/neovim/issues/6580/events","html_url":"https://github.com/neovim/neovim/issues/6580","id":223846853,"node_id":"MDU6SXNzdWUyMjM4NDY4NTM=","number":6580,"title":"Lua \"stdlib\" (standard library)","user":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars0.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","site_admin":false},"labels":[{"id":77997476,"node_id":"MDU6TGFiZWw3Nzk5NzQ3Ng==","url":"https://api.github.com/repos/neovim/neovim/labels/enhancement","name":"enhancement","color":"c2e0c6","default":true,"description":""},{"id":573222693,"node_id":"MDU6TGFiZWw1NzMyMjI2OTM=","url":"https://api.github.com/repos/neovim/neovim/labels/lua","name":"lua","color":"c5def5","default":false,"description":null},{"id":120251370,"node_id":"MDU6TGFiZWwxMjAyNTEzNzA=","url":"https://api.github.com/repos/neovim/neovim/labels/runtime","name":"runtime","color":"c5def5","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/neovim/neovim/milestones/21","html_url":"https://github.com/neovim/neovim/milestone/21","labels_url":"https://api.github.com/repos/neovim/neovim/milestones/21/labels","id":3930226,"node_id":"MDk6TWlsZXN0b25lMzkzMDIyNg==","number":21,"title":"0.4","description":"","creator":{"login":"justinmk","id":1359421,"node_id":"MDQ6VXNlcjEzNTk0MjE=","avatar_url":"https://avatars0.githubusercontent.com/u/1359421?v=4","gravatar_id":"","url":"https://api.github.com/users/justinmk","html_url":"https://github.com/justinmk","followers_url":"https://api.github.com/users/justinmk/followers","following_url":"https://api.github.com/users/justinmk/following{/other_user}","gists_url":"https://api.github.com/users/justinmk/gists{/gist_id}","starred_url":"https://api.github.com/users/justinmk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justinmk/subscriptions","organizations_url":"https://api.github.com/users/justinmk/orgs","repos_url":"https://api.github.com/users/justinmk/repos","events_url":"https://api.github.com/users/justinmk/events{/privacy}","received_events_url":"https://api.github.com/users/justinmk/received_events","type":"User","site_admin":false},"open_issues":0,"closed_issues":218,"state":"closed","created_at":"2018-12-30T22:10:04Z","updated_at":"2020-01-31T07:08:01Z","due_on":"2019-09-15T07:00:00Z","closed_at":"2019-09-18T04:28:47Z"},"comments":33,"created_at":"2017-04-24T14:52:45Z","updated_at":"2019-05-18T19:57:27Z","closed_at":"2019-05-18T19:51:24Z","author_association":"MEMBER","active_lock_reason":null,"body":"We may want to include some small, robust, lua modules as part of the Nvim runtime. (Keeping in mind: where possible it is preferable to have Nvim be the \"standard library\", i.e. wrap internal vim/libuv/API functions.)\r\n\r\nPossible candidates:\r\n\r\n- http://leafo.net/lapis/reference/utilities.html\r\n- https://github.com/torch/paths\r\n- https://github.com/jaawerth/fennel-nvim\r\n- https://github.com/bakpakin/Fennel (pretty print, repl)\r\n- https://github.com/luafun/luafun util lib\r\n- https://github.com/rxi/lume util lib\r\n- howl editor: https://github.com/howl-editor/howl/tree/master/lib/howl/util\r\n- similar to penlight? https://github.com/luapower/luapower-all\r\n- webserver: https://github.com/lpereira/lwan\r\n\r\n\r\nRelated: https://github.com/neovim/neovim/pull/8677\r\nRelated: https://github.com/neovim/neovim/pull/7123\r\n\r\n### Nvim-Lua guidelines\r\n\r\n- https://github.com/neovim/neovim/pull/8677#issuecomment-402102325\r\n- https://github.com/neovim/neovim/pull/8677#issuecomment-403737119\r\n\r\n### Lua doctsrings\r\n\r\n- ~~Looks like [ldoc](https://github.com/stevedonovan/ldoc) is the least-terrible solution. (It's not actively maintained but it's still used by penlight, and we only need it for the [parsed info](https://stevedonovan.github.io/ldoc/manual/doc.md.html#Internal_Data_Representation), not the other fancy features).~~ Resolved by https://github.com/neovim/neovim/pull/9740\r\n\r\n### Lua \"module\" policy\r\n\r\n- Most functions should live directly on `vim.`, not in child modules. We own the `vim.*` module; the only \"forbidden\" names are those claimed by legacy `if_lua`:\r\n   ```\r\n   $ vim\r\n   :lua for k,v in pairs(vim) do print(k) end\r\n   buffer\r\n   open\r\n   window\r\n   lastline\r\n   firstline\r\n   type\r\n   line\r\n   eval\r\n   dict\r\n   beep\r\n   list\r\n   command\r\n   ```\r\n- Any child modules (`vim.*)` that we _do_ introduce should not be named `vim.helpers`, but something meaningful. And they should be rare.\r\n\r\nLua code can live in one of two places: \r\n\r\n1. The runtime (`runtime/lua/vim/`), thus not available with `nvim -u NONE`. \r\n    - This is for \"nice to have, but non-essential\" features. E.g. the `inspect` and `lpeg` modules live here.\r\n2. Compiled-into `nvim` itself (`src/nvim/lua/`).\r\n    - **Guideline:** \"If there's doubt, put it in the runtime\".","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/660","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/660/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/660/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/660/events","html_url":"https://github.com/leafo/lapis/issues/660","id":407755904,"node_id":"MDU6SXNzdWU0MDc3NTU5MDQ=","number":660,"title":"Model relations should have option for multiple values in where clause","user":{"login":"karai17","id":590332,"node_id":"MDQ6VXNlcjU5MDMzMg==","avatar_url":"https://avatars3.githubusercontent.com/u/590332?v=4","gravatar_id":"","url":"https://api.github.com/users/karai17","html_url":"https://github.com/karai17","followers_url":"https://api.github.com/users/karai17/followers","following_url":"https://api.github.com/users/karai17/following{/other_user}","gists_url":"https://api.github.com/users/karai17/gists{/gist_id}","starred_url":"https://api.github.com/users/karai17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karai17/subscriptions","organizations_url":"https://api.github.com/users/karai17/orgs","repos_url":"https://api.github.com/users/karai17/repos","events_url":"https://api.github.com/users/karai17/events{/privacy}","received_events_url":"https://api.github.com/users/karai17/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-02-07T15:28:36Z","updated_at":"2019-02-07T18:44:23Z","closed_at":"2019-02-07T18:44:23Z","author_association":"NONE","active_lock_reason":null,"body":"https://github.com/leafo/lapis/blob/master/lapis/db/model/relations.moon#L226\r\nhttps://github.com/leafo/lapis/blob/master/lapis/db/model/relations.moon#L281\r\n\r\nGiven the following code, I believe the above linked code should check if `v` is a table.\r\n\r\n```lua\r\nlocal Seasons = Model:extend(\"seasons\", {\r\n\trelations = {\r\n\t\t{ \"events_all\",    has_many = \"Events\", where = { status = {0, 1} }},\r\n\t\t{ \"events_active\", has_many = \"Events\", where = { status = 1 }}\r\n\t}\r\n})\r\n```\r\n\r\n```sql\r\nSELECT * FROM events WHERE (\"status\" = 0 OR \"status\" = 1);\r\nSELECT * FROM events WHERE \"status\" = 1;\r\n```","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/Kong/kong-plugin-prometheus/issues/38","repository_url":"https://api.github.com/repos/Kong/kong-plugin-prometheus","labels_url":"https://api.github.com/repos/Kong/kong-plugin-prometheus/issues/38/labels{/name}","comments_url":"https://api.github.com/repos/Kong/kong-plugin-prometheus/issues/38/comments","events_url":"https://api.github.com/repos/Kong/kong-plugin-prometheus/issues/38/events","html_url":"https://github.com/Kong/kong-plugin-prometheus/issues/38","id":398095614,"node_id":"MDU6SXNzdWUzOTgwOTU2MTQ=","number":38,"title":"Extra HTML tags added to prometheus /metrics","user":{"login":"dcherniv","id":19437418,"node_id":"MDQ6VXNlcjE5NDM3NDE4","avatar_url":"https://avatars3.githubusercontent.com/u/19437418?v=4","gravatar_id":"","url":"https://api.github.com/users/dcherniv","html_url":"https://github.com/dcherniv","followers_url":"https://api.github.com/users/dcherniv/followers","following_url":"https://api.github.com/users/dcherniv/following{/other_user}","gists_url":"https://api.github.com/users/dcherniv/gists{/gist_id}","starred_url":"https://api.github.com/users/dcherniv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dcherniv/subscriptions","organizations_url":"https://api.github.com/users/dcherniv/orgs","repos_url":"https://api.github.com/users/dcherniv/repos","events_url":"https://api.github.com/users/dcherniv/events{/privacy}","received_events_url":"https://api.github.com/users/dcherniv/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-01-11T01:49:22Z","updated_at":"2019-01-11T16:43:20Z","closed_at":"2019-01-11T16:43:19Z","author_association":"NONE","active_lock_reason":null,"body":"When curling /metrics page, it seems prometheus plugin outputs some extra HTML tag that prometheus scraper doesn't like.\r\n\r\n```\r\n curl localhost:10254/metrics\r\n[...]\r\n<!DOCTYPE HTML><html lang=\"en\"><head><title>Lapis Page</title></head><body></body></html>\r\n\r\n/tmp/prometheus-2.6.0.linux-amd64 # curl -s http://localhost:10254/metrics/ | tee out | ./promtool check metrics \r\nerror while linting: text format parsing error in line 306: invalid metric name\r\n/tmp/prometheus-2.6.0.linux-amd64 # head -n 306 out |tail -n1\r\n<!DOCTYPE HTML><html lang=\"en\"><head><title>Lapis Page</title></head><body></body></html>/tmp/prometheus-2.6.0.linux-amd64 # \r\n```\r\nCould this be related https://github.com/leafo/lapis/issues/440\r\n\r\nAs a result of this the prometheus plugin is not parsing any metrics at all.\r\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/snap-cloud/snapCloud/issues/202","repository_url":"https://api.github.com/repos/snap-cloud/snapCloud","labels_url":"https://api.github.com/repos/snap-cloud/snapCloud/issues/202/labels{/name}","comments_url":"https://api.github.com/repos/snap-cloud/snapCloud/issues/202/comments","events_url":"https://api.github.com/repos/snap-cloud/snapCloud/issues/202/events","html_url":"https://github.com/snap-cloud/snapCloud/issues/202","id":405188948,"node_id":"MDU6SXNzdWU0MDUxODg5NDg=","number":202,"title":"Don't query anything for OPTIONS requests","user":{"login":"cycomachead","id":1505907,"node_id":"MDQ6VXNlcjE1MDU5MDc=","avatar_url":"https://avatars0.githubusercontent.com/u/1505907?v=4","gravatar_id":"","url":"https://api.github.com/users/cycomachead","html_url":"https://github.com/cycomachead","followers_url":"https://api.github.com/users/cycomachead/followers","following_url":"https://api.github.com/users/cycomachead/following{/other_user}","gists_url":"https://api.github.com/users/cycomachead/gists{/gist_id}","starred_url":"https://api.github.com/users/cycomachead/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cycomachead/subscriptions","organizations_url":"https://api.github.com/users/cycomachead/orgs","repos_url":"https://api.github.com/users/cycomachead/repos","events_url":"https://api.github.com/users/cycomachead/events{/privacy}","received_events_url":"https://api.github.com/users/cycomachead/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-01-31T10:56:06Z","updated_at":"2019-02-05T18:57:16Z","closed_at":"2019-02-05T11:34:21Z","author_association":"MEMBER","active_lock_reason":null,"body":"If the method type is OPTIONS we shouldn't execute the before filter.\r\n\r\nOPTIONS never need to query any data just handle the CORS issues.","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/streak.club/issues/53","repository_url":"https://api.github.com/repos/leafo/streak.club","labels_url":"https://api.github.com/repos/leafo/streak.club/issues/53/labels{/name}","comments_url":"https://api.github.com/repos/leafo/streak.club/issues/53/comments","events_url":"https://api.github.com/repos/leafo/streak.club/issues/53/events","html_url":"https://github.com/leafo/streak.club/issues/53","id":384993672,"node_id":"MDU6SXNzdWUzODQ5OTM2NzI=","number":53,"title":"Cannot display personal Website on profile page unless a Twitter handle is included.","user":{"login":"kevinfiol","id":4752973,"node_id":"MDQ6VXNlcjQ3NTI5NzM=","avatar_url":"https://avatars1.githubusercontent.com/u/4752973?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinfiol","html_url":"https://github.com/kevinfiol","followers_url":"https://api.github.com/users/kevinfiol/followers","following_url":"https://api.github.com/users/kevinfiol/following{/other_user}","gists_url":"https://api.github.com/users/kevinfiol/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinfiol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinfiol/subscriptions","organizations_url":"https://api.github.com/users/kevinfiol/orgs","repos_url":"https://api.github.com/users/kevinfiol/repos","events_url":"https://api.github.com/users/kevinfiol/events{/privacy}","received_events_url":"https://api.github.com/users/kevinfiol/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-11-27T21:28:13Z","updated_at":"2019-01-11T21:02:43Z","closed_at":"2019-01-10T22:09:45Z","author_association":"NONE","active_lock_reason":null,"body":"Title is somewhat self-explanatory.\r\n\r\nUnsure if this is a verification measure or not, but as it stands, it is somewhat frustrating to those users who choose not to use Twitter (I use Mastodon instead, for example).\r\n\r\nScreenshots:\r\n![capture](https://user-images.githubusercontent.com/4752973/49112677-6a104200-f261-11e8-9718-0d6c78270b53.PNG)\r\n![capture2](https://user-images.githubusercontent.com/4752973/49112680-6d0b3280-f261-11e8-9ec8-b381ac0d2b70.PNG)\r\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/644","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/644/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/644/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/644/events","html_url":"https://github.com/leafo/lapis/issues/644","id":377167099,"node_id":"MDU6SXNzdWUzNzcxNjcwOTk=","number":644,"title":"Should lapis validation support coercion?","user":{"login":"italomaia","id":14670,"node_id":"MDQ6VXNlcjE0Njcw","avatar_url":"https://avatars1.githubusercontent.com/u/14670?v=4","gravatar_id":"","url":"https://api.github.com/users/italomaia","html_url":"https://github.com/italomaia","followers_url":"https://api.github.com/users/italomaia/followers","following_url":"https://api.github.com/users/italomaia/following{/other_user}","gists_url":"https://api.github.com/users/italomaia/gists{/gist_id}","starred_url":"https://api.github.com/users/italomaia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/italomaia/subscriptions","organizations_url":"https://api.github.com/users/italomaia/orgs","repos_url":"https://api.github.com/users/italomaia/repos","events_url":"https://api.github.com/users/italomaia/events{/privacy}","received_events_url":"https://api.github.com/users/italomaia/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-11-04T16:05:51Z","updated_at":"2019-01-26T02:03:44Z","closed_at":"2019-01-26T02:03:15Z","author_association":"NONE","active_lock_reason":null,"body":"Input validation allows you to make sure the data you're getting is within the range of values that you expect, but what about its type?\r\n\r\nDoes it make sense to test if some input is an integer, but still get it as a string? I would like to suggest the built-in capability of being able to coerce param values that are valid. It could probably save some trouble to a lot of people along the way. ","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/515","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/515/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/515/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/515/events","html_url":"https://github.com/leafo/lapis/issues/515","id":203286319,"node_id":"MDU6SXNzdWUyMDMyODYzMTk=","number":515,"title":"Is there a way to stop @build_url and @url_for from including port number when generating URLs?","user":{"login":"TangentFoxy","id":15093567,"node_id":"MDQ6VXNlcjE1MDkzNTY3","avatar_url":"https://avatars3.githubusercontent.com/u/15093567?v=4","gravatar_id":"","url":"https://api.github.com/users/TangentFoxy","html_url":"https://github.com/TangentFoxy","followers_url":"https://api.github.com/users/TangentFoxy/followers","following_url":"https://api.github.com/users/TangentFoxy/following{/other_user}","gists_url":"https://api.github.com/users/TangentFoxy/gists{/gist_id}","starred_url":"https://api.github.com/users/TangentFoxy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TangentFoxy/subscriptions","organizations_url":"https://api.github.com/users/TangentFoxy/orgs","repos_url":"https://api.github.com/users/TangentFoxy/repos","events_url":"https://api.github.com/users/TangentFoxy/events{/privacy}","received_events_url":"https://api.github.com/users/TangentFoxy/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2017-01-26T03:41:45Z","updated_at":"2018-07-25T03:56:36Z","closed_at":"2017-02-08T00:33:08Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I run my Lapis server(s) on a non-standard port with an instance of NGINX proxying requests based on domain name. I would prefer URLs to only use the domain name, without port number.\r\n\r\n(On a related note, I would like to block the port from being accessible other than through the proxy, but I know that's outside of the scope of this project. Something I need to learn how to do with iptables I'm guessing.)\r\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/heroku-lapis-example/issues/1","repository_url":"https://api.github.com/repos/leafo/heroku-lapis-example","labels_url":"https://api.github.com/repos/leafo/heroku-lapis-example/issues/1/labels{/name}","comments_url":"https://api.github.com/repos/leafo/heroku-lapis-example/issues/1/comments","events_url":"https://api.github.com/repos/leafo/heroku-lapis-example/issues/1/events","html_url":"https://github.com/leafo/heroku-lapis-example/issues/1","id":115574734,"node_id":"MDU6SXNzdWUxMTU1NzQ3MzQ=","number":1,"title":"trying to deploy your example","user":{"login":"mathieujobin","id":99191,"node_id":"MDQ6VXNlcjk5MTkx","avatar_url":"https://avatars2.githubusercontent.com/u/99191?v=4","gravatar_id":"","url":"https://api.github.com/users/mathieujobin","html_url":"https://github.com/mathieujobin","followers_url":"https://api.github.com/users/mathieujobin/followers","following_url":"https://api.github.com/users/mathieujobin/following{/other_user}","gists_url":"https://api.github.com/users/mathieujobin/gists{/gist_id}","starred_url":"https://api.github.com/users/mathieujobin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mathieujobin/subscriptions","organizations_url":"https://api.github.com/users/mathieujobin/orgs","repos_url":"https://api.github.com/users/mathieujobin/repos","events_url":"https://api.github.com/users/mathieujobin/events{/privacy}","received_events_url":"https://api.github.com/users/mathieujobin/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2015-11-06T19:49:20Z","updated_at":"2018-04-23T08:49:45Z","closed_at":"2018-04-23T08:49:45Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\n\nis this example suppose to work out of the box?\n\nI just tried a simple clone and to push it to a new application container on heroku but it fails to detect the app\n\n```\n[mathieu@hz550 heroku-lapis-example]$ git push heroku \nCounting objects: 32, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (16/16), done.\nWriting objects: 100% (32/32), 4.77 KiB | 0 bytes/s, done.\nTotal 32 (delta 12), reused 32 (delta 12)\nremote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: \nremote:  !     Push rejected, no Cedar-supported app detected\nremote: HINT: This occurs when Heroku cannot detect the buildpack\nremote:       to use for this application automatically.\nremote: See https://devcenter.heroku.com/articles/buildpacks\nremote: \nremote: Verifying deploy...\nremote: \nremote: !       Push rejected to heroku-lapis-example.\nremote: \nTo https://git.heroku.com/heroku-lapis-example.git\n ! [remote rejected] master -> master (pre-receive hook declined)\nerror: failed to push some refs to 'https://git.heroku.com/heroku-lapis-example.git'\n```\n\na little bit more documentation would be appreciated\n\nthanks for pointing me out in the right direction.\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/395","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/395/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/395/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/395/events","html_url":"https://github.com/leafo/lapis/issues/395","id":131371831,"node_id":"MDU6SXNzdWUxMzEzNzE4MzE=","number":395,"title":"Param arrays do not work correctly","user":{"login":"qaisjp","id":923242,"node_id":"MDQ6VXNlcjkyMzI0Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/923242?v=4","gravatar_id":"","url":"https://api.github.com/users/qaisjp","html_url":"https://github.com/qaisjp","followers_url":"https://api.github.com/users/qaisjp/followers","following_url":"https://api.github.com/users/qaisjp/following{/other_user}","gists_url":"https://api.github.com/users/qaisjp/gists{/gist_id}","starred_url":"https://api.github.com/users/qaisjp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qaisjp/subscriptions","organizations_url":"https://api.github.com/users/qaisjp/orgs","repos_url":"https://api.github.com/users/qaisjp/repos","events_url":"https://api.github.com/users/qaisjp/events{/privacy}","received_events_url":"https://api.github.com/users/qaisjp/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2016-02-04T14:55:45Z","updated_at":"2018-06-26T02:52:55Z","closed_at":"2016-02-04T18:04:11Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Say you have a bunch of checkboxes like:\n\n``` moon\ninput type: \"checkbox\", name: \"myarray[]\", value: \"testvalue1\"\ninput type: \"checkbox\", name: \"myarray[]\", value: \"testvalue2\"\ninput type: \"checkbox\", name: \"myarray[]\", value: \"testvalue3\"\n```\n\nNote that between `[` and `]` there \"is an empty string\": `\"\"`. This creates an array like:\n\n``` moon\n@params.myarray = {\n    [\"\"]: \"testvalue3\"\n}\n```\n\nHowever, with this code:\n\n``` moon\ninput type: \"checkbox\", name: \"myarray[1]\", value: \"testvalue1\"\ninput type: \"checkbox\", name: \"myarray[2]\", value: \"testvalue2\"\ninput type: \"checkbox\", name: \"myarray[3]\", value: \"testvalue3\"\n```\n\nYou get this:\n\n``` moon\n@params.myarray = {\n    [\"1\"]: \"testvalue1\"\n    [\"2\"]: \"testvalue2\"\n    [\"3\"]: \"testvalue3\"\n}\n```\n\nThe first lapis html builder snippet should output the same as the second snippet, except with the keys being numbers (and not strings).\n\nWhere is the code for this?\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/6","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/6/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/6/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/6/events","html_url":"https://github.com/leafo/lapis/issues/6","id":13730965,"node_id":"MDU6SXNzdWUxMzczMDk2NQ==","number":6,"title":"Possible Dependency Issues?","user":{"login":"RickCarlino","id":1388608,"node_id":"MDQ6VXNlcjEzODg2MDg=","avatar_url":"https://avatars2.githubusercontent.com/u/1388608?v=4","gravatar_id":"","url":"https://api.github.com/users/RickCarlino","html_url":"https://github.com/RickCarlino","followers_url":"https://api.github.com/users/RickCarlino/followers","following_url":"https://api.github.com/users/RickCarlino/following{/other_user}","gists_url":"https://api.github.com/users/RickCarlino/gists{/gist_id}","starred_url":"https://api.github.com/users/RickCarlino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RickCarlino/subscriptions","organizations_url":"https://api.github.com/users/RickCarlino/orgs","repos_url":"https://api.github.com/users/RickCarlino/repos","events_url":"https://api.github.com/users/RickCarlino/events{/privacy}","received_events_url":"https://api.github.com/users/RickCarlino/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2013-04-28T06:56:12Z","updated_at":"2018-04-24T13:34:24Z","closed_at":"2013-04-28T16:38:39Z","author_association":"NONE","active_lock_reason":null,"body":"I did a fresh install of Lua, Moonscript and Lapis on a new box running Linux and got errors when I first attempted to run 'lua help'. The first errors were fixed by installing lua-cjson and the second was fixed after I installed the lpeg luarock. This is the current error I get:\n\nmoon: /usr/local/share/lua/5.1/lapis/util/encoding.lua:20: module 'crypto' not found:No LuaRocks module found for crypto\n        no field package.preload['crypto']\n        no file '/usr/local/share/lua/5.1/crypto.lua'\n        no file '/usr/local/share/lua/5.1/crypto/init.lua'\n        no file '/home/rick/.luarocks/share/lua/5.1/crypto.lua'\n        no file '/home/rick/.luarocks/share/lua/5.1/crypto/init.lua'\n        no file '/usr/local/share/lua/5.2/crypto.lua'\n        no file '/usr/local/share/lua/5.2/crypto/init.lua'\n        no file '/home/rick/.luarocks/share/lua/5.2/crypto.lua'\n        no file '/home/rick/.luarocks/share/lua/5.2/crypto/init.lua'\n        no file '/usr/local/share/lua/5.2//crypto.lua'\n        no file '/usr/local/share/lua/5.2//crypto/init.lua'\n        no file '/usr/local/share/lua/5.2/crypto.lua'\n        no file '/usr/local/share/lua/5.2/crypto/init.lua'\n        no file '/usr/local/lib/lua/5.2/crypto.lua'\n        no file '/usr/local/lib/lua/5.2/crypto/init.lua'\n        no file './crypto.lua'\n        no file '/usr/local/lib/lua/5.1/crypto.so'\n        no file '/home/rick/.luarocks/lib/lua/5.1/crypto.so'\n        no file '/usr/local/lib/lua/5.2/crypto.so'\n        no file '/home/rick/.luarocks/lib/lua/5.2/crypto.so'\n        no file '/usr/local/lib/lua/5.2/crypto.so'\n        no file '/usr/local/lib/lua/5.2/loadall.so'\n        no file './crypto.so'\nstack traceback:\n        [C]: in function 'require'\n        /usr/local/share/lua/5.1/lapis/util/encoding.lua:20: in main chunk\n        [C]: in function 'require'\n        /usr/local/share/lua/5.1/lapis/session.lua:4: in main chunk\n        [C]: in function 'require'\n        /usr/local/share/lua/5.1/lapis/application.lua:3: in main chunk\n        [C]: in function 'require'\n        /usr/local/share/lua/5.1/lapis/init.lua:2: in main chunk\n        [C]: in function 'require'\n        web.moon:1(1): in main chunk\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/586","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/586/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/586/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/586/events","html_url":"https://github.com/leafo/lapis/issues/586","id":279052417,"node_id":"MDU6SXNzdWUyNzkwNTI0MTc=","number":586,"title":"failed to find model `model` for relation","user":{"login":"maxbertinetti","id":26814295,"node_id":"MDQ6VXNlcjI2ODE0Mjk1","avatar_url":"https://avatars0.githubusercontent.com/u/26814295?v=4","gravatar_id":"","url":"https://api.github.com/users/maxbertinetti","html_url":"https://github.com/maxbertinetti","followers_url":"https://api.github.com/users/maxbertinetti/followers","following_url":"https://api.github.com/users/maxbertinetti/following{/other_user}","gists_url":"https://api.github.com/users/maxbertinetti/gists{/gist_id}","starred_url":"https://api.github.com/users/maxbertinetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxbertinetti/subscriptions","organizations_url":"https://api.github.com/users/maxbertinetti/orgs","repos_url":"https://api.github.com/users/maxbertinetti/repos","events_url":"https://api.github.com/users/maxbertinetti/events{/privacy}","received_events_url":"https://api.github.com/users/maxbertinetti/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2017-12-04T16:11:21Z","updated_at":"2018-04-06T20:09:49Z","closed_at":"2017-12-05T07:27:02Z","author_association":"NONE","active_lock_reason":null,"body":"failed to find model `Golfclubs` for relation\r\n\r\nThis is my models.lua:\r\n```lua\r\nlocal autoload = require(\"lapis.util\").autoload\r\nreturn autoload(\"models\")\r\n```\r\n\r\nThis are the relations:\r\n```lua\r\nlocal Model = require(\"lapis.db.model\").Model\r\nlocal Golfclubs = Model:extend(\"golfclubs\", {\r\n  relations = {\r\n    {\"coupons\", has_many = \"Coupons\"}\r\n  }\r\n})\r\nlocal Coupons = Model:extend(\"coupons\", {\r\n  relations = {\r\n    {\"golfclub\", belongs_to = \"Golfclubs\"}\r\n  }\r\n})\r\n```\r\n\r\nThis are the migrations:\r\n```lua\r\n    schema.create_table(\"golfclubs\", {\r\n      { \"id\", types.serial },\r\n      { \"name\", types.text },\r\n      { \"logo\", types.text({ null = true }) },\r\n      { \"description\", types.text },\r\n      { \"image\", types.text({ null = true }) },\r\n      { \"address\", types.text },\r\n      { \"latitude\", types.text({ null = true }) },\r\n      { \"longitude\", types.text({ null = true }) },\r\n      { \"phone\", types.text({ null = true }) },\r\n      { \"email\", types.text({ null = true }) },\r\n\r\n      \"PRIMARY KEY (id)\"\r\n    })\r\n\r\n    schema.create_table(\"coupons\", {\r\n      { \"id\", types.serial },\r\n      { \"name\", types.text },\r\n      { \"description\", types.text },\r\n      { \"condition\", types.text },\r\n      { \"quantity\", types.integer({ default = 1}) },\r\n      { \"golfclub_id\", types.foreign_key },\r\n\r\n      \"PRIMARY KEY (id)\"\r\n    })\r\n```\r\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/539","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/539/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/539/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/539/events","html_url":"https://github.com/leafo/lapis/issues/539","id":224246395,"node_id":"MDU6SXNzdWUyMjQyNDYzOTU=","number":539,"title":"Lapis cjson dependency breaks on openresty-1.11.2.3","user":{"login":"nelson2005","id":189607,"node_id":"MDQ6VXNlcjE4OTYwNw==","avatar_url":"https://avatars0.githubusercontent.com/u/189607?v=4","gravatar_id":"","url":"https://api.github.com/users/nelson2005","html_url":"https://github.com/nelson2005","followers_url":"https://api.github.com/users/nelson2005/followers","following_url":"https://api.github.com/users/nelson2005/following{/other_user}","gists_url":"https://api.github.com/users/nelson2005/gists{/gist_id}","starred_url":"https://api.github.com/users/nelson2005/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nelson2005/subscriptions","organizations_url":"https://api.github.com/users/nelson2005/orgs","repos_url":"https://api.github.com/users/nelson2005/repos","events_url":"https://api.github.com/users/nelson2005/events{/privacy}","received_events_url":"https://api.github.com/users/nelson2005/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":17,"created_at":"2017-04-25T19:26:45Z","updated_at":"2018-04-02T22:59:31Z","closed_at":"2018-04-02T22:59:31Z","author_association":"NONE","active_lock_reason":null,"body":"Lapis has a dependency on cjson, which seems not to be actively maintained.  Openresty comes bundled with a maintained version of cjson-  https://github.com/openresty/lua-cjson\r\n\r\nThe luarocks version of cjson doesn't work with the newest openresty- would it be possible to use the already-bundled cjson to fulfill the dependency, and not include the luarocks version?  I think this issue will affect anyone installing the openresty 1.11.2.3 and later.\r\n\r\nI've attached my luarocks log file below.\r\n\r\nThanks\r\n\r\n[luarocks.txt](https://github.com/leafo/lapis/files/956277/luarocks.txt)\r\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/549","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/549/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/549/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/549/events","html_url":"https://github.com/leafo/lapis/issues/549","id":235912346,"node_id":"MDU6SXNzdWUyMzU5MTIzNDY=","number":549,"title":"module 'app' not found","user":{"login":"tpimh","id":1071872,"node_id":"MDQ6VXNlcjEwNzE4NzI=","avatar_url":"https://avatars3.githubusercontent.com/u/1071872?v=4","gravatar_id":"","url":"https://api.github.com/users/tpimh","html_url":"https://github.com/tpimh","followers_url":"https://api.github.com/users/tpimh/followers","following_url":"https://api.github.com/users/tpimh/following{/other_user}","gists_url":"https://api.github.com/users/tpimh/gists{/gist_id}","starred_url":"https://api.github.com/users/tpimh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tpimh/subscriptions","organizations_url":"https://api.github.com/users/tpimh/orgs","repos_url":"https://api.github.com/users/tpimh/repos","events_url":"https://api.github.com/users/tpimh/events{/privacy}","received_events_url":"https://api.github.com/users/tpimh/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2017-06-14T15:07:42Z","updated_at":"2018-03-16T11:47:08Z","closed_at":"2018-02-22T20:07:44Z","author_association":"NONE","active_lock_reason":null,"body":"I installed openresty and lapis on Alpine Linux, and it creates new project and starts server without errors:\r\n\r\n    resty:~# /usr/local/openresty/luajit/bin/lapis new --lua\r\n    wrote\tnginx.conf\r\n    wrote\tmime.types\r\n    wrote\tapp.lua\r\n    wrote\tmodels.lua\r\n    resty:~# /usr/local/openresty/luajit/bin/lapis server\r\n    nginx: [alert] lua_code_cache is off; this will hurt performance in /root/nginx.conf.compiled:16\r\n    2017/06/14 18:01:50 [notice] 22961#22961: using the \"epoll\" event method\r\n    2017/06/14 18:01:50 [notice] 22961#22961: openresty/1.11.2.3\r\n    2017/06/14 18:01:50 [notice] 22961#22961: built by gcc 6.3.0 (Alpine 6.3.0) \r\n    2017/06/14 18:01:50 [notice] 22961#22961: OS: Linux 4.9.30-0-virthardened\r\n    2017/06/14 18:01:50 [notice] 22961#22961: getrlimit(RLIMIT_NOFILE): 1024:4096\r\n    2017/06/14 18:01:50 [notice] 22961#22961: start worker processes\r\n    2017/06/14 18:01:50 [notice] 22961#22961: start worker process 22962\r\n\r\nBut if I try to access the server, it can not find `app.lua` (the file is actually in my current directory):\r\n\r\n    2017/06/14 18:05:01 [error] 22962#22962: *1 lua entry thread aborted: runtime error: /usr/local/openresty/luajit/share/lua/5.1/lapis/init.lua:15: module 'app' not found:\r\n\t    no field package.preload['app']\r\n\t    no file '/usr/local/openresty/site/lualib/app.lua'\r\n\t    no file '/usr/local/openresty/site/lualib/app/init.lua'\r\n\t    no file '/usr/local/openresty/lualib/app.lua'\r\n\t    no file '/usr/local/openresty/lualib/app/init.lua'\r\n\t    no file './app.lua'\r\n\t    no file '/usr/local/openresty/luajit/share/luajit-2.1.0-beta2/app.lua'\r\n\t    no file '/usr/local/share/lua/5.1/app.lua'\r\n\t    no file '/usr/local/share/lua/5.1/app/init.lua'\r\n\t    no file '/usr/local/openresty/luajit/share/lua/5.1/app.lua'\r\n\t    no file '/usr/local/openresty/luajit/share/lua/5.1/app/init.lua'\r\n\t    no file '/usr/local/openresty/site/lualib/app.so'\r\n\t    no file '/usr/local/openresty/lualib/app.so'\r\n\t    no file './app.so'\r\n\t    no file '/usr/local/lib/lua/5.1/app.so'\r\n\t    no file '/usr/local/openresty/luajit/lib/lua/5.1/app.so'\r\n\t    no file '/usr/local/lib/lua/5.1/loadall.so'\r\n    stack traceback:\r\n    coroutine 0:\r\n\t    [C]: in function 'require'\r\n\t    /usr/local/openresty/luajit/share/lua/5.1/lapis/init.lua:15: in function 'serve'\r\n\t    content_by_lua(nginx.conf.compiled:22):2: in function <content_by_lua(nginx.conf.compiled:22):1>, client: 192.168.122.1, server: , request: \"GET / HTTP/1.1\", host: \"192.168.122.223:8080\"\r\n\r\nWhat may be causing this?","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/219","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/219/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/219/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/219/events","html_url":"https://github.com/leafo/lapis/issues/219","id":51729891,"node_id":"MDU6SXNzdWU1MTcyOTg5MQ==","number":219,"title":"CSRF protection should provide a key by default","user":{"login":"starius","id":920155,"node_id":"MDQ6VXNlcjkyMDE1NQ==","avatar_url":"https://avatars0.githubusercontent.com/u/920155?v=4","gravatar_id":"","url":"https://api.github.com/users/starius","html_url":"https://github.com/starius","followers_url":"https://api.github.com/users/starius/followers","following_url":"https://api.github.com/users/starius/following{/other_user}","gists_url":"https://api.github.com/users/starius/gists{/gist_id}","starred_url":"https://api.github.com/users/starius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/starius/subscriptions","organizations_url":"https://api.github.com/users/starius/orgs","repos_url":"https://api.github.com/users/starius/repos","events_url":"https://api.github.com/users/starius/events{/privacy}","received_events_url":"https://api.github.com/users/starius/received_events","type":"User","site_admin":false},"labels":[{"id":161073604,"node_id":"MDU6TGFiZWwxNjEwNzM2MDQ=","url":"https://api.github.com/repos/leafo/lapis/labels/Bug","name":"Bug","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2014-12-11T19:52:19Z","updated_at":"2018-02-22T07:13:55Z","closed_at":"2018-02-22T07:13:55Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"... at least if argument key is nil.\n\nAn attacker can get value of CSRF token from his own session and reuse this value on fraudulent requests that originate from attacking sites.\n\nCSRF token must not be valid if being used from another session. To make sure my Lapis app is vulnerable, I have started two independent sessions from different browsers, copy value of CSRF token from one browser to another and it was accepted! Looking through csrf.lua I understood that CSRF token is not bound to a session, nothing prevents from reusing a CSRF token from another session.\n\nI know the following workaround: generate a random token, save it to req.session (or cookie) and use as key for CSRF functions of Lapis. In this case each session has unique key, so CSRF token can not be reused across sessions. Am I right? If yes, this behavior should be implemented by Lapis itself.\n","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/snap-cloud/snapCloud/issues/3","repository_url":"https://api.github.com/repos/snap-cloud/snapCloud","labels_url":"https://api.github.com/repos/snap-cloud/snapCloud/issues/3/labels{/name}","comments_url":"https://api.github.com/repos/snap-cloud/snapCloud/issues/3/comments","events_url":"https://api.github.com/repos/snap-cloud/snapCloud/issues/3/events","html_url":"https://github.com/snap-cloud/snapCloud/issues/3","id":291175821,"node_id":"MDU6SXNzdWUyOTExNzU4MjE=","number":3,"title":"mail system","user":{"login":"bromagosa","id":1016697,"node_id":"MDQ6VXNlcjEwMTY2OTc=","avatar_url":"https://avatars1.githubusercontent.com/u/1016697?v=4","gravatar_id":"","url":"https://api.github.com/users/bromagosa","html_url":"https://github.com/bromagosa","followers_url":"https://api.github.com/users/bromagosa/followers","following_url":"https://api.github.com/users/bromagosa/following{/other_user}","gists_url":"https://api.github.com/users/bromagosa/gists{/gist_id}","starred_url":"https://api.github.com/users/bromagosa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bromagosa/subscriptions","organizations_url":"https://api.github.com/users/bromagosa/orgs","repos_url":"https://api.github.com/users/bromagosa/repos","events_url":"https://api.github.com/users/bromagosa/events{/privacy}","received_events_url":"https://api.github.com/users/bromagosa/received_events","type":"User","site_admin":false},"labels":[{"id":815017618,"node_id":"MDU6TGFiZWw4MTUwMTc2MTg=","url":"https://api.github.com/repos/snap-cloud/snapCloud/labels/needs%20external%20service","name":"needs external service","color":"bfac00","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-01-24T11:32:41Z","updated_at":"2018-02-09T11:14:25Z","closed_at":"2018-02-09T11:14:25Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/580","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/580/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/580/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/580/events","html_url":"https://github.com/leafo/lapis/issues/580","id":277825912,"node_id":"MDU6SXNzdWUyNzc4MjU5MTI=","number":580,"title":"Detach lapis models from lapis?","user":{"login":"italomaia","id":14670,"node_id":"MDQ6VXNlcjE0Njcw","avatar_url":"https://avatars1.githubusercontent.com/u/14670?v=4","gravatar_id":"","url":"https://api.github.com/users/italomaia","html_url":"https://github.com/italomaia","followers_url":"https://api.github.com/users/italomaia/followers","following_url":"https://api.github.com/users/italomaia/following{/other_user}","gists_url":"https://api.github.com/users/italomaia/gists{/gist_id}","starred_url":"https://api.github.com/users/italomaia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/italomaia/subscriptions","organizations_url":"https://api.github.com/users/italomaia/orgs","repos_url":"https://api.github.com/users/italomaia/repos","events_url":"https://api.github.com/users/italomaia/events{/privacy}","received_events_url":"https://api.github.com/users/italomaia/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2017-11-29T16:45:11Z","updated_at":"2018-02-25T14:10:59Z","closed_at":"2017-12-08T22:45:17Z","author_association":"NONE","active_lock_reason":null,"body":"Would it be reasonable to have Lapis ORM as a package independent from lapis? As there are few ORMs for Lua, maybe that would be helpful. ","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/599","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/599/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/599/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/599/events","html_url":"https://github.com/leafo/lapis/issues/599","id":287936271,"node_id":"MDU6SXNzdWUyODc5MzYyNzE=","number":599,"title":"Lua: Invalid require when using models","user":{"login":"karai17","id":590332,"node_id":"MDQ6VXNlcjU5MDMzMg==","avatar_url":"https://avatars3.githubusercontent.com/u/590332?v=4","gravatar_id":"","url":"https://api.github.com/users/karai17","html_url":"https://github.com/karai17","followers_url":"https://api.github.com/users/karai17/followers","following_url":"https://api.github.com/users/karai17/following{/other_user}","gists_url":"https://api.github.com/users/karai17/gists{/gist_id}","starred_url":"https://api.github.com/users/karai17/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karai17/subscriptions","organizations_url":"https://api.github.com/users/karai17/orgs","repos_url":"https://api.github.com/users/karai17/repos","events_url":"https://api.github.com/users/karai17/events{/privacy}","received_events_url":"https://api.github.com/users/karai17/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-01-11T21:50:54Z","updated_at":"2018-01-17T20:34:36Z","closed_at":"2018-01-17T20:34:36Z","author_association":"NONE","active_lock_reason":null,"body":"https://github.com/leafo/lapis/blob/master/lapis/db/base_model.lua#L218\r\n\r\n```\r\nError\r\n/usr/share/lua/5.1/lapis/db/base_model.lua:218: module 'models' not found:\r\n\tno field package.preload['models']\r\n\tno file '/root/.luarocks/share/lua/5.1/models.lua'\r\n\tno file '/root/.luarocks/share/lua/5.1/models/init.lua'\r\n\tno file '/usr/share/lua/5.1/models.lua'\r\n\tno file '/usr/share/lua/5.1/models/init.lua'\r\n\tno file './models.lua'\r\n\tno file '/usr/share/luajit-2.0.4/models.lua'\r\n\tno file '/usr/local/share/lua/5.1/models.lua'\r\n\tno file '/usr/local/share/lua/5.1/models/init.lua'\r\n\tno file '/usr/local/openresty/lualib/models.lua'\r\n\tno file './src/models.lua'\r\n\tno file './src/models/init.lua'\r\n\tno file '/root/.luarocks/lib/lua/5.1/models.so'\r\n\tno file '/usr/lib/lua/5.1/models.so'\r\n\tno file './models.so'\r\n\tno file '/usr/local/lib/lua/5.1/models.so'\r\n\tno file '/usr/lib64/lua/5.1/models.so'\r\n\tno file '/usr/local/lib/lua/5.1/loadall.so'\r\nTraceback\r\nstack traceback:\r\n\t[C]: in function 'require'\r\n\t/usr/share/lua/5.1/lapis/db/base_model.lua:218: in function 'get_relation_model'\r\n\t/usr/share/lua/5.1/lapis/db/model/relations.lua:9: in function 'assert_model'\r\n\t/usr/share/lua/5.1/lapis/db/model/relations.lua:384: in function 'get_players'\r\n\t./src/controllers/players.lua:28: in function 'handler'\r\n\t/usr/share/lua/5.1/lapis/application.lua:130: in function 'resolve'\r\n\t/usr/share/lua/5.1/lapis/application.lua:161: in function </usr/share/lua/5.1/lapis/application.lua:159>\r\n\t[C]: in function 'xpcall'\r\n\t/usr/share/lua/5.1/lapis/application.lua:159: in function 'dispatch'\r\n\t/usr/share/lua/5.1/lapis/nginx.lua:215: in function 'serve'\r\n\tcontent_by_lua(nginx.conf.compiled:28):1: in function <content_by_lua(nginx.conf.compiled:28):1>\r\n```\r\n\r\n```lua\r\n-- Users model\r\nlocal db    = require(\"lapis.db\")\r\nlocal Model = require(\"lapis.db.model\").Model\r\nlocal Users = Model:extend(\"users\", {\r\n\trelations = {\r\n\t\t{ \"players\", has_many = \"Players\" }\r\n\t}\r\n})\r\n\r\n--- Get data from an existing User\r\n-- @tparam string username Username of User\r\n-- @treturn table User object\r\nfunction Users:select_user(username)\r\n\treturn self:find {\r\n\t\tusername = username\r\n\t}\r\nend\r\n\r\n-- Some controller\r\nlocal user = Users:select_user(request.username)\r\nif not user then\r\n\treturn {\r\n\t\tstatus = http_code.BAD_REQUEST,\r\n\t\tjson   = {}\r\n\t}\r\nend\r\n\r\nlocal players = user:get_players() -- this line causes the crash\r\nif not players then\r\n\treturn {\r\n\t\tstatus = http_code.BAD_REQUEST,\r\n\t\tjson   = {}\r\n\t}\r\nend\r\n```","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/openresty/lua-nginx-module/issues/1249","repository_url":"https://api.github.com/repos/openresty/lua-nginx-module","labels_url":"https://api.github.com/repos/openresty/lua-nginx-module/issues/1249/labels{/name}","comments_url":"https://api.github.com/repos/openresty/lua-nginx-module/issues/1249/comments","events_url":"https://api.github.com/repos/openresty/lua-nginx-module/issues/1249/events","html_url":"https://github.com/openresty/lua-nginx-module/issues/1249","id":293712550,"node_id":"MDU6SXNzdWUyOTM3MTI1NTA=","number":1249,"title":"Running out of memory","user":{"login":"erikcw","id":113129,"node_id":"MDQ6VXNlcjExMzEyOQ==","avatar_url":"https://avatars3.githubusercontent.com/u/113129?v=4","gravatar_id":"","url":"https://api.github.com/users/erikcw","html_url":"https://github.com/erikcw","followers_url":"https://api.github.com/users/erikcw/followers","following_url":"https://api.github.com/users/erikcw/following{/other_user}","gists_url":"https://api.github.com/users/erikcw/gists{/gist_id}","starred_url":"https://api.github.com/users/erikcw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erikcw/subscriptions","organizations_url":"https://api.github.com/users/erikcw/orgs","repos_url":"https://api.github.com/users/erikcw/repos","events_url":"https://api.github.com/users/erikcw/events{/privacy}","received_events_url":"https://api.github.com/users/erikcw/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-02-01T22:50:48Z","updated_at":"2018-02-03T06:23:10Z","closed_at":"2018-02-02T21:24:16Z","author_association":"NONE","active_lock_reason":null,"body":"I believe OpenResty may have a memory leak.  I've repeatedly noticed my nginx server running out of memory over the last several months before crashing and needing a restart.  I've tried running it on boxes with more memory, but the same thing happens eventually.\r\n\r\n\r\n```\r\n2018/02/01 22:36:51 [crit] 28035#28035: *230136 [lua] web.lua:460: handle_error(): ERROR cfa9581b-42da-4ccd-ccfd-1ac8af16e89f_1517524611.346 - err: null trace: null, client: 172.30.6.51, server: _\r\n2018/02/01 22:36:51 [error] 28035#28035: *230136 failed to run log_by_lua*: not enough memory while logging request, client: 172.30.6.51, server: _\r\n2018/02/01 22:36:53 [crit] 28035#28035: *230322 [lua] web.lua:460: handle_error(): ERROR c6480863-74c6-4617-87f4-4a32f83493c2_1517524613.655 - err: null trace: null, client: 172.30.6.51, server: _\r\n2018/02/01 22:36:53 [alert] 28033#28033: worker process 28035 exited on signal 6 (core dumped)\r\n```\r\nI've also seen:\r\n```\r\nnginx: lua atpanic: Lua VM crashed, reason: not enough memory\r\n```\r\n\r\nI've tried locating it with stapp -- so far here is what I've found:\r\n```\r\nroot@ip-172-30-5-125:/opt/openresty/nginx/conf/stapxx# ./samples/lj-gc-objs.sxx -x 28035 -D MAXACTION=90000000\r\nFound exact match for libluajit: /usr/local/openresty/luajit/lib/libluajit-5.1.so.2.1.0\r\nStart tracing 28035 (/usr/local/openresty/nginx/sbin/nginx)\r\n\r\nERROR: Skipped too many probes, check MAXSKIPPED or try again with stap -t for more details.\r\nmain machine code area size: 196608 bytes\r\nC callback machine code size: 4096 bytes\r\nGC total size: 1206839764 bytes\r\nGC state: propagate\r\n\r\n6576378 upvalue objects: max=24, avg=24, min=24, sum=157833072 (in bytes)\r\n4532037 function objects: max=144, avg=28, min=20, sum=128112048 (in bytes)\r\n2085692 table objects: max=1572896, avg=108, min=32, sum=226262032 (in bytes)\r\n1085306 userdata objects: max=5712, avg=622, min=27, sum=675990140 (in bytes)\r\n95149 string objects: max=7030, avg=129, min=18, sum=12310451 (in bytes)\r\n9136 thread objects: max=1648, avg=588, min=424, sum=5379352 (in bytes)\r\n885 proto objects: max=2982, avg=254, min=74, sum=225149 (in bytes)\r\n279 trace objects: max=2668, avg=659, min=160, sum=184008 (in bytes)\r\n2 cdata objects: max=12, avg=12, min=12, sum=24 (in bytes)\r\nJIT state size: 7296 bytes\r\nglobal state tmpbuf size: 4096 bytes\r\nC type state size: 2520 bytes\r\n\r\nMy GC walker detected for total 1206839764 bytes.\r\n4161265 microseconds elapsed in the probe handler.\r\nERROR: probe overhead exceeded threshold\r\nWARNING: Number of errors: 1, skipped probes: 101\r\nWARNING: /usr/bin/staprun exited with status: 1\r\nPass 5: run failed.  [man error::pass5]\r\nTip: /usr/share/doc/systemtap/README.Debian should help you get started.\r\n```\r\nI'm running on Ubuntu 16:04 with `openresty/1.13.6.1` intstalled from the OpenResty repo.\r\n\r\nIs there anything else I can provide that might help locate the source of the problem?","performed_via_github_app":null,"score":1.0},{"url":"https://api.github.com/repos/leafo/lapis/issues/565","repository_url":"https://api.github.com/repos/leafo/lapis","labels_url":"https://api.github.com/repos/leafo/lapis/issues/565/labels{/name}","comments_url":"https://api.github.com/repos/leafo/lapis/issues/565/comments","events_url":"https://api.github.com/repos/leafo/lapis/issues/565/events","html_url":"https://github.com/leafo/lapis/issues/565","id":248234838,"node_id":"MDU6SXNzdWUyNDgyMzQ4Mzg=","number":565,"title":"Expose pgmoon","user":{"login":"win64","id":1715224,"node_id":"MDQ6VXNlcjE3MTUyMjQ=","avatar_url":"https://avatars3.githubusercontent.com/u/1715224?v=4","gravatar_id":"","url":"https://api.github.com/users/win64","html_url":"https://github.com/win64","followers_url":"https://api.github.com/users/win64/followers","following_url":"https://api.github.com/users/win64/following{/other_user}","gists_url":"https://api.github.com/users/win64/gists{/gist_id}","starred_url":"https://api.github.com/users/win64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/win64/subscriptions","organizations_url":"https://api.github.com/users/win64/orgs","repos_url":"https://api.github.com/users/win64/repos","events_url":"https://api.github.com/users/win64/events{/privacy}","received_events_url":"https://api.github.com/users/win64/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-08-06T09:02:25Z","updated_at":"2017-12-30T04:30:43Z","closed_at":"2017-12-30T03:45:31Z","author_association":"NONE","active_lock_reason":null,"body":"Is there an way to get pgmoon object for hack? I dont known how to do \"pg:setup_hstore()\".\r\n\r\nModel.db just return these:\r\n```moonscript\r\n{\r\n  :connect\r\n  :disconnect\r\n  :query, :raw, :is_raw, :list, :is_list, :array, :is_array, :NULL, :TRUE,\r\n  :FALSE, :escape_literal, :escape_identifier, :encode_values, :encode_assigns,\r\n  :encode_clause, :interpolate_query, :parse_clause, :format_date,\r\n  :encode_case\r\n  :init_logger\r\n  :set_backend\r\n  :set_raw_query\r\n  :get_raw_query\r\n  select: _select\r\n  insert: _insert\r\n  update: _update\r\n  delete: _delete\r\n  truncate: _truncate\r\n  is_encodable: _is_encodable\r\n}\r\n```\r\nCould you add the pgmoon object to the table, Sir?","performed_via_github_app":null,"score":1.0}]}
0

